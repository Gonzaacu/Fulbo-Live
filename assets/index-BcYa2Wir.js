(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();var lc={exports:{}},Fr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cm;function EE(){if(cm)return Fr;cm=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,o){var u=null;if(o!==void 0&&(u=""+o),r.key!==void 0&&(u=""+r.key),"key"in r){o={};for(var f in r)f!=="key"&&(o[f]=r[f])}else o=r;return r=o.ref,{$$typeof:l,type:s,key:u,ref:r!==void 0?r:null,props:o}}return Fr.Fragment=t,Fr.jsx=i,Fr.jsxs=i,Fr}var fm;function TE(){return fm||(fm=1,lc.exports=EE()),lc.exports}var Mt=TE(),oc={exports:{}},At={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function SE(){if(hm)return At;hm=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function v(D){return D===null||typeof D!="object"?null:(D=y&&D[y]||D["@@iterator"],typeof D=="function"?D:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function A(D,K,it){this.props=D,this.context=K,this.refs=x,this.updater=it||T}A.prototype.isReactComponent={},A.prototype.setState=function(D,K){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,K,"setState")},A.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=A.prototype;function O(D,K,it){this.props=D,this.context=K,this.refs=x,this.updater=it||T}var _=O.prototype=new R;_.constructor=O,E(_,A.prototype),_.isPureReactComponent=!0;var F=Array.isArray,I={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function G(D,K,it,st,nt,pt){return it=pt.ref,{$$typeof:l,type:D,key:K,ref:it!==void 0?it:null,props:pt}}function Q(D,K){return G(D.type,K,void 0,void 0,void 0,D.props)}function z(D){return typeof D=="object"&&D!==null&&D.$$typeof===l}function P(D){var K={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(it){return K[it]})}var J=/\/+/g;function gt(D,K){return typeof D=="object"&&D!==null&&D.key!=null?P(""+D.key):K.toString(36)}function rt(){}function mt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(rt,rt):(D.status="pending",D.then(function(K){D.status==="pending"&&(D.status="fulfilled",D.value=K)},function(K){D.status==="pending"&&(D.status="rejected",D.reason=K)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function ct(D,K,it,st,nt){var pt=typeof D;(pt==="undefined"||pt==="boolean")&&(D=null);var ht=!1;if(D===null)ht=!0;else switch(pt){case"bigint":case"string":case"number":ht=!0;break;case"object":switch(D.$$typeof){case l:case t:ht=!0;break;case g:return ht=D._init,ct(ht(D._payload),K,it,st,nt)}}if(ht)return nt=nt(D),ht=st===""?"."+gt(D,0):st,F(nt)?(it="",ht!=null&&(it=ht.replace(J,"$&/")+"/"),ct(nt,K,it,"",function(zt){return zt})):nt!=null&&(z(nt)&&(nt=Q(nt,it+(nt.key==null||D&&D.key===nt.key?"":(""+nt.key).replace(J,"$&/")+"/")+ht)),K.push(nt)),1;ht=0;var Ut=st===""?".":st+":";if(F(D))for(var Dt=0;Dt<D.length;Dt++)st=D[Dt],pt=Ut+gt(st,Dt),ht+=ct(st,K,it,pt,nt);else if(Dt=v(D),typeof Dt=="function")for(D=Dt.call(D),Dt=0;!(st=D.next()).done;)st=st.value,pt=Ut+gt(st,Dt++),ht+=ct(st,K,it,pt,nt);else if(pt==="object"){if(typeof D.then=="function")return ct(mt(D),K,it,st,nt);throw K=String(D),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return ht}function q(D,K,it){if(D==null)return D;var st=[],nt=0;return ct(D,st,"","",function(pt){return K.call(it,pt,nt++)}),st}function lt(D){if(D._status===-1){var K=D._result;K=K(),K.then(function(it){(D._status===0||D._status===-1)&&(D._status=1,D._result=it)},function(it){(D._status===0||D._status===-1)&&(D._status=2,D._result=it)}),D._status===-1&&(D._status=0,D._result=K)}if(D._status===1)return D._result.default;throw D._result}var at=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function et(){}return At.Children={map:q,forEach:function(D,K,it){q(D,function(){K.apply(this,arguments)},it)},count:function(D){var K=0;return q(D,function(){K++}),K},toArray:function(D){return q(D,function(K){return K})||[]},only:function(D){if(!z(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},At.Component=A,At.Fragment=i,At.Profiler=r,At.PureComponent=O,At.StrictMode=s,At.Suspense=h,At.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,At.act=function(){throw Error("act(...) is not supported in production builds of React.")},At.cache=function(D){return function(){return D.apply(null,arguments)}},At.cloneElement=function(D,K,it){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var st=E({},D.props),nt=D.key,pt=void 0;if(K!=null)for(ht in K.ref!==void 0&&(pt=void 0),K.key!==void 0&&(nt=""+K.key),K)!V.call(K,ht)||ht==="key"||ht==="__self"||ht==="__source"||ht==="ref"&&K.ref===void 0||(st[ht]=K[ht]);var ht=arguments.length-2;if(ht===1)st.children=it;else if(1<ht){for(var Ut=Array(ht),Dt=0;Dt<ht;Dt++)Ut[Dt]=arguments[Dt+2];st.children=Ut}return G(D.type,nt,void 0,void 0,pt,st)},At.createContext=function(D){return D={$$typeof:u,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},At.createElement=function(D,K,it){var st,nt={},pt=null;if(K!=null)for(st in K.key!==void 0&&(pt=""+K.key),K)V.call(K,st)&&st!=="key"&&st!=="__self"&&st!=="__source"&&(nt[st]=K[st]);var ht=arguments.length-2;if(ht===1)nt.children=it;else if(1<ht){for(var Ut=Array(ht),Dt=0;Dt<ht;Dt++)Ut[Dt]=arguments[Dt+2];nt.children=Ut}if(D&&D.defaultProps)for(st in ht=D.defaultProps,ht)nt[st]===void 0&&(nt[st]=ht[st]);return G(D,pt,void 0,void 0,null,nt)},At.createRef=function(){return{current:null}},At.forwardRef=function(D){return{$$typeof:f,render:D}},At.isValidElement=z,At.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:lt}},At.memo=function(D,K){return{$$typeof:d,type:D,compare:K===void 0?null:K}},At.startTransition=function(D){var K=I.T,it={};I.T=it;try{var st=D(),nt=I.S;nt!==null&&nt(it,st),typeof st=="object"&&st!==null&&typeof st.then=="function"&&st.then(et,at)}catch(pt){at(pt)}finally{I.T=K}},At.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},At.use=function(D){return I.H.use(D)},At.useActionState=function(D,K,it){return I.H.useActionState(D,K,it)},At.useCallback=function(D,K){return I.H.useCallback(D,K)},At.useContext=function(D){return I.H.useContext(D)},At.useDebugValue=function(){},At.useDeferredValue=function(D,K){return I.H.useDeferredValue(D,K)},At.useEffect=function(D,K){return I.H.useEffect(D,K)},At.useId=function(){return I.H.useId()},At.useImperativeHandle=function(D,K,it){return I.H.useImperativeHandle(D,K,it)},At.useInsertionEffect=function(D,K){return I.H.useInsertionEffect(D,K)},At.useLayoutEffect=function(D,K){return I.H.useLayoutEffect(D,K)},At.useMemo=function(D,K){return I.H.useMemo(D,K)},At.useOptimistic=function(D,K){return I.H.useOptimistic(D,K)},At.useReducer=function(D,K,it){return I.H.useReducer(D,K,it)},At.useRef=function(D){return I.H.useRef(D)},At.useState=function(D){return I.H.useState(D)},At.useSyncExternalStore=function(D,K,it){return I.H.useSyncExternalStore(D,K,it)},At.useTransition=function(){return I.H.useTransition()},At.version="19.0.0",At}var dm;function nf(){return dm||(dm=1,oc.exports=SE()),oc.exports}var X=nf(),uc={exports:{}},Br={},cc={exports:{}},fc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function xE(){return mm||(mm=1,function(l){function t(q,lt){var at=q.length;q.push(lt);t:for(;0<at;){var et=at-1>>>1,D=q[et];if(0<r(D,lt))q[et]=lt,q[at]=D,at=et;else break t}}function i(q){return q.length===0?null:q[0]}function s(q){if(q.length===0)return null;var lt=q[0],at=q.pop();if(at!==lt){q[0]=at;t:for(var et=0,D=q.length,K=D>>>1;et<K;){var it=2*(et+1)-1,st=q[it],nt=it+1,pt=q[nt];if(0>r(st,at))nt<D&&0>r(pt,st)?(q[et]=pt,q[nt]=at,et=nt):(q[et]=st,q[it]=at,et=it);else if(nt<D&&0>r(pt,at))q[et]=pt,q[nt]=at,et=nt;else break t}}return lt}function r(q,lt){var at=q.sortIndex-lt.sortIndex;return at!==0?at:q.id-lt.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;l.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();l.unstable_now=function(){return u.now()-f}}var h=[],d=[],g=1,y=null,v=3,T=!1,E=!1,x=!1,A=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function _(q){for(var lt=i(d);lt!==null;){if(lt.callback===null)s(d);else if(lt.startTime<=q)s(d),lt.sortIndex=lt.expirationTime,t(h,lt);else break;lt=i(d)}}function F(q){if(x=!1,_(q),!E)if(i(h)!==null)E=!0,mt();else{var lt=i(d);lt!==null&&ct(F,lt.startTime-q)}}var I=!1,V=-1,G=5,Q=-1;function z(){return!(l.unstable_now()-Q<G)}function P(){if(I){var q=l.unstable_now();Q=q;var lt=!0;try{t:{E=!1,x&&(x=!1,R(V),V=-1),T=!0;var at=v;try{e:{for(_(q),y=i(h);y!==null&&!(y.expirationTime>q&&z());){var et=y.callback;if(typeof et=="function"){y.callback=null,v=y.priorityLevel;var D=et(y.expirationTime<=q);if(q=l.unstable_now(),typeof D=="function"){y.callback=D,_(q),lt=!0;break e}y===i(h)&&s(h),_(q)}else s(h);y=i(h)}if(y!==null)lt=!0;else{var K=i(d);K!==null&&ct(F,K.startTime-q),lt=!1}}break t}finally{y=null,v=at,T=!1}lt=void 0}}finally{lt?J():I=!1}}}var J;if(typeof O=="function")J=function(){O(P)};else if(typeof MessageChannel<"u"){var gt=new MessageChannel,rt=gt.port2;gt.port1.onmessage=P,J=function(){rt.postMessage(null)}}else J=function(){A(P,0)};function mt(){I||(I=!0,J())}function ct(q,lt){V=A(function(){q(l.unstable_now())},lt)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(q){q.callback=null},l.unstable_continueExecution=function(){E||T||(E=!0,mt())},l.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<q?Math.floor(1e3/q):5},l.unstable_getCurrentPriorityLevel=function(){return v},l.unstable_getFirstCallbackNode=function(){return i(h)},l.unstable_next=function(q){switch(v){case 1:case 2:case 3:var lt=3;break;default:lt=v}var at=v;v=lt;try{return q()}finally{v=at}},l.unstable_pauseExecution=function(){},l.unstable_requestPaint=function(){},l.unstable_runWithPriority=function(q,lt){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var at=v;v=q;try{return lt()}finally{v=at}},l.unstable_scheduleCallback=function(q,lt,at){var et=l.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?et+at:et):at=et,q){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=at+D,q={id:g++,callback:lt,priorityLevel:q,startTime:at,expirationTime:D,sortIndex:-1},at>et?(q.sortIndex=at,t(d,q),i(h)===null&&q===i(d)&&(x?(R(V),V=-1):x=!0,ct(F,at-et))):(q.sortIndex=D,t(h,q),E||T||(E=!0,mt())),q},l.unstable_shouldYield=z,l.unstable_wrapCallback=function(q){var lt=v;return function(){var at=v;v=lt;try{return q.apply(this,arguments)}finally{v=at}}}}(fc)),fc}var gm;function AE(){return gm||(gm=1,cc.exports=xE()),cc.exports}var hc={exports:{}},Ee={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function bE(){if(pm)return Ee;pm=1;var l=nf();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,d,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:h,containerInfo:d,implementation:g}}var u=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ee.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ee.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return o(h,d,null,g)},Ee.flushSync=function(h){var d=u.T,g=s.p;try{if(u.T=null,s.p=2,h)return h()}finally{u.T=d,s.p=g,s.d.f()}},Ee.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},Ee.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Ee.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,y=f(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,T=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:T}):g==="script"&&s.d.X(h,{crossOrigin:y,integrity:v,fetchPriority:T,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ee.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=f(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},Ee.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,y=f(g,d.crossOrigin);s.d.L(h,g,{crossOrigin:y,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ee.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=f(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},Ee.requestFormReset=function(h){s.d.r(h)},Ee.unstable_batchedUpdates=function(h,d){return h(d)},Ee.useFormState=function(h,d,g){return u.H.useFormState(h,d,g)},Ee.useFormStatus=function(){return u.H.useHostTransitionStatus()},Ee.version="19.0.0",Ee}var ym;function RE(){if(ym)return hc.exports;ym=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),hc.exports=bE(),hc.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm;function LE(){if(vm)return Br;vm=1;var l=AE(),t=nf(),i=RE();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var o=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),F=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function V(e){return e===null||typeof e!="object"?null:(e=I&&e[I]||e["@@iterator"],typeof e=="function"?e:null)}var G=Symbol.for("react.client.reference");function Q(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===G?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case h:return"Fragment";case f:return"Portal";case g:return"Profiler";case d:return"StrictMode";case x:return"Suspense";case A:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case T:return(e.displayName||"Context")+".Provider";case v:return(e._context.displayName||"Context")+".Consumer";case E:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case R:return n=e.displayName||null,n!==null?n:Q(e.type)||"Memo";case O:n=e._payload,e=e._init;try{return Q(e(n))}catch{}}return null}var z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=Object.assign,J,gt;function rt(e){if(J===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);J=n&&n[1]||"",gt=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+e+gt}var mt=!1;function ct(e,n){if(!e||mt)return"";mt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var tt=function(){throw Error()};if(Object.defineProperty(tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tt,[])}catch(Y){var $=Y}Reflect.construct(e,[],tt)}else{try{tt.call()}catch(Y){$=Y}e.call(tt.prototype)}}else{try{throw Error()}catch(Y){$=Y}(tt=e())&&typeof tt.catch=="function"&&tt.catch(function(){})}}catch(Y){if(Y&&$&&typeof Y.stack=="string")return[Y.stack,$.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),S=p[0],L=p[1];if(S&&L){var C=S.split(`
`),M=L.split(`
`);for(m=c=0;c<C.length&&!C[c].includes("DetermineComponentFrameRoot");)c++;for(;m<M.length&&!M[m].includes("DetermineComponentFrameRoot");)m++;if(c===C.length||m===M.length)for(c=C.length-1,m=M.length-1;1<=c&&0<=m&&C[c]!==M[m];)m--;for(;1<=c&&0<=m;c--,m--)if(C[c]!==M[m]){if(c!==1||m!==1)do if(c--,m--,0>m||C[c]!==M[m]){var j=`
`+C[c].replace(" at new "," at ");return e.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",e.displayName)),j}while(1<=c&&0<=m);break}}}finally{mt=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?rt(a):""}function q(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return e=ct(e.type,!1),e;case 11:return e=ct(e.type.render,!1),e;case 1:return e=ct(e.type,!0),e;default:return""}}function lt(e){try{var n="";do n+=q(e),e=e.return;while(e);return n}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function at(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function et(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function D(e){if(at(e)!==e)throw Error(s(188))}function K(e){var n=e.alternate;if(!n){if(n=at(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,c=n;;){var m=a.return;if(m===null)break;var p=m.alternate;if(p===null){if(c=m.return,c!==null){a=c;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===a)return D(m),e;if(p===c)return D(m),n;p=p.sibling}throw Error(s(188))}if(a.return!==c.return)a=m,c=p;else{for(var S=!1,L=m.child;L;){if(L===a){S=!0,a=m,c=p;break}if(L===c){S=!0,c=m,a=p;break}L=L.sibling}if(!S){for(L=p.child;L;){if(L===a){S=!0,a=p,c=m;break}if(L===c){S=!0,c=p,a=m;break}L=L.sibling}if(!S)throw Error(s(189))}}if(a.alternate!==c)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function it(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=it(e),n!==null)return n;e=e.sibling}return null}var st=Array.isArray,nt=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pt={pending:!1,data:null,method:null,action:null},ht=[],Ut=-1;function Dt(e){return{current:e}}function zt(e){0>Ut||(e.current=ht[Ut],ht[Ut]=null,Ut--)}function Vt(e,n){Ut++,ht[Ut]=e.current,e.current=n}var ni=Dt(null),Gs=Dt(null),zi=Dt(null),Qr=Dt(null);function Zr(e,n){switch(Vt(zi,n),Vt(Gs,e),Vt(ni,null),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)&&(n=n.namespaceURI)?P0(n):0;break;default:if(e=e===8?n.parentNode:n,n=e.tagName,e=e.namespaceURI)e=P0(e),n=G0(e,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}zt(ni),Vt(ni,n)}function qn(){zt(ni),zt(Gs),zt(zi)}function Ql(e){e.memoizedState!==null&&Vt(Qr,e);var n=ni.current,a=G0(n,e.type);n!==a&&(Vt(Gs,e),Vt(ni,a))}function Jr(e){Gs.current===e&&(zt(ni),zt(Gs)),Qr.current===e&&(zt(Qr),wr._currentValue=pt)}var Zl=Object.prototype.hasOwnProperty,Jl=l.unstable_scheduleCallback,to=l.unstable_cancelCallback,Qp=l.unstable_shouldYield,Zp=l.unstable_requestPaint,si=l.unstable_now,Jp=l.unstable_getCurrentPriorityLevel,Cf=l.unstable_ImmediatePriority,_f=l.unstable_UserBlockingPriority,ta=l.unstable_NormalPriority,ty=l.unstable_LowPriority,Of=l.unstable_IdlePriority,ey=l.log,iy=l.unstable_setDisableYieldValue,$s=null,Ce=null;function ny(e){if(Ce&&typeof Ce.onCommitFiberRoot=="function")try{Ce.onCommitFiberRoot($s,e,void 0,(e.current.flags&128)===128)}catch{}}function Vi(e){if(typeof ey=="function"&&iy(e),Ce&&typeof Ce.setStrictMode=="function")try{Ce.setStrictMode($s,e)}catch{}}var _e=Math.clz32?Math.clz32:ay,sy=Math.log,ry=Math.LN2;function ay(e){return e>>>=0,e===0?32:31-(sy(e)/ry|0)|0}var ea=128,ia=4194304;function vn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function na(e,n){var a=e.pendingLanes;if(a===0)return 0;var c=0,m=e.suspendedLanes,p=e.pingedLanes,S=e.warmLanes;e=e.finishedLanes!==0;var L=a&134217727;return L!==0?(a=L&~m,a!==0?c=vn(a):(p&=L,p!==0?c=vn(p):e||(S=L&~S,S!==0&&(c=vn(S))))):(L=a&~m,L!==0?c=vn(L):p!==0?c=vn(p):e||(S=a&~S,S!==0&&(c=vn(S)))),c===0?0:n!==0&&n!==c&&!(n&m)&&(m=c&-c,S=n&-n,m>=S||m===32&&(S&4194176)!==0)?n:c}function Hs(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function ly(e,n){switch(e){case 1:case 2:case 4:case 8:return n+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function If(){var e=ea;return ea<<=1,!(ea&4194176)&&(ea=128),e}function wf(){var e=ia;return ia<<=1,!(ia&62914560)&&(ia=4194304),e}function eo(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function zs(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function oy(e,n,a,c,m,p){var S=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var L=e.entanglements,C=e.expirationTimes,M=e.hiddenUpdates;for(a=S&~a;0<a;){var j=31-_e(a),tt=1<<j;L[j]=0,C[j]=-1;var $=M[j];if($!==null)for(M[j]=null,j=0;j<$.length;j++){var Y=$[j];Y!==null&&(Y.lane&=-536870913)}a&=~tt}c!==0&&Mf(e,c,0),p!==0&&m===0&&e.tag!==0&&(e.suspendedLanes|=p&~(S&~n))}function Mf(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var c=31-_e(n);e.entangledLanes|=n,e.entanglements[c]=e.entanglements[c]|1073741824|a&4194218}function kf(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var c=31-_e(a),m=1<<c;m&n|e[c]&n&&(e[c]|=n),a&=~m}}function Nf(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function Uf(){var e=nt.p;return e!==0?e:(e=window.event,e===void 0?32:sm(e.type))}function uy(e,n){var a=nt.p;try{return nt.p=e,n()}finally{nt.p=a}}var Ki=Math.random().toString(36).slice(2),ye="__reactFiber$"+Ki,Ae="__reactProps$"+Ki,jn="__reactContainer$"+Ki,io="__reactEvents$"+Ki,cy="__reactListeners$"+Ki,fy="__reactHandles$"+Ki,Ff="__reactResources$"+Ki,Vs="__reactMarker$"+Ki;function no(e){delete e[ye],delete e[Ae],delete e[io],delete e[cy],delete e[fy]}function En(e){var n=e[ye];if(n)return n;for(var a=e.parentNode;a;){if(n=a[jn]||a[ye]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=z0(e);e!==null;){if(a=e[ye])return a;e=z0(e)}return n}e=a,a=e.parentNode}return null}function Xn(e){if(e=e[ye]||e[jn]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function Ks(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function Wn(e){var n=e[Ff];return n||(n=e[Ff]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ae(e){e[Vs]=!0}var Bf=new Set,Pf={};function Tn(e,n){Qn(e,n),Qn(e+"Capture",n)}function Qn(e,n){for(Pf[e]=n,e=0;e<n.length;e++)Bf.add(n[e])}var Ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gf={},$f={};function dy(e){return Zl.call($f,e)?!0:Zl.call(Gf,e)?!1:hy.test(e)?$f[e]=!0:(Gf[e]=!0,!1)}function sa(e,n,a){if(dy(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function ra(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Si(e,n,a,c){if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+c)}}function Ne(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hf(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function my(e){var n=Hf(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),c=""+e[n];if(!e.hasOwnProperty(n)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var m=a.get,p=a.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return m.call(this)},set:function(S){c=""+S,p.call(this,S)}}),Object.defineProperty(e,n,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function aa(e){e._valueTracker||(e._valueTracker=my(e))}function zf(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),c="";return e&&(c=Hf(e)?e.checked?"true":"false":e.value),e=c,e!==a?(n.setValue(e),!0):!1}function la(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var gy=/[\n"\\]/g;function Ue(e){return e.replace(gy,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function so(e,n,a,c,m,p,S,L){e.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.type=S:e.removeAttribute("type"),n!=null?S==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Ne(n)):e.value!==""+Ne(n)&&(e.value=""+Ne(n)):S!=="submit"&&S!=="reset"||e.removeAttribute("value"),n!=null?ro(e,S,Ne(n)):a!=null?ro(e,S,Ne(a)):c!=null&&e.removeAttribute("value"),m==null&&p!=null&&(e.defaultChecked=!!p),m!=null&&(e.checked=m&&typeof m!="function"&&typeof m!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?e.name=""+Ne(L):e.removeAttribute("name")}function Vf(e,n,a,c,m,p,S,L){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||a!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;a=a!=null?""+Ne(a):"",n=n!=null?""+Ne(n):a,L||n===e.value||(e.value=n),e.defaultValue=n}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=L?e.checked:!!c,e.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(e.name=S)}function ro(e,n,a){n==="number"&&la(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Zn(e,n,a,c){if(e=e.options,n){n={};for(var m=0;m<a.length;m++)n["$"+a[m]]=!0;for(a=0;a<e.length;a++)m=n.hasOwnProperty("$"+e[a].value),e[a].selected!==m&&(e[a].selected=m),m&&c&&(e[a].defaultSelected=!0)}else{for(a=""+Ne(a),n=null,m=0;m<e.length;m++){if(e[m].value===a){e[m].selected=!0,c&&(e[m].defaultSelected=!0);return}n!==null||e[m].disabled||(n=e[m])}n!==null&&(n.selected=!0)}}function Kf(e,n,a){if(n!=null&&(n=""+Ne(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+Ne(a):""}function Yf(e,n,a,c){if(n==null){if(c!=null){if(a!=null)throw Error(s(92));if(st(c)){if(1<c.length)throw Error(s(93));c=c[0]}a=c}a==null&&(a=""),n=a}a=Ne(n),e.defaultValue=a,c=e.textContent,c===a&&c!==""&&c!==null&&(e.value=c)}function Jn(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var py=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function qf(e,n,a){var c=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":c?e.setProperty(n,a):typeof a!="number"||a===0||py.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function jf(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var m in n)c=n[m],n.hasOwnProperty(m)&&a[m]!==c&&qf(e,m,c)}else for(var p in n)n.hasOwnProperty(p)&&qf(e,p,n[p])}function ao(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oa(e){return vy.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var lo=null;function oo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ts=null,es=null;function Xf(e){var n=Xn(e);if(n&&(e=n.stateNode)){var a=e[Ae]||null;t:switch(e=n.stateNode,n.type){case"input":if(so(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Ue(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var c=a[n];if(c!==e&&c.form===e.form){var m=c[Ae]||null;if(!m)throw Error(s(90));so(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(n=0;n<a.length;n++)c=a[n],c.form===e.form&&zf(c)}break t;case"textarea":Kf(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&Zn(e,!!a.multiple,n,!1)}}}var uo=!1;function Wf(e,n,a){if(uo)return e(n,a);uo=!0;try{var c=e(n);return c}finally{if(uo=!1,(ts!==null||es!==null)&&(Ka(),ts&&(n=ts,e=es,es=ts=null,Xf(n),e)))for(n=0;n<e.length;n++)Xf(e[n])}}function Ys(e,n){var a=e.stateNode;if(a===null)return null;var c=a[Ae]||null;if(c===null)return null;a=c[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var co=!1;if(Ti)try{var qs={};Object.defineProperty(qs,"passive",{get:function(){co=!0}}),window.addEventListener("test",qs,qs),window.removeEventListener("test",qs,qs)}catch{co=!1}var Yi=null,fo=null,ua=null;function Qf(){if(ua)return ua;var e,n=fo,a=n.length,c,m="value"in Yi?Yi.value:Yi.textContent,p=m.length;for(e=0;e<a&&n[e]===m[e];e++);var S=a-e;for(c=1;c<=S&&n[a-c]===m[p-c];c++);return ua=m.slice(e,1<c?1-c:void 0)}function ca(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function fa(){return!0}function Zf(){return!1}function be(e){function n(a,c,m,p,S){this._reactName=a,this._targetInst=m,this.type=c,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var L in e)e.hasOwnProperty(L)&&(a=e[L],this[L]=a?a(p):p[L]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?fa:Zf,this.isPropagationStopped=Zf,this}return P(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=fa)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=fa)},persist:function(){},isPersistent:fa}),n}var Sn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ha=be(Sn),js=P({},Sn,{view:0,detail:0}),Ey=be(js),ho,mo,Xs,da=P({},js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:po,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xs&&(Xs&&e.type==="mousemove"?(ho=e.screenX-Xs.screenX,mo=e.screenY-Xs.screenY):mo=ho=0,Xs=e),ho)},movementY:function(e){return"movementY"in e?e.movementY:mo}}),Jf=be(da),Ty=P({},da,{dataTransfer:0}),Sy=be(Ty),xy=P({},js,{relatedTarget:0}),go=be(xy),Ay=P({},Sn,{animationName:0,elapsedTime:0,pseudoElement:0}),by=be(Ay),Ry=P({},Sn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ly=be(Ry),Dy=P({},Sn,{data:0}),th=be(Dy),Cy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_y={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Iy(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Oy[e])?!!n[e]:!1}function po(){return Iy}var wy=P({},js,{key:function(e){if(e.key){var n=Cy[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=ca(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_y[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:po,charCode:function(e){return e.type==="keypress"?ca(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ca(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),My=be(wy),ky=P({},da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eh=be(ky),Ny=P({},js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:po}),Uy=be(Ny),Fy=P({},Sn,{propertyName:0,elapsedTime:0,pseudoElement:0}),By=be(Fy),Py=P({},da,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gy=be(Py),$y=P({},Sn,{newState:0,oldState:0}),Hy=be($y),zy=[9,13,27,32],yo=Ti&&"CompositionEvent"in window,Ws=null;Ti&&"documentMode"in document&&(Ws=document.documentMode);var Vy=Ti&&"TextEvent"in window&&!Ws,ih=Ti&&(!yo||Ws&&8<Ws&&11>=Ws),nh=" ",sh=!1;function rh(e,n){switch(e){case"keyup":return zy.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ah(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var is=!1;function Ky(e,n){switch(e){case"compositionend":return ah(n);case"keypress":return n.which!==32?null:(sh=!0,nh);case"textInput":return e=n.data,e===nh&&sh?null:e;default:return null}}function Yy(e,n){if(is)return e==="compositionend"||!yo&&rh(e,n)?(e=Qf(),ua=fo=Yi=null,is=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return ih&&n.locale!=="ko"?null:n.data;default:return null}}var qy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lh(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!qy[e.type]:n==="textarea"}function oh(e,n,a,c){ts?es?es.push(c):es=[c]:ts=c,n=Wa(n,"onChange"),0<n.length&&(a=new ha("onChange","change",null,a,c),e.push({event:a,listeners:n}))}var Qs=null,Zs=null;function jy(e){k0(e,0)}function ma(e){var n=Ks(e);if(zf(n))return e}function uh(e,n){if(e==="change")return n}var ch=!1;if(Ti){var vo;if(Ti){var Eo="oninput"in document;if(!Eo){var fh=document.createElement("div");fh.setAttribute("oninput","return;"),Eo=typeof fh.oninput=="function"}vo=Eo}else vo=!1;ch=vo&&(!document.documentMode||9<document.documentMode)}function hh(){Qs&&(Qs.detachEvent("onpropertychange",dh),Zs=Qs=null)}function dh(e){if(e.propertyName==="value"&&ma(Zs)){var n=[];oh(n,Zs,e,oo(e)),Wf(jy,n)}}function Xy(e,n,a){e==="focusin"?(hh(),Qs=n,Zs=a,Qs.attachEvent("onpropertychange",dh)):e==="focusout"&&hh()}function Wy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ma(Zs)}function Qy(e,n){if(e==="click")return ma(n)}function Zy(e,n){if(e==="input"||e==="change")return ma(n)}function Jy(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Oe=typeof Object.is=="function"?Object.is:Jy;function Js(e,n){if(Oe(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),c=Object.keys(n);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var m=a[c];if(!Zl.call(n,m)||!Oe(e[m],n[m]))return!1}return!0}function mh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gh(e,n){var a=mh(e);e=0;for(var c;a;){if(a.nodeType===3){if(c=e+a.textContent.length,e<=n&&c>=n)return{node:a,offset:n-e};e=c}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=mh(a)}}function ph(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?ph(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function yh(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=la(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=la(e.document)}return n}function To(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function tv(e,n){var a=yh(n);n=e.focusedElem;var c=e.selectionRange;if(a!==n&&n&&n.ownerDocument&&ph(n.ownerDocument.documentElement,n)){if(c!==null&&To(n)){if(e=c.start,a=c.end,a===void 0&&(a=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(a,n.value.length);else if(a=(e=n.ownerDocument||document)&&e.defaultView||window,a.getSelection){a=a.getSelection();var m=n.textContent.length,p=Math.min(c.start,m);c=c.end===void 0?p:Math.min(c.end,m),!a.extend&&p>c&&(m=c,c=p,p=m),m=gh(n,p);var S=gh(n,c);m&&S&&(a.rangeCount!==1||a.anchorNode!==m.node||a.anchorOffset!==m.offset||a.focusNode!==S.node||a.focusOffset!==S.offset)&&(e=e.createRange(),e.setStart(m.node,m.offset),a.removeAllRanges(),p>c?(a.addRange(e),a.extend(S.node,S.offset)):(e.setEnd(S.node,S.offset),a.addRange(e)))}}for(e=[],a=n;a=a.parentNode;)a.nodeType===1&&e.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)a=e[n],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var ev=Ti&&"documentMode"in document&&11>=document.documentMode,ns=null,So=null,tr=null,xo=!1;function vh(e,n,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;xo||ns==null||ns!==la(c)||(c=ns,"selectionStart"in c&&To(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),tr&&Js(tr,c)||(tr=c,c=Wa(So,"onSelect"),0<c.length&&(n=new ha("onSelect","select",null,n,a),e.push({event:n,listeners:c}),n.target=ns)))}function xn(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var ss={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionrun:xn("Transition","TransitionRun"),transitionstart:xn("Transition","TransitionStart"),transitioncancel:xn("Transition","TransitionCancel"),transitionend:xn("Transition","TransitionEnd")},Ao={},Eh={};Ti&&(Eh=document.createElement("div").style,"AnimationEvent"in window||(delete ss.animationend.animation,delete ss.animationiteration.animation,delete ss.animationstart.animation),"TransitionEvent"in window||delete ss.transitionend.transition);function An(e){if(Ao[e])return Ao[e];if(!ss[e])return e;var n=ss[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in Eh)return Ao[e]=n[a];return e}var Th=An("animationend"),Sh=An("animationiteration"),xh=An("animationstart"),iv=An("transitionrun"),nv=An("transitionstart"),sv=An("transitioncancel"),Ah=An("transitionend"),bh=new Map,Rh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function We(e,n){bh.set(e,n),Tn(n,[e])}var Fe=[],rs=0,bo=0;function ga(){for(var e=rs,n=bo=rs=0;n<e;){var a=Fe[n];Fe[n++]=null;var c=Fe[n];Fe[n++]=null;var m=Fe[n];Fe[n++]=null;var p=Fe[n];if(Fe[n++]=null,c!==null&&m!==null){var S=c.pending;S===null?m.next=m:(m.next=S.next,S.next=m),c.pending=m}p!==0&&Lh(a,m,p)}}function pa(e,n,a,c){Fe[rs++]=e,Fe[rs++]=n,Fe[rs++]=a,Fe[rs++]=c,bo|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function Ro(e,n,a,c){return pa(e,n,a,c),ya(e)}function qi(e,n){return pa(e,null,null,n),ya(e)}function Lh(e,n,a){e.lanes|=a;var c=e.alternate;c!==null&&(c.lanes|=a);for(var m=!1,p=e.return;p!==null;)p.childLanes|=a,c=p.alternate,c!==null&&(c.childLanes|=a),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(m=!0)),e=p,p=p.return;m&&n!==null&&e.tag===3&&(p=e.stateNode,m=31-_e(a),p=p.hiddenUpdates,e=p[m],e===null?p[m]=[n]:e.push(n),n.lane=a|536870912)}function ya(e){if(50<Rr)throw Rr=0,Iu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var as={},Dh=new WeakMap;function Be(e,n){if(typeof e=="object"&&e!==null){var a=Dh.get(e);return a!==void 0?a:(n={value:e,source:n,stack:lt(n)},Dh.set(e,n),n)}return{value:e,source:n,stack:lt(n)}}var ls=[],os=0,va=null,Ea=0,Pe=[],Ge=0,bn=null,xi=1,Ai="";function Rn(e,n){ls[os++]=Ea,ls[os++]=va,va=e,Ea=n}function Ch(e,n,a){Pe[Ge++]=xi,Pe[Ge++]=Ai,Pe[Ge++]=bn,bn=e;var c=xi;e=Ai;var m=32-_e(c)-1;c&=~(1<<m),a+=1;var p=32-_e(n)+m;if(30<p){var S=m-m%5;p=(c&(1<<S)-1).toString(32),c>>=S,m-=S,xi=1<<32-_e(n)+m|a<<m|c,Ai=p+e}else xi=1<<p|a<<m|c,Ai=e}function Lo(e){e.return!==null&&(Rn(e,1),Ch(e,1,0))}function Do(e){for(;e===va;)va=ls[--os],ls[os]=null,Ea=ls[--os],ls[os]=null;for(;e===bn;)bn=Pe[--Ge],Pe[Ge]=null,Ai=Pe[--Ge],Pe[Ge]=null,xi=Pe[--Ge],Pe[Ge]=null}var Se=null,de=null,It=!1,Qe=null,ri=!1,Co=Error(s(519));function Ln(e){var n=Error(s(418,""));throw nr(Be(n,e)),Co}function _h(e){var n=e.stateNode,a=e.type,c=e.memoizedProps;switch(n[ye]=e,n[Ae]=c,a){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(a=0;a<Dr.length;a++)Ct(Dr[a],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":Ct("invalid",n),Vf(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),aa(n);break;case"select":Ct("invalid",n);break;case"textarea":Ct("invalid",n),Yf(n,c.value,c.defaultValue,c.children),aa(n)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||c.suppressHydrationWarning===!0||B0(n.textContent,a)?(c.popover!=null&&(Ct("beforetoggle",n),Ct("toggle",n)),c.onScroll!=null&&Ct("scroll",n),c.onScrollEnd!=null&&Ct("scrollend",n),c.onClick!=null&&(n.onclick=Qa),n=!0):n=!1,n||Ln(e)}function Oh(e){for(Se=e.return;Se;)switch(Se.tag){case 3:case 27:ri=!0;return;case 5:case 13:ri=!1;return;default:Se=Se.return}}function er(e){if(e!==Se)return!1;if(!It)return Oh(e),It=!0,!1;var n=!1,a;if((a=e.tag!==3&&e.tag!==27)&&((a=e.tag===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||ju(e.type,e.memoizedProps)),a=!a),a&&(n=!0),n&&de&&Ln(e),Oh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));t:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(a=e.data,a==="/$"){if(n===0){de=Je(e.nextSibling);break t}n--}else a!=="$"&&a!=="$!"&&a!=="$?"||n++;e=e.nextSibling}de=null}}else de=Se?Je(e.stateNode.nextSibling):null;return!0}function ir(){de=Se=null,It=!1}function nr(e){Qe===null?Qe=[e]:Qe.push(e)}var sr=Error(s(460)),Ih=Error(s(474)),_o={then:function(){}};function wh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ta(){}function Mh(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Ta,Ta),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,e===sr?Error(s(483)):e;default:if(typeof n.status=="string")n.then(Ta,Ta);else{if(e=Gt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(c){if(n.status==="pending"){var m=n;m.status="fulfilled",m.value=c}},function(c){if(n.status==="pending"){var m=n;m.status="rejected",m.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,e===sr?Error(s(483)):e}throw rr=n,sr}}var rr=null;function kh(){if(rr===null)throw Error(s(459));var e=rr;return rr=null,e}var us=null,ar=0;function Sa(e){var n=ar;return ar+=1,us===null&&(us=[]),Mh(us,e,n)}function lr(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function xa(e,n){throw n.$$typeof===o?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Nh(e){var n=e._init;return n(e._payload)}function Uh(e){function n(k,w){if(e){var U=k.deletions;U===null?(k.deletions=[w],k.flags|=16):U.push(w)}}function a(k,w){if(!e)return null;for(;w!==null;)n(k,w),w=w.sibling;return null}function c(k){for(var w=new Map;k!==null;)k.key!==null?w.set(k.key,k):w.set(k.index,k),k=k.sibling;return w}function m(k,w){return k=an(k,w),k.index=0,k.sibling=null,k}function p(k,w,U){return k.index=U,e?(U=k.alternate,U!==null?(U=U.index,U<w?(k.flags|=33554434,w):U):(k.flags|=33554434,w)):(k.flags|=1048576,w)}function S(k){return e&&k.alternate===null&&(k.flags|=33554434),k}function L(k,w,U,W){return w===null||w.tag!==6?(w=Au(U,k.mode,W),w.return=k,w):(w=m(w,U),w.return=k,w)}function C(k,w,U,W){var ut=U.type;return ut===h?j(k,w,U.props.children,W,U.key):w!==null&&(w.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===O&&Nh(ut)===w.type)?(w=m(w,U.props),lr(w,U),w.return=k,w):(w=Ga(U.type,U.key,U.props,null,k.mode,W),lr(w,U),w.return=k,w)}function M(k,w,U,W){return w===null||w.tag!==4||w.stateNode.containerInfo!==U.containerInfo||w.stateNode.implementation!==U.implementation?(w=bu(U,k.mode,W),w.return=k,w):(w=m(w,U.children||[]),w.return=k,w)}function j(k,w,U,W,ut){return w===null||w.tag!==7?(w=Un(U,k.mode,W,ut),w.return=k,w):(w=m(w,U),w.return=k,w)}function tt(k,w,U){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return w=Au(""+w,k.mode,U),w.return=k,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case u:return U=Ga(w.type,w.key,w.props,null,k.mode,U),lr(U,w),U.return=k,U;case f:return w=bu(w,k.mode,U),w.return=k,w;case O:var W=w._init;return w=W(w._payload),tt(k,w,U)}if(st(w)||V(w))return w=Un(w,k.mode,U,null),w.return=k,w;if(typeof w.then=="function")return tt(k,Sa(w),U);if(w.$$typeof===T)return tt(k,Fa(k,w),U);xa(k,w)}return null}function $(k,w,U,W){var ut=w!==null?w.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return ut!==null?null:L(k,w,""+U,W);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case u:return U.key===ut?C(k,w,U,W):null;case f:return U.key===ut?M(k,w,U,W):null;case O:return ut=U._init,U=ut(U._payload),$(k,w,U,W)}if(st(U)||V(U))return ut!==null?null:j(k,w,U,W,null);if(typeof U.then=="function")return $(k,w,Sa(U),W);if(U.$$typeof===T)return $(k,w,Fa(k,U),W);xa(k,U)}return null}function Y(k,w,U,W,ut){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return k=k.get(U)||null,L(w,k,""+W,ut);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case u:return k=k.get(W.key===null?U:W.key)||null,C(w,k,W,ut);case f:return k=k.get(W.key===null?U:W.key)||null,M(w,k,W,ut);case O:var Rt=W._init;return W=Rt(W._payload),Y(k,w,U,W,ut)}if(st(W)||V(W))return k=k.get(U)||null,j(w,k,W,ut,null);if(typeof W.then=="function")return Y(k,w,U,Sa(W),ut);if(W.$$typeof===T)return Y(k,w,U,Fa(w,W),ut);xa(w,W)}return null}function ft(k,w,U,W){for(var ut=null,Rt=null,dt=w,Et=w=0,ue=null;dt!==null&&Et<U.length;Et++){dt.index>Et?(ue=dt,dt=null):ue=dt.sibling;var wt=$(k,dt,U[Et],W);if(wt===null){dt===null&&(dt=ue);break}e&&dt&&wt.alternate===null&&n(k,dt),w=p(wt,w,Et),Rt===null?ut=wt:Rt.sibling=wt,Rt=wt,dt=ue}if(Et===U.length)return a(k,dt),It&&Rn(k,Et),ut;if(dt===null){for(;Et<U.length;Et++)dt=tt(k,U[Et],W),dt!==null&&(w=p(dt,w,Et),Rt===null?ut=dt:Rt.sibling=dt,Rt=dt);return It&&Rn(k,Et),ut}for(dt=c(dt);Et<U.length;Et++)ue=Y(dt,k,Et,U[Et],W),ue!==null&&(e&&ue.alternate!==null&&dt.delete(ue.key===null?Et:ue.key),w=p(ue,w,Et),Rt===null?ut=ue:Rt.sibling=ue,Rt=ue);return e&&dt.forEach(function(dn){return n(k,dn)}),It&&Rn(k,Et),ut}function St(k,w,U,W){if(U==null)throw Error(s(151));for(var ut=null,Rt=null,dt=w,Et=w=0,ue=null,wt=U.next();dt!==null&&!wt.done;Et++,wt=U.next()){dt.index>Et?(ue=dt,dt=null):ue=dt.sibling;var dn=$(k,dt,wt.value,W);if(dn===null){dt===null&&(dt=ue);break}e&&dt&&dn.alternate===null&&n(k,dt),w=p(dn,w,Et),Rt===null?ut=dn:Rt.sibling=dn,Rt=dn,dt=ue}if(wt.done)return a(k,dt),It&&Rn(k,Et),ut;if(dt===null){for(;!wt.done;Et++,wt=U.next())wt=tt(k,wt.value,W),wt!==null&&(w=p(wt,w,Et),Rt===null?ut=wt:Rt.sibling=wt,Rt=wt);return It&&Rn(k,Et),ut}for(dt=c(dt);!wt.done;Et++,wt=U.next())wt=Y(dt,k,Et,wt.value,W),wt!==null&&(e&&wt.alternate!==null&&dt.delete(wt.key===null?Et:wt.key),w=p(wt,w,Et),Rt===null?ut=wt:Rt.sibling=wt,Rt=wt);return e&&dt.forEach(function(vE){return n(k,vE)}),It&&Rn(k,Et),ut}function Qt(k,w,U,W){if(typeof U=="object"&&U!==null&&U.type===h&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case u:t:{for(var ut=U.key;w!==null;){if(w.key===ut){if(ut=U.type,ut===h){if(w.tag===7){a(k,w.sibling),W=m(w,U.props.children),W.return=k,k=W;break t}}else if(w.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===O&&Nh(ut)===w.type){a(k,w.sibling),W=m(w,U.props),lr(W,U),W.return=k,k=W;break t}a(k,w);break}else n(k,w);w=w.sibling}U.type===h?(W=Un(U.props.children,k.mode,W,U.key),W.return=k,k=W):(W=Ga(U.type,U.key,U.props,null,k.mode,W),lr(W,U),W.return=k,k=W)}return S(k);case f:t:{for(ut=U.key;w!==null;){if(w.key===ut)if(w.tag===4&&w.stateNode.containerInfo===U.containerInfo&&w.stateNode.implementation===U.implementation){a(k,w.sibling),W=m(w,U.children||[]),W.return=k,k=W;break t}else{a(k,w);break}else n(k,w);w=w.sibling}W=bu(U,k.mode,W),W.return=k,k=W}return S(k);case O:return ut=U._init,U=ut(U._payload),Qt(k,w,U,W)}if(st(U))return ft(k,w,U,W);if(V(U)){if(ut=V(U),typeof ut!="function")throw Error(s(150));return U=ut.call(U),St(k,w,U,W)}if(typeof U.then=="function")return Qt(k,w,Sa(U),W);if(U.$$typeof===T)return Qt(k,w,Fa(k,U),W);xa(k,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,w!==null&&w.tag===6?(a(k,w.sibling),W=m(w,U),W.return=k,k=W):(a(k,w),W=Au(U,k.mode,W),W.return=k,k=W),S(k)):a(k,w)}return function(k,w,U,W){try{ar=0;var ut=Qt(k,w,U,W);return us=null,ut}catch(dt){if(dt===sr)throw dt;var Rt=Ve(29,dt,null,k.mode);return Rt.lanes=W,Rt.return=k,Rt}finally{}}}var Dn=Uh(!0),Fh=Uh(!1),cs=Dt(null),Aa=Dt(0);function Bh(e,n){e=ki,Vt(Aa,e),Vt(cs,n),ki=e|n.baseLanes}function Oo(){Vt(Aa,ki),Vt(cs,cs.current)}function Io(){ki=Aa.current,zt(cs),zt(Aa)}var $e=Dt(null),ai=null;function ji(e){var n=e.alternate;Vt(ne,ne.current&1),Vt($e,e),ai===null&&(n===null||cs.current!==null||n.memoizedState!==null)&&(ai=e)}function Ph(e){if(e.tag===22){if(Vt(ne,ne.current),Vt($e,e),ai===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(ai=e)}}else Xi()}function Xi(){Vt(ne,ne.current),Vt($e,$e.current)}function bi(e){zt($e),ai===e&&(ai=null),zt(ne)}var ne=Dt(0);function ba(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var rv=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,c){e.push(c)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},av=l.unstable_scheduleCallback,lv=l.unstable_NormalPriority,se={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wo(){return{controller:new rv,data:new Map,refCount:0}}function or(e){e.refCount--,e.refCount===0&&av(lv,function(){e.controller.abort()})}var ur=null,Mo=0,fs=0,hs=null;function ov(e,n){if(ur===null){var a=ur=[];Mo=0,fs=Pu(),hs={status:"pending",value:void 0,then:function(c){a.push(c)}}}return Mo++,n.then(Gh,Gh),n}function Gh(){if(--Mo===0&&ur!==null){hs!==null&&(hs.status="fulfilled");var e=ur;ur=null,fs=0,hs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function uv(e,n){var a=[],c={status:"pending",value:null,reason:null,then:function(m){a.push(m)}};return e.then(function(){c.status="fulfilled",c.value=n;for(var m=0;m<a.length;m++)(0,a[m])(n)},function(m){for(c.status="rejected",c.reason=m,m=0;m<a.length;m++)(0,a[m])(void 0)}),c}var $h=z.S;z.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&ov(e,n),$h!==null&&$h(e,n)};var Cn=Dt(null);function ko(){var e=Cn.current;return e!==null?e:Gt.pooledCache}function Ra(e,n){n===null?Vt(Cn,Cn.current):Vt(Cn,n.pool)}function Hh(){var e=ko();return e===null?null:{parent:se._currentValue,pool:e}}var Wi=0,bt=null,Ft=null,Jt=null,La=!1,ds=!1,_n=!1,Da=0,cr=0,ms=null,cv=0;function Zt(){throw Error(s(321))}function No(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!Oe(e[a],n[a]))return!1;return!0}function Uo(e,n,a,c,m,p){return Wi=p,bt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,z.H=e===null||e.memoizedState===null?On:Qi,_n=!1,p=a(c,m),_n=!1,ds&&(p=Vh(n,a,c,m)),zh(e),p}function zh(e){z.H=li;var n=Ft!==null&&Ft.next!==null;if(Wi=0,Jt=Ft=bt=null,La=!1,cr=0,ms=null,n)throw Error(s(300));e===null||le||(e=e.dependencies,e!==null&&Ua(e)&&(le=!0))}function Vh(e,n,a,c){bt=e;var m=0;do{if(ds&&(ms=null),cr=0,ds=!1,25<=m)throw Error(s(301));if(m+=1,Jt=Ft=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}z.H=In,p=n(a,c)}while(ds);return p}function fv(){var e=z.H,n=e.useState()[0];return n=typeof n.then=="function"?fr(n):n,e=e.useState()[0],(Ft!==null?Ft.memoizedState:null)!==e&&(bt.flags|=1024),n}function Fo(){var e=Da!==0;return Da=0,e}function Bo(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function Po(e){if(La){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}La=!1}Wi=0,Jt=Ft=bt=null,ds=!1,cr=Da=0,ms=null}function Re(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function te(){if(Ft===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var n=Jt===null?bt.memoizedState:Jt.next;if(n!==null)Jt=n,Ft=e;else{if(e===null)throw bt.alternate===null?Error(s(467)):Error(s(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}var Ca;Ca=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function fr(e){var n=cr;return cr+=1,ms===null&&(ms=[]),e=Mh(ms,e,n),n=bt,(Jt===null?n.memoizedState:Jt.next)===null&&(n=n.alternate,z.H=n===null||n.memoizedState===null?On:Qi),e}function _a(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return fr(e);if(e.$$typeof===T)return ve(e)}throw Error(s(438,String(e)))}function Go(e){var n=null,a=bt.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var c=bt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(m){return m.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=Ca(),bt.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),c=0;c<e;c++)a[c]=F;return n.index++,a}function Ri(e,n){return typeof n=="function"?n(e):n}function Oa(e){var n=te();return $o(n,Ft,e)}function $o(e,n,a){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=a;var m=e.baseQueue,p=c.pending;if(p!==null){if(m!==null){var S=m.next;m.next=p.next,p.next=S}n.baseQueue=m=p,c.pending=null}if(p=e.baseState,m===null)e.memoizedState=p;else{n=m.next;var L=S=null,C=null,M=n,j=!1;do{var tt=M.lane&-536870913;if(tt!==M.lane?(_t&tt)===tt:(Wi&tt)===tt){var $=M.revertLane;if($===0)C!==null&&(C=C.next={lane:0,revertLane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),tt===fs&&(j=!0);else if((Wi&$)===$){M=M.next,$===fs&&(j=!0);continue}else tt={lane:0,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},C===null?(L=C=tt,S=p):C=C.next=tt,bt.lanes|=$,ln|=$;tt=M.action,_n&&a(p,tt),p=M.hasEagerState?M.eagerState:a(p,tt)}else $={lane:tt,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},C===null?(L=C=$,S=p):C=C.next=$,bt.lanes|=tt,ln|=tt;M=M.next}while(M!==null&&M!==n);if(C===null?S=p:C.next=L,!Oe(p,e.memoizedState)&&(le=!0,j&&(a=hs,a!==null)))throw a;e.memoizedState=p,e.baseState=S,e.baseQueue=C,c.lastRenderedState=p}return m===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Ho(e){var n=te(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var c=a.dispatch,m=a.pending,p=n.memoizedState;if(m!==null){a.pending=null;var S=m=m.next;do p=e(p,S.action),S=S.next;while(S!==m);Oe(p,n.memoizedState)||(le=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),a.lastRenderedState=p}return[p,c]}function Kh(e,n,a){var c=bt,m=te(),p=It;if(p){if(a===void 0)throw Error(s(407));a=a()}else a=n();var S=!Oe((Ft||m).memoizedState,a);if(S&&(m.memoizedState=a,le=!0),m=m.queue,Ko(jh.bind(null,c,m,e),[e]),m.getSnapshot!==n||S||Jt!==null&&Jt.memoizedState.tag&1){if(c.flags|=2048,gs(9,qh.bind(null,c,m,a,n),{destroy:void 0},null),Gt===null)throw Error(s(349));p||Wi&60||Yh(c,n,a)}return a}function Yh(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=bt.updateQueue,n===null?(n=Ca(),bt.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function qh(e,n,a,c){n.value=a,n.getSnapshot=c,Xh(n)&&Wh(e)}function jh(e,n,a){return a(function(){Xh(n)&&Wh(e)})}function Xh(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!Oe(e,a)}catch{return!0}}function Wh(e){var n=qi(e,2);n!==null&&xe(n,e,2)}function zo(e){var n=Re();if(typeof e=="function"){var a=e;if(e=a(),_n){Vi(!0);try{a()}finally{Vi(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ri,lastRenderedState:e},n}function Qh(e,n,a,c){return e.baseState=a,$o(e,Ft,typeof c=="function"?c:Ri)}function hv(e,n,a,c,m){if(Ma(e))throw Error(s(485));if(e=n.action,e!==null){var p={payload:m,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){p.listeners.push(S)}};z.T!==null?a(!0):p.isTransition=!1,c(p),a=n.pending,a===null?(p.next=n.pending=p,Zh(n,p)):(p.next=a.next,n.pending=a.next=p)}}function Zh(e,n){var a=n.action,c=n.payload,m=e.state;if(n.isTransition){var p=z.T,S={};z.T=S;try{var L=a(m,c),C=z.S;C!==null&&C(S,L),Jh(e,n,L)}catch(M){Vo(e,n,M)}finally{z.T=p}}else try{p=a(m,c),Jh(e,n,p)}catch(M){Vo(e,n,M)}}function Jh(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){td(e,n,c)},function(c){return Vo(e,n,c)}):td(e,n,a)}function td(e,n,a){n.status="fulfilled",n.value=a,ed(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,Zh(e,a)))}function Vo(e,n,a){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=a,ed(n),n=n.next;while(n!==c)}e.action=null}function ed(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function id(e,n){return n}function nd(e,n){if(It){var a=Gt.formState;if(a!==null){t:{var c=bt;if(It){if(de){e:{for(var m=de,p=ri;m.nodeType!==8;){if(!p){m=null;break e}if(m=Je(m.nextSibling),m===null){m=null;break e}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){de=Je(m.nextSibling),c=m.data==="F!";break t}}Ln(c)}c=!1}c&&(n=a[0])}}return a=Re(),a.memoizedState=a.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:id,lastRenderedState:n},a.queue=c,a=Sd.bind(null,bt,c),c.dispatch=a,c=zo(!1),p=Wo.bind(null,bt,!1,c.queue),c=Re(),m={state:n,dispatch:null,action:e,pending:null},c.queue=m,a=hv.bind(null,bt,m,p,a),m.dispatch=a,c.memoizedState=e,[n,a,!1]}function sd(e){var n=te();return rd(n,Ft,e)}function rd(e,n,a){n=$o(e,n,id)[0],e=Oa(Ri)[0],n=typeof n=="object"&&n!==null&&typeof n.then=="function"?fr(n):n;var c=te(),m=c.queue,p=m.dispatch;return a!==c.memoizedState&&(bt.flags|=2048,gs(9,dv.bind(null,m,a),{destroy:void 0},null)),[n,p,e]}function dv(e,n){e.action=n}function ad(e){var n=te(),a=Ft;if(a!==null)return rd(n,a,e);te(),n=n.memoizedState,a=te();var c=a.queue.dispatch;return a.memoizedState=e,[n,c,!1]}function gs(e,n,a,c){return e={tag:e,create:n,inst:a,deps:c,next:null},n=bt.updateQueue,n===null&&(n=Ca(),bt.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(c=a.next,a.next=e,e.next=c,n.lastEffect=e),e}function ld(){return te().memoizedState}function Ia(e,n,a,c){var m=Re();bt.flags|=e,m.memoizedState=gs(1|n,a,{destroy:void 0},c===void 0?null:c)}function wa(e,n,a,c){var m=te();c=c===void 0?null:c;var p=m.memoizedState.inst;Ft!==null&&c!==null&&No(c,Ft.memoizedState.deps)?m.memoizedState=gs(n,a,p,c):(bt.flags|=e,m.memoizedState=gs(1|n,a,p,c))}function od(e,n){Ia(8390656,8,e,n)}function Ko(e,n){wa(2048,8,e,n)}function ud(e,n){return wa(4,2,e,n)}function cd(e,n){return wa(4,4,e,n)}function fd(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function hd(e,n,a){a=a!=null?a.concat([e]):null,wa(4,4,fd.bind(null,n,e),a)}function Yo(){}function dd(e,n){var a=te();n=n===void 0?null:n;var c=a.memoizedState;return n!==null&&No(n,c[1])?c[0]:(a.memoizedState=[e,n],e)}function md(e,n){var a=te();n=n===void 0?null:n;var c=a.memoizedState;if(n!==null&&No(n,c[1]))return c[0];if(c=e(),_n){Vi(!0);try{e()}finally{Vi(!1)}}return a.memoizedState=[c,n],c}function qo(e,n,a){return a===void 0||Wi&1073741824?e.memoizedState=n:(e.memoizedState=a,e=p0(),bt.lanes|=e,ln|=e,a)}function gd(e,n,a,c){return Oe(a,n)?a:cs.current!==null?(e=qo(e,a,c),Oe(e,n)||(le=!0),e):Wi&42?(e=p0(),bt.lanes|=e,ln|=e,n):(le=!0,e.memoizedState=a)}function pd(e,n,a,c,m){var p=nt.p;nt.p=p!==0&&8>p?p:8;var S=z.T,L={};z.T=L,Wo(e,!1,n,a);try{var C=m(),M=z.S;if(M!==null&&M(L,C),C!==null&&typeof C=="object"&&typeof C.then=="function"){var j=uv(C,c);hr(e,n,j,ke(e))}else hr(e,n,c,ke(e))}catch(tt){hr(e,n,{then:function(){},status:"rejected",reason:tt},ke())}finally{nt.p=p,z.T=S}}function mv(){}function jo(e,n,a,c){if(e.tag!==5)throw Error(s(476));var m=yd(e).queue;pd(e,m,n,pt,a===null?mv:function(){return vd(e),a(c)})}function yd(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:pt,baseState:pt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ri,lastRenderedState:pt},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ri,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function vd(e){var n=yd(e).next.queue;hr(e,n,{},ke())}function Xo(){return ve(wr)}function Ed(){return te().memoizedState}function Td(){return te().memoizedState}function gv(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=ke();e=tn(a);var c=en(n,e,a);c!==null&&(xe(c,n,a),gr(c,n,a)),n={cache:wo()},e.payload=n;return}n=n.return}}function pv(e,n,a){var c=ke();a={lane:c,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Ma(e)?xd(n,a):(a=Ro(e,n,a,c),a!==null&&(xe(a,e,c),Ad(a,n,c)))}function Sd(e,n,a){var c=ke();hr(e,n,a,c)}function hr(e,n,a,c){var m={lane:c,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ma(e))xd(n,m);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var S=n.lastRenderedState,L=p(S,a);if(m.hasEagerState=!0,m.eagerState=L,Oe(L,S))return pa(e,n,m,0),Gt===null&&ga(),!1}catch{}finally{}if(a=Ro(e,n,m,c),a!==null)return xe(a,e,c),Ad(a,n,c),!0}return!1}function Wo(e,n,a,c){if(c={lane:2,revertLane:Pu(),action:c,hasEagerState:!1,eagerState:null,next:null},Ma(e)){if(n)throw Error(s(479))}else n=Ro(e,a,c,2),n!==null&&xe(n,e,2)}function Ma(e){var n=e.alternate;return e===bt||n!==null&&n===bt}function xd(e,n){ds=La=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function Ad(e,n,a){if(a&4194176){var c=n.lanes;c&=e.pendingLanes,a|=c,n.lanes=a,kf(e,a)}}var li={readContext:ve,use:_a,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt};li.useCacheRefresh=Zt,li.useMemoCache=Zt,li.useHostTransitionStatus=Zt,li.useFormState=Zt,li.useActionState=Zt,li.useOptimistic=Zt;var On={readContext:ve,use:_a,useCallback:function(e,n){return Re().memoizedState=[e,n===void 0?null:n],e},useContext:ve,useEffect:od,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,Ia(4194308,4,fd.bind(null,n,e),a)},useLayoutEffect:function(e,n){return Ia(4194308,4,e,n)},useInsertionEffect:function(e,n){Ia(4,2,e,n)},useMemo:function(e,n){var a=Re();n=n===void 0?null:n;var c=e();if(_n){Vi(!0);try{e()}finally{Vi(!1)}}return a.memoizedState=[c,n],c},useReducer:function(e,n,a){var c=Re();if(a!==void 0){var m=a(n);if(_n){Vi(!0);try{a(n)}finally{Vi(!1)}}}else m=n;return c.memoizedState=c.baseState=m,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:m},c.queue=e,e=e.dispatch=pv.bind(null,bt,e),[c.memoizedState,e]},useRef:function(e){var n=Re();return e={current:e},n.memoizedState=e},useState:function(e){e=zo(e);var n=e.queue,a=Sd.bind(null,bt,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:Yo,useDeferredValue:function(e,n){var a=Re();return qo(a,e,n)},useTransition:function(){var e=zo(!1);return e=pd.bind(null,bt,e.queue,!0,!1),Re().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var c=bt,m=Re();if(It){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),Gt===null)throw Error(s(349));_t&60||Yh(c,n,a)}m.memoizedState=a;var p={value:a,getSnapshot:n};return m.queue=p,od(jh.bind(null,c,p,e),[e]),c.flags|=2048,gs(9,qh.bind(null,c,p,a,n),{destroy:void 0},null),a},useId:function(){var e=Re(),n=Gt.identifierPrefix;if(It){var a=Ai,c=xi;a=(c&~(1<<32-_e(c)-1)).toString(32)+a,n=":"+n+"R"+a,a=Da++,0<a&&(n+="H"+a.toString(32)),n+=":"}else a=cv++,n=":"+n+"r"+a.toString(32)+":";return e.memoizedState=n},useCacheRefresh:function(){return Re().memoizedState=gv.bind(null,bt)}};On.useMemoCache=Go,On.useHostTransitionStatus=Xo,On.useFormState=nd,On.useActionState=nd,On.useOptimistic=function(e){var n=Re();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=Wo.bind(null,bt,!0,a),a.dispatch=n,[e,n]};var Qi={readContext:ve,use:_a,useCallback:dd,useContext:ve,useEffect:Ko,useImperativeHandle:hd,useInsertionEffect:ud,useLayoutEffect:cd,useMemo:md,useReducer:Oa,useRef:ld,useState:function(){return Oa(Ri)},useDebugValue:Yo,useDeferredValue:function(e,n){var a=te();return gd(a,Ft.memoizedState,e,n)},useTransition:function(){var e=Oa(Ri)[0],n=te().memoizedState;return[typeof e=="boolean"?e:fr(e),n]},useSyncExternalStore:Kh,useId:Ed};Qi.useCacheRefresh=Td,Qi.useMemoCache=Go,Qi.useHostTransitionStatus=Xo,Qi.useFormState=sd,Qi.useActionState=sd,Qi.useOptimistic=function(e,n){var a=te();return Qh(a,Ft,e,n)};var In={readContext:ve,use:_a,useCallback:dd,useContext:ve,useEffect:Ko,useImperativeHandle:hd,useInsertionEffect:ud,useLayoutEffect:cd,useMemo:md,useReducer:Ho,useRef:ld,useState:function(){return Ho(Ri)},useDebugValue:Yo,useDeferredValue:function(e,n){var a=te();return Ft===null?qo(a,e,n):gd(a,Ft.memoizedState,e,n)},useTransition:function(){var e=Ho(Ri)[0],n=te().memoizedState;return[typeof e=="boolean"?e:fr(e),n]},useSyncExternalStore:Kh,useId:Ed};In.useCacheRefresh=Td,In.useMemoCache=Go,In.useHostTransitionStatus=Xo,In.useFormState=ad,In.useActionState=ad,In.useOptimistic=function(e,n){var a=te();return Ft!==null?Qh(a,Ft,e,n):(a.baseState=e,[e,a.queue.dispatch])};function Qo(e,n,a,c){n=e.memoizedState,a=a(c,n),a=a==null?n:P({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Zo={isMounted:function(e){return(e=e._reactInternals)?at(e)===e:!1},enqueueSetState:function(e,n,a){e=e._reactInternals;var c=ke(),m=tn(c);m.payload=n,a!=null&&(m.callback=a),n=en(e,m,c),n!==null&&(xe(n,e,c),gr(n,e,c))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var c=ke(),m=tn(c);m.tag=1,m.payload=n,a!=null&&(m.callback=a),n=en(e,m,c),n!==null&&(xe(n,e,c),gr(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=ke(),c=tn(a);c.tag=2,n!=null&&(c.callback=n),n=en(e,c,a),n!==null&&(xe(n,e,a),gr(n,e,a))}};function bd(e,n,a,c,m,p,S){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,p,S):n.prototype&&n.prototype.isPureReactComponent?!Js(a,c)||!Js(m,p):!0}function Rd(e,n,a,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,c),n.state!==e&&Zo.enqueueReplaceState(n,n.state,null)}function wn(e,n){var a=n;if("ref"in n){a={};for(var c in n)c!=="ref"&&(a[c]=n[c])}if(e=e.defaultProps){a===n&&(a=P({},a));for(var m in e)a[m]===void 0&&(a[m]=e[m])}return a}var ka=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Ld(e){ka(e)}function Dd(e){console.error(e)}function Cd(e){ka(e)}function Na(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function _d(e,n,a){try{var c=e.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Jo(e,n,a){return a=tn(a),a.tag=3,a.payload={element:null},a.callback=function(){Na(e,n)},a}function Od(e){return e=tn(e),e.tag=3,e}function Id(e,n,a,c){var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var p=c.value;e.payload=function(){return m(p)},e.callback=function(){_d(n,a,c)}}var S=a.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(e.callback=function(){_d(n,a,c),typeof m!="function"&&(on===null?on=new Set([this]):on.add(this));var L=c.stack;this.componentDidCatch(c.value,{componentStack:L!==null?L:""})})}function yv(e,n,a,c,m){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=a.alternate,n!==null&&mr(n,a,m,!0),a=$e.current,a!==null){switch(a.tag){case 13:return ai===null?ku():a.alternate===null&&Wt===0&&(Wt=3),a.flags&=-257,a.flags|=65536,a.lanes=m,c===_o?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([c]):n.add(c),Uu(e,c,m)),!1;case 22:return a.flags|=65536,c===_o?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([c]):a.add(c)),Uu(e,c,m)),!1}throw Error(s(435,a.tag))}return Uu(e,c,m),ku(),!1}if(It)return n=$e.current,n!==null?(!(n.flags&65536)&&(n.flags|=256),n.flags|=65536,n.lanes=m,c!==Co&&(e=Error(s(422),{cause:c}),nr(Be(e,a)))):(c!==Co&&(n=Error(s(423),{cause:c}),nr(Be(n,a))),e=e.current.alternate,e.flags|=65536,m&=-m,e.lanes|=m,c=Be(c,a),m=Jo(e.stateNode,c,m),mu(e,m),Wt!==4&&(Wt=2)),!1;var p=Error(s(520),{cause:c});if(p=Be(p,a),Ar===null?Ar=[p]:Ar.push(p),Wt!==4&&(Wt=2),n===null)return!0;c=Be(c,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=m&-m,a.lanes|=e,e=Jo(a.stateNode,c,e),mu(a,e),!1;case 1:if(n=a.type,p=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(on===null||!on.has(p))))return a.flags|=65536,m&=-m,a.lanes|=m,m=Od(m),Id(m,e,a,c),mu(a,m),!1}a=a.return}while(a!==null);return!1}var wd=Error(s(461)),le=!1;function me(e,n,a,c){n.child=e===null?Fh(n,null,a,c):Dn(n,e.child,a,c)}function Md(e,n,a,c,m){a=a.render;var p=n.ref;if("ref"in c){var S={};for(var L in c)L!=="ref"&&(S[L]=c[L])}else S=c;return kn(n),c=Uo(e,n,a,S,p,m),L=Fo(),e!==null&&!le?(Bo(e,n,m),Li(e,n,m)):(It&&L&&Lo(n),n.flags|=1,me(e,n,c,m),n.child)}function kd(e,n,a,c,m){if(e===null){var p=a.type;return typeof p=="function"&&!xu(p)&&p.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=p,Nd(e,n,p,c,m)):(e=Ga(a.type,null,c,n,n.mode,m),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!ou(e,m)){var S=p.memoizedProps;if(a=a.compare,a=a!==null?a:Js,a(S,c)&&e.ref===n.ref)return Li(e,n,m)}return n.flags|=1,e=an(p,c),e.ref=n.ref,e.return=n,n.child=e}function Nd(e,n,a,c,m){if(e!==null){var p=e.memoizedProps;if(Js(p,c)&&e.ref===n.ref)if(le=!1,n.pendingProps=c=p,ou(e,m))e.flags&131072&&(le=!0);else return n.lanes=e.lanes,Li(e,n,m)}return tu(e,n,a,c,m)}function Ud(e,n,a){var c=n.pendingProps,m=c.children,p=(n.stateNode._pendingVisibility&2)!==0,S=e!==null?e.memoizedState:null;if(dr(e,n),c.mode==="hidden"||p){if(n.flags&128){if(c=S!==null?S.baseLanes|a:a,e!==null){for(m=n.child=e.child,p=0;m!==null;)p=p|m.lanes|m.childLanes,m=m.sibling;n.childLanes=p&~c}else n.childLanes=0,n.child=null;return Fd(e,n,c,a)}if(a&536870912)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ra(n,S!==null?S.cachePool:null),S!==null?Bh(n,S):Oo(),Ph(n);else return n.lanes=n.childLanes=536870912,Fd(e,n,S!==null?S.baseLanes|a:a,a)}else S!==null?(Ra(n,S.cachePool),Bh(n,S),Xi(),n.memoizedState=null):(e!==null&&Ra(n,null),Oo(),Xi());return me(e,n,m,a),n.child}function Fd(e,n,a,c){var m=ko();return m=m===null?null:{parent:se._currentValue,pool:m},n.memoizedState={baseLanes:a,cachePool:m},e!==null&&Ra(n,null),Oo(),Ph(n),e!==null&&mr(e,n,c,!0),null}function dr(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=2097664);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=2097664)}}function tu(e,n,a,c,m){return kn(n),a=Uo(e,n,a,c,void 0,m),c=Fo(),e!==null&&!le?(Bo(e,n,m),Li(e,n,m)):(It&&c&&Lo(n),n.flags|=1,me(e,n,a,m),n.child)}function Bd(e,n,a,c,m,p){return kn(n),n.updateQueue=null,a=Vh(n,c,a,m),zh(e),c=Fo(),e!==null&&!le?(Bo(e,n,p),Li(e,n,p)):(It&&c&&Lo(n),n.flags|=1,me(e,n,a,p),n.child)}function Pd(e,n,a,c,m){if(kn(n),n.stateNode===null){var p=as,S=a.contextType;typeof S=="object"&&S!==null&&(p=ve(S)),p=new a(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Zo,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},hu(n),S=a.contextType,p.context=typeof S=="object"&&S!==null?ve(S):as,p.state=n.memoizedState,S=a.getDerivedStateFromProps,typeof S=="function"&&(Qo(n,a,S,c),p.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(S=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),S!==p.state&&Zo.enqueueReplaceState(p,p.state,null),yr(n,c,p,m),pr(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(e===null){p=n.stateNode;var L=n.memoizedProps,C=wn(a,L);p.props=C;var M=p.context,j=a.contextType;S=as,typeof j=="object"&&j!==null&&(S=ve(j));var tt=a.getDerivedStateFromProps;j=typeof tt=="function"||typeof p.getSnapshotBeforeUpdate=="function",L=n.pendingProps!==L,j||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(L||M!==S)&&Rd(n,p,c,S),Ji=!1;var $=n.memoizedState;p.state=$,yr(n,c,p,m),pr(),M=n.memoizedState,L||$!==M||Ji?(typeof tt=="function"&&(Qo(n,a,tt,c),M=n.memoizedState),(C=Ji||bd(n,a,C,c,$,M,S))?(j||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=M),p.props=c,p.state=M,p.context=S,c=C):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,du(e,n),S=n.memoizedProps,j=wn(a,S),p.props=j,tt=n.pendingProps,$=p.context,M=a.contextType,C=as,typeof M=="object"&&M!==null&&(C=ve(M)),L=a.getDerivedStateFromProps,(M=typeof L=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==tt||$!==C)&&Rd(n,p,c,C),Ji=!1,$=n.memoizedState,p.state=$,yr(n,c,p,m),pr();var Y=n.memoizedState;S!==tt||$!==Y||Ji||e!==null&&e.dependencies!==null&&Ua(e.dependencies)?(typeof L=="function"&&(Qo(n,a,L,c),Y=n.memoizedState),(j=Ji||bd(n,a,j,c,$,Y,C)||e!==null&&e.dependencies!==null&&Ua(e.dependencies))?(M||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,Y,C),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,Y,C)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&$===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&$===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=Y),p.props=c,p.state=Y,p.context=C,c=j):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&$===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&$===e.memoizedState||(n.flags|=1024),c=!1)}return p=c,dr(e,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&c?(n.child=Dn(n,e.child,null,m),n.child=Dn(n,null,a,m)):me(e,n,a,m),n.memoizedState=p.state,e=n.child):e=Li(e,n,m),e}function Gd(e,n,a,c){return ir(),n.flags|=256,me(e,n,a,c),n.child}var eu={dehydrated:null,treeContext:null,retryLane:0};function iu(e){return{baseLanes:e,cachePool:Hh()}}function nu(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=Ke),e}function $d(e,n,a){var c=n.pendingProps,m=!1,p=(n.flags&128)!==0,S;if((S=p)||(S=e!==null&&e.memoizedState===null?!1:(ne.current&2)!==0),S&&(m=!0,n.flags&=-129),S=(n.flags&32)!==0,n.flags&=-33,e===null){if(It){if(m?ji(n):Xi(),It){var L=de,C;if(C=L){t:{for(C=L,L=ri;C.nodeType!==8;){if(!L){L=null;break t}if(C=Je(C.nextSibling),C===null){L=null;break t}}L=C}L!==null?(n.memoizedState={dehydrated:L,treeContext:bn!==null?{id:xi,overflow:Ai}:null,retryLane:536870912},C=Ve(18,null,null,0),C.stateNode=L,C.return=n,n.child=C,Se=n,de=null,C=!0):C=!1}C||Ln(n)}if(L=n.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return L.data==="$!"?n.lanes=16:n.lanes=536870912,null;bi(n)}return L=c.children,c=c.fallback,m?(Xi(),m=n.mode,L=ru({mode:"hidden",children:L},m),c=Un(c,m,a,null),L.return=n,c.return=n,L.sibling=c,n.child=L,m=n.child,m.memoizedState=iu(a),m.childLanes=nu(e,S,a),n.memoizedState=eu,c):(ji(n),su(n,L))}if(C=e.memoizedState,C!==null&&(L=C.dehydrated,L!==null)){if(p)n.flags&256?(ji(n),n.flags&=-257,n=au(e,n,a)):n.memoizedState!==null?(Xi(),n.child=e.child,n.flags|=128,n=null):(Xi(),m=c.fallback,L=n.mode,c=ru({mode:"visible",children:c.children},L),m=Un(m,L,a,null),m.flags|=2,c.return=n,m.return=n,c.sibling=m,n.child=c,Dn(n,e.child,null,a),c=n.child,c.memoizedState=iu(a),c.childLanes=nu(e,S,a),n.memoizedState=eu,n=m);else if(ji(n),L.data==="$!"){if(S=L.nextSibling&&L.nextSibling.dataset,S)var M=S.dgst;S=M,c=Error(s(419)),c.stack="",c.digest=S,nr({value:c,source:null,stack:null}),n=au(e,n,a)}else if(le||mr(e,n,a,!1),S=(a&e.childLanes)!==0,le||S){if(S=Gt,S!==null){if(c=a&-a,c&42)c=1;else switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=64;break;case 268435456:c=134217728;break;default:c=0}if(c=c&(S.suspendedLanes|a)?0:c,c!==0&&c!==C.retryLane)throw C.retryLane=c,qi(e,c),xe(S,e,c),wd}L.data==="$?"||ku(),n=au(e,n,a)}else L.data==="$?"?(n.flags|=128,n.child=e.child,n=wv.bind(null,e),L._reactRetry=n,n=null):(e=C.treeContext,de=Je(L.nextSibling),Se=n,It=!0,Qe=null,ri=!1,e!==null&&(Pe[Ge++]=xi,Pe[Ge++]=Ai,Pe[Ge++]=bn,xi=e.id,Ai=e.overflow,bn=n),n=su(n,c.children),n.flags|=4096);return n}return m?(Xi(),m=c.fallback,L=n.mode,C=e.child,M=C.sibling,c=an(C,{mode:"hidden",children:c.children}),c.subtreeFlags=C.subtreeFlags&31457280,M!==null?m=an(M,m):(m=Un(m,L,a,null),m.flags|=2),m.return=n,c.return=n,c.sibling=m,n.child=c,c=m,m=n.child,L=e.child.memoizedState,L===null?L=iu(a):(C=L.cachePool,C!==null?(M=se._currentValue,C=C.parent!==M?{parent:M,pool:M}:C):C=Hh(),L={baseLanes:L.baseLanes|a,cachePool:C}),m.memoizedState=L,m.childLanes=nu(e,S,a),n.memoizedState=eu,c):(ji(n),a=e.child,e=a.sibling,a=an(a,{mode:"visible",children:c.children}),a.return=n,a.sibling=null,e!==null&&(S=n.deletions,S===null?(n.deletions=[e],n.flags|=16):S.push(e)),n.child=a,n.memoizedState=null,a)}function su(e,n){return n=ru({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function ru(e,n){return d0(e,n,0,null)}function au(e,n,a){return Dn(n,e.child,null,a),e=su(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Hd(e,n,a){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),cu(e.return,n,a)}function lu(e,n,a,c,m){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:m}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=a,p.tailMode=m)}function zd(e,n,a){var c=n.pendingProps,m=c.revealOrder,p=c.tail;if(me(e,n,c.children,a),c=ne.current,c&2)c=c&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hd(e,a,n);else if(e.tag===19)Hd(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}switch(Vt(ne,c),m){case"forwards":for(a=n.child,m=null;a!==null;)e=a.alternate,e!==null&&ba(e)===null&&(m=a),a=a.sibling;a=m,a===null?(m=n.child,n.child=null):(m=a.sibling,a.sibling=null),lu(n,!1,m,a,p);break;case"backwards":for(a=null,m=n.child,n.child=null;m!==null;){if(e=m.alternate,e!==null&&ba(e)===null){n.child=m;break}e=m.sibling,m.sibling=a,a=m,m=e}lu(n,!0,a,null,p);break;case"together":lu(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Li(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),ln|=n.lanes,!(a&n.childLanes))if(e!==null){if(mr(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=an(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=an(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function ou(e,n){return e.lanes&n?!0:(e=e.dependencies,!!(e!==null&&Ua(e)))}function vv(e,n,a){switch(n.tag){case 3:Zr(n,n.stateNode.containerInfo),Zi(n,se,e.memoizedState.cache),ir();break;case 27:case 5:Ql(n);break;case 4:Zr(n,n.stateNode.containerInfo);break;case 10:Zi(n,n.type,n.memoizedProps.value);break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(ji(n),n.flags|=128,null):a&n.child.childLanes?$d(e,n,a):(ji(n),e=Li(e,n,a),e!==null?e.sibling:null);ji(n);break;case 19:var m=(e.flags&128)!==0;if(c=(a&n.childLanes)!==0,c||(mr(e,n,a,!1),c=(a&n.childLanes)!==0),m){if(c)return zd(e,n,a);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Vt(ne,ne.current),c)break;return null;case 22:case 23:return n.lanes=0,Ud(e,n,a);case 24:Zi(n,se,e.memoizedState.cache)}return Li(e,n,a)}function Vd(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)le=!0;else{if(!ou(e,a)&&!(n.flags&128))return le=!1,vv(e,n,a);le=!!(e.flags&131072)}else le=!1,It&&n.flags&1048576&&Ch(n,Ea,n.index);switch(n.lanes=0,n.tag){case 16:t:{e=n.pendingProps;var c=n.elementType,m=c._init;if(c=m(c._payload),n.type=c,typeof c=="function")xu(c)?(e=wn(c,e),n.tag=1,n=Pd(null,n,c,e,a)):(n.tag=0,n=tu(null,n,c,e,a));else{if(c!=null){if(m=c.$$typeof,m===E){n.tag=11,n=Md(null,n,c,e,a);break t}else if(m===R){n.tag=14,n=kd(null,n,c,e,a);break t}}throw n=Q(c)||c,Error(s(306,n,""))}}return n;case 0:return tu(e,n,n.type,n.pendingProps,a);case 1:return c=n.type,m=wn(c,n.pendingProps),Pd(e,n,c,m,a);case 3:t:{if(Zr(n,n.stateNode.containerInfo),e===null)throw Error(s(387));var p=n.pendingProps;m=n.memoizedState,c=m.element,du(e,n),yr(n,p,null,a);var S=n.memoizedState;if(p=S.cache,Zi(n,se,p),p!==m.cache&&fu(n,[se],a,!0),pr(),p=S.element,m.isDehydrated)if(m={element:p,isDehydrated:!1,cache:S.cache},n.updateQueue.baseState=m,n.memoizedState=m,n.flags&256){n=Gd(e,n,p,a);break t}else if(p!==c){c=Be(Error(s(424)),n),nr(c),n=Gd(e,n,p,a);break t}else for(de=Je(n.stateNode.containerInfo.firstChild),Se=n,It=!0,Qe=null,ri=!0,a=Fh(n,null,p,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(ir(),p===c){n=Li(e,n,a);break t}me(e,n,p,a)}n=n.child}return n;case 26:return dr(e,n),e===null?(a=q0(n.type,null,n.pendingProps,null))?n.memoizedState=a:It||(a=n.type,e=n.pendingProps,c=Za(zi.current).createElement(a),c[ye]=n,c[Ae]=e,ge(c,a,e),ae(c),n.stateNode=c):n.memoizedState=q0(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Ql(n),e===null&&It&&(c=n.stateNode=V0(n.type,n.pendingProps,zi.current),Se=n,ri=!0,de=Je(c.firstChild)),c=n.pendingProps.children,e!==null||It?me(e,n,c,a):n.child=Dn(n,null,c,a),dr(e,n),n.child;case 5:return e===null&&It&&((m=c=de)&&(c=jv(c,n.type,n.pendingProps,ri),c!==null?(n.stateNode=c,Se=n,de=Je(c.firstChild),ri=!1,m=!0):m=!1),m||Ln(n)),Ql(n),m=n.type,p=n.pendingProps,S=e!==null?e.memoizedProps:null,c=p.children,ju(m,p)?c=null:S!==null&&ju(m,S)&&(n.flags|=32),n.memoizedState!==null&&(m=Uo(e,n,fv,null,null,a),wr._currentValue=m),dr(e,n),me(e,n,c,a),n.child;case 6:return e===null&&It&&((e=a=de)&&(a=Xv(a,n.pendingProps,ri),a!==null?(n.stateNode=a,Se=n,de=null,e=!0):e=!1),e||Ln(n)),null;case 13:return $d(e,n,a);case 4:return Zr(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=Dn(n,null,c,a):me(e,n,c,a),n.child;case 11:return Md(e,n,n.type,n.pendingProps,a);case 7:return me(e,n,n.pendingProps,a),n.child;case 8:return me(e,n,n.pendingProps.children,a),n.child;case 12:return me(e,n,n.pendingProps.children,a),n.child;case 10:return c=n.pendingProps,Zi(n,n.type,c.value),me(e,n,c.children,a),n.child;case 9:return m=n.type._context,c=n.pendingProps.children,kn(n),m=ve(m),c=c(m),n.flags|=1,me(e,n,c,a),n.child;case 14:return kd(e,n,n.type,n.pendingProps,a);case 15:return Nd(e,n,n.type,n.pendingProps,a);case 19:return zd(e,n,a);case 22:return Ud(e,n,a);case 24:return kn(n),c=ve(se),e===null?(m=ko(),m===null&&(m=Gt,p=wo(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=a),m=p),n.memoizedState={parent:c,cache:m},hu(n),Zi(n,se,m)):(e.lanes&a&&(du(e,n),yr(n,null,null,a),pr()),m=e.memoizedState,p=n.memoizedState,m.parent!==c?(m={parent:c,cache:c},n.memoizedState=m,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=m),Zi(n,se,c)):(c=p.cache,Zi(n,se,c),c!==m.cache&&fu(n,[se],a,!0))),me(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}var uu=Dt(null),Mn=null,Di=null;function Zi(e,n,a){Vt(uu,n._currentValue),n._currentValue=a}function Ci(e){e._currentValue=uu.current,zt(uu)}function cu(e,n,a){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===a)break;e=e.return}}function fu(e,n,a,c){var m=e.child;for(m!==null&&(m.return=e);m!==null;){var p=m.dependencies;if(p!==null){var S=m.child;p=p.firstContext;t:for(;p!==null;){var L=p;p=m;for(var C=0;C<n.length;C++)if(L.context===n[C]){p.lanes|=a,L=p.alternate,L!==null&&(L.lanes|=a),cu(p.return,a,e),c||(S=null);break t}p=L.next}}else if(m.tag===18){if(S=m.return,S===null)throw Error(s(341));S.lanes|=a,p=S.alternate,p!==null&&(p.lanes|=a),cu(S,a,e),S=null}else S=m.child;if(S!==null)S.return=m;else for(S=m;S!==null;){if(S===e){S=null;break}if(m=S.sibling,m!==null){m.return=S.return,S=m;break}S=S.return}m=S}}function mr(e,n,a,c){e=null;for(var m=n,p=!1;m!==null;){if(!p){if(m.flags&524288)p=!0;else if(m.flags&262144)break}if(m.tag===10){var S=m.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var L=m.type;Oe(m.pendingProps.value,S.value)||(e!==null?e.push(L):e=[L])}}else if(m===Qr.current){if(S=m.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(e!==null?e.push(wr):e=[wr])}m=m.return}e!==null&&fu(n,e,a,c),n.flags|=262144}function Ua(e){for(e=e.firstContext;e!==null;){if(!Oe(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function kn(e){Mn=e,Di=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ve(e){return Kd(Mn,e)}function Fa(e,n){return Mn===null&&kn(e),Kd(e,n)}function Kd(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Di===null){if(e===null)throw Error(s(308));Di=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Di=Di.next=n;return a}var Ji=!1;function hu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function du(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function tn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function en(e,n,a){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,Yt&2){var m=c.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),c.pending=n,n=ya(e),Lh(e,null,a),n}return pa(e,c,n,a),ya(e)}function gr(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194176)!==0)){var c=n.lanes;c&=e.pendingLanes,a|=c,n.lanes=a,kf(e,a)}}function mu(e,n){var a=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var m=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var S={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};p===null?m=p=S:p=p.next=S,a=a.next}while(a!==null);p===null?m=p=n:p=p.next=n}else m=p=n;a={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var gu=!1;function pr(){if(gu){var e=hs;if(e!==null)throw e}}function yr(e,n,a,c){gu=!1;var m=e.updateQueue;Ji=!1;var p=m.firstBaseUpdate,S=m.lastBaseUpdate,L=m.shared.pending;if(L!==null){m.shared.pending=null;var C=L,M=C.next;C.next=null,S===null?p=M:S.next=M,S=C;var j=e.alternate;j!==null&&(j=j.updateQueue,L=j.lastBaseUpdate,L!==S&&(L===null?j.firstBaseUpdate=M:L.next=M,j.lastBaseUpdate=C))}if(p!==null){var tt=m.baseState;S=0,j=M=C=null,L=p;do{var $=L.lane&-536870913,Y=$!==L.lane;if(Y?(_t&$)===$:(c&$)===$){$!==0&&$===fs&&(gu=!0),j!==null&&(j=j.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});t:{var ft=e,St=L;$=n;var Qt=a;switch(St.tag){case 1:if(ft=St.payload,typeof ft=="function"){tt=ft.call(Qt,tt,$);break t}tt=ft;break t;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=St.payload,$=typeof ft=="function"?ft.call(Qt,tt,$):ft,$==null)break t;tt=P({},tt,$);break t;case 2:Ji=!0}}$=L.callback,$!==null&&(e.flags|=64,Y&&(e.flags|=8192),Y=m.callbacks,Y===null?m.callbacks=[$]:Y.push($))}else Y={lane:$,tag:L.tag,payload:L.payload,callback:L.callback,next:null},j===null?(M=j=Y,C=tt):j=j.next=Y,S|=$;if(L=L.next,L===null){if(L=m.shared.pending,L===null)break;Y=L,L=Y.next,Y.next=null,m.lastBaseUpdate=Y,m.shared.pending=null}}while(!0);j===null&&(C=tt),m.baseState=C,m.firstBaseUpdate=M,m.lastBaseUpdate=j,p===null&&(m.shared.lanes=0),ln|=S,e.lanes=S,e.memoizedState=tt}}function Yd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function qd(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Yd(a[e],n)}function vr(e,n){try{var a=n.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var m=c.next;a=m;do{if((a.tag&e)===e){c=void 0;var p=a.create,S=a.inst;c=p(),S.destroy=c}a=a.next}while(a!==m)}}catch(L){Pt(n,n.return,L)}}function nn(e,n,a){try{var c=n.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var p=m.next;c=p;do{if((c.tag&e)===e){var S=c.inst,L=S.destroy;if(L!==void 0){S.destroy=void 0,m=n;var C=a;try{L()}catch(M){Pt(m,C,M)}}}c=c.next}while(c!==p)}}catch(M){Pt(n,n.return,M)}}function jd(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{qd(n,a)}catch(c){Pt(e,e.return,c)}}}function Xd(e,n,a){a.props=wn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(c){Pt(e,n,c)}}function Nn(e,n){try{var a=e.ref;if(a!==null){var c=e.stateNode;switch(e.tag){case 26:case 27:case 5:var m=c;break;default:m=c}typeof a=="function"?e.refCleanup=a(m):a.current=m}}catch(p){Pt(e,n,p)}}function Ie(e,n){var a=e.ref,c=e.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(m){Pt(e,n,m)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(m){Pt(e,n,m)}else a.current=null}function Wd(e){var n=e.type,a=e.memoizedProps,c=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break t;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(m){Pt(e,e.return,m)}}function Qd(e,n,a){try{var c=e.stateNode;zv(c,e.type,a,n),c[Ae]=n}catch(m){Pt(e,e.return,m)}}function Zd(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function pu(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Zd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yu(e,n,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?a.nodeType===8?a.parentNode.insertBefore(e,n):a.insertBefore(e,n):(a.nodeType===8?(n=a.parentNode,n.insertBefore(e,a)):(n=a,n.appendChild(e)),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Qa));else if(c!==4&&c!==27&&(e=e.child,e!==null))for(yu(e,n,a),e=e.sibling;e!==null;)yu(e,n,a),e=e.sibling}function Ba(e,n,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(c!==4&&c!==27&&(e=e.child,e!==null))for(Ba(e,n,a),e=e.sibling;e!==null;)Ba(e,n,a),e=e.sibling}var _i=!1,Xt=!1,vu=!1,Jd=typeof WeakSet=="function"?WeakSet:Set,oe=null,t0=!1;function Ev(e,n){if(e=e.containerInfo,Yu=sl,e=yh(e),To(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var m=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break t}var S=0,L=-1,C=-1,M=0,j=0,tt=e,$=null;e:for(;;){for(var Y;tt!==a||m!==0&&tt.nodeType!==3||(L=S+m),tt!==p||c!==0&&tt.nodeType!==3||(C=S+c),tt.nodeType===3&&(S+=tt.nodeValue.length),(Y=tt.firstChild)!==null;)$=tt,tt=Y;for(;;){if(tt===e)break e;if($===a&&++M===m&&(L=S),$===p&&++j===c&&(C=S),(Y=tt.nextSibling)!==null)break;tt=$,$=tt.parentNode}tt=Y}a=L===-1||C===-1?null:{start:L,end:C}}else a=null}a=a||{start:0,end:0}}else a=null;for(qu={focusedElem:e,selectionRange:a},sl=!1,oe=n;oe!==null;)if(n=oe,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,oe=e;else for(;oe!==null;){switch(n=oe,p=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&p!==null){e=void 0,a=n,m=p.memoizedProps,p=p.memoizedState,c=a.stateNode;try{var ft=wn(a.type,m,a.elementType===a.type);e=c.getSnapshotBeforeUpdate(ft,p),c.__reactInternalSnapshotBeforeUpdate=e}catch(St){Pt(a,a.return,St)}}break;case 3:if(e&1024){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)Qu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Qu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,oe=e;break}oe=n.return}return ft=t0,t0=!1,ft}function e0(e,n,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:Ii(e,a),c&4&&vr(5,a);break;case 1:if(Ii(e,a),c&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(L){Pt(a,a.return,L)}else{var m=wn(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(m,n,e.__reactInternalSnapshotBeforeUpdate)}catch(L){Pt(a,a.return,L)}}c&64&&jd(a),c&512&&Nn(a,a.return);break;case 3:if(Ii(e,a),c&64&&(c=a.updateQueue,c!==null)){if(e=null,a.child!==null)switch(a.child.tag){case 27:case 5:e=a.child.stateNode;break;case 1:e=a.child.stateNode}try{qd(c,e)}catch(L){Pt(a,a.return,L)}}break;case 26:Ii(e,a),c&512&&Nn(a,a.return);break;case 27:case 5:Ii(e,a),n===null&&c&4&&Wd(a),c&512&&Nn(a,a.return);break;case 12:Ii(e,a);break;case 13:Ii(e,a),c&4&&s0(e,a);break;case 22:if(m=a.memoizedState!==null||_i,!m){n=n!==null&&n.memoizedState!==null||Xt;var p=_i,S=Xt;_i=m,(Xt=n)&&!S?sn(e,a,(a.subtreeFlags&8772)!==0):Ii(e,a),_i=p,Xt=S}c&512&&(a.memoizedProps.mode==="manual"?Nn(a,a.return):Ie(a,a.return));break;default:Ii(e,a)}}function i0(e){var n=e.alternate;n!==null&&(e.alternate=null,i0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&no(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ee=null,we=!1;function Oi(e,n,a){for(a=a.child;a!==null;)n0(e,n,a),a=a.sibling}function n0(e,n,a){if(Ce&&typeof Ce.onCommitFiberUnmount=="function")try{Ce.onCommitFiberUnmount($s,a)}catch{}switch(a.tag){case 26:Xt||Ie(a,n),Oi(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Xt||Ie(a,n);var c=ee,m=we;for(ee=a.stateNode,Oi(e,n,a),a=a.stateNode,n=a.attributes;n.length;)a.removeAttributeNode(n[0]);no(a),ee=c,we=m;break;case 5:Xt||Ie(a,n);case 6:m=ee;var p=we;if(ee=null,Oi(e,n,a),ee=m,we=p,ee!==null)if(we)try{e=ee,c=a.stateNode,e.nodeType===8?e.parentNode.removeChild(c):e.removeChild(c)}catch(S){Pt(a,n,S)}else try{ee.removeChild(a.stateNode)}catch(S){Pt(a,n,S)}break;case 18:ee!==null&&(we?(n=ee,a=a.stateNode,n.nodeType===8?Wu(n.parentNode,a):n.nodeType===1&&Wu(n,a),Ur(n)):Wu(ee,a.stateNode));break;case 4:c=ee,m=we,ee=a.stateNode.containerInfo,we=!0,Oi(e,n,a),ee=c,we=m;break;case 0:case 11:case 14:case 15:Xt||nn(2,a,n),Xt||nn(4,a,n),Oi(e,n,a);break;case 1:Xt||(Ie(a,n),c=a.stateNode,typeof c.componentWillUnmount=="function"&&Xd(a,n,c)),Oi(e,n,a);break;case 21:Oi(e,n,a);break;case 22:Xt||Ie(a,n),Xt=(c=Xt)||a.memoizedState!==null,Oi(e,n,a),Xt=c;break;default:Oi(e,n,a)}}function s0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ur(e)}catch(a){Pt(n,n.return,a)}}function Tv(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Jd),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Jd),n;default:throw Error(s(435,e.tag))}}function Eu(e,n){var a=Tv(e);n.forEach(function(c){var m=Mv.bind(null,e,c);a.has(c)||(a.add(c),c.then(m,m))})}function He(e,n){var a=n.deletions;if(a!==null)for(var c=0;c<a.length;c++){var m=a[c],p=e,S=n,L=S;t:for(;L!==null;){switch(L.tag){case 27:case 5:ee=L.stateNode,we=!1;break t;case 3:ee=L.stateNode.containerInfo,we=!0;break t;case 4:ee=L.stateNode.containerInfo,we=!0;break t}L=L.return}if(ee===null)throw Error(s(160));n0(p,S,m),ee=null,we=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)r0(n,e),n=n.sibling}var Ze=null;function r0(e,n){var a=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:He(n,e),ze(e),c&4&&(nn(3,e,e.return),vr(3,e),nn(5,e,e.return));break;case 1:He(n,e),ze(e),c&512&&(Xt||a===null||Ie(a,a.return)),c&64&&_i&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var m=Ze;if(He(n,e),ze(e),c&512&&(Xt||a===null||Ie(a,a.return)),c&4){var p=a!==null?a.memoizedState:null;if(c=e.memoizedState,a===null)if(c===null)if(e.stateNode===null){t:{c=e.type,a=e.memoizedProps,m=m.ownerDocument||m;e:switch(c){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Vs]||p[ye]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(c),m.head.insertBefore(p,m.querySelector("head > title"))),ge(p,c,a),p[ye]=e,ae(p),c=p;break t;case"link":var S=W0("link","href",m).get(c+(a.href||""));if(S){for(var L=0;L<S.length;L++)if(p=S[L],p.getAttribute("href")===(a.href==null?null:a.href)&&p.getAttribute("rel")===(a.rel==null?null:a.rel)&&p.getAttribute("title")===(a.title==null?null:a.title)&&p.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){S.splice(L,1);break e}}p=m.createElement(c),ge(p,c,a),m.head.appendChild(p);break;case"meta":if(S=W0("meta","content",m).get(c+(a.content||""))){for(L=0;L<S.length;L++)if(p=S[L],p.getAttribute("content")===(a.content==null?null:""+a.content)&&p.getAttribute("name")===(a.name==null?null:a.name)&&p.getAttribute("property")===(a.property==null?null:a.property)&&p.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&p.getAttribute("charset")===(a.charSet==null?null:a.charSet)){S.splice(L,1);break e}}p=m.createElement(c),ge(p,c,a),m.head.appendChild(p);break;default:throw Error(s(468,c))}p[ye]=e,ae(p),c=p}e.stateNode=c}else Q0(m,e.type,e.stateNode);else e.stateNode=X0(m,c,e.memoizedProps);else p!==c?(p===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):p.count--,c===null?Q0(m,e.type,e.stateNode):X0(m,c,e.memoizedProps)):c===null&&e.stateNode!==null&&Qd(e,e.memoizedProps,a.memoizedProps)}break;case 27:if(c&4&&e.alternate===null){m=e.stateNode,p=e.memoizedProps;try{for(var C=m.firstChild;C;){var M=C.nextSibling,j=C.nodeName;C[Vs]||j==="HEAD"||j==="BODY"||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&C.rel.toLowerCase()==="stylesheet"||m.removeChild(C),C=M}for(var tt=e.type,$=m.attributes;$.length;)m.removeAttributeNode($[0]);ge(m,tt,p),m[ye]=e,m[Ae]=p}catch(ft){Pt(e,e.return,ft)}}case 5:if(He(n,e),ze(e),c&512&&(Xt||a===null||Ie(a,a.return)),e.flags&32){m=e.stateNode;try{Jn(m,"")}catch(ft){Pt(e,e.return,ft)}}c&4&&e.stateNode!=null&&(m=e.memoizedProps,Qd(e,m,a!==null?a.memoizedProps:m)),c&1024&&(vu=!0);break;case 6:if(He(n,e),ze(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,a=e.stateNode;try{a.nodeValue=c}catch(ft){Pt(e,e.return,ft)}}break;case 3:if(el=null,m=Ze,Ze=Ja(n.containerInfo),He(n,e),Ze=m,ze(e),c&4&&a!==null&&a.memoizedState.isDehydrated)try{Ur(n.containerInfo)}catch(ft){Pt(e,e.return,ft)}vu&&(vu=!1,a0(e));break;case 4:c=Ze,Ze=Ja(e.stateNode.containerInfo),He(n,e),ze(e),Ze=c;break;case 12:He(n,e),ze(e);break;case 13:He(n,e),ze(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Cu=si()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Eu(e,c)));break;case 22:if(c&512&&(Xt||a===null||Ie(a,a.return)),C=e.memoizedState!==null,M=a!==null&&a.memoizedState!==null,j=_i,tt=Xt,_i=j||C,Xt=tt||M,He(n,e),Xt=tt,_i=j,ze(e),n=e.stateNode,n._current=e,n._visibility&=-3,n._visibility|=n._pendingVisibility&2,c&8192&&(n._visibility=C?n._visibility&-2:n._visibility|1,C&&(n=_i||Xt,a===null||M||n||ps(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))t:for(a=null,n=e;;){if(n.tag===5||n.tag===26||n.tag===27){if(a===null){M=a=n;try{if(m=M.stateNode,C)p=m.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{S=M.stateNode,L=M.memoizedProps.style;var Y=L!=null&&L.hasOwnProperty("display")?L.display:null;S.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(ft){Pt(M,M.return,ft)}}}else if(n.tag===6){if(a===null){M=n;try{M.stateNode.nodeValue=C?"":M.memoizedProps}catch(ft){Pt(M,M.return,ft)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=e.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,Eu(e,a))));break;case 19:He(n,e),ze(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Eu(e,c)));break;case 21:break;default:He(n,e),ze(e)}}function ze(e){var n=e.flags;if(n&2){try{if(e.tag!==27){t:{for(var a=e.return;a!==null;){if(Zd(a)){var c=a;break t}a=a.return}throw Error(s(160))}switch(c.tag){case 27:var m=c.stateNode,p=pu(e);Ba(e,p,m);break;case 5:var S=c.stateNode;c.flags&32&&(Jn(S,""),c.flags&=-33);var L=pu(e);Ba(e,L,S);break;case 3:case 4:var C=c.stateNode.containerInfo,M=pu(e);yu(e,M,C);break;default:throw Error(s(161))}}}catch(j){Pt(e,e.return,j)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function a0(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;a0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ii(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)e0(e,n.alternate,n),n=n.sibling}function ps(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:nn(4,n,n.return),ps(n);break;case 1:Ie(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&Xd(n,n.return,a),ps(n);break;case 26:case 27:case 5:Ie(n,n.return),ps(n);break;case 22:Ie(n,n.return),n.memoizedState===null&&ps(n);break;default:ps(n)}e=e.sibling}}function sn(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,m=e,p=n,S=p.flags;switch(p.tag){case 0:case 11:case 15:sn(m,p,a),vr(4,p);break;case 1:if(sn(m,p,a),c=p,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(M){Pt(c,c.return,M)}if(c=p,m=c.updateQueue,m!==null){var L=c.stateNode;try{var C=m.shared.hiddenCallbacks;if(C!==null)for(m.shared.hiddenCallbacks=null,m=0;m<C.length;m++)Yd(C[m],L)}catch(M){Pt(c,c.return,M)}}a&&S&64&&jd(p),Nn(p,p.return);break;case 26:case 27:case 5:sn(m,p,a),a&&c===null&&S&4&&Wd(p),Nn(p,p.return);break;case 12:sn(m,p,a);break;case 13:sn(m,p,a),a&&S&4&&s0(m,p);break;case 22:p.memoizedState===null&&sn(m,p,a),Nn(p,p.return);break;default:sn(m,p,a)}n=n.sibling}}function Tu(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&or(a))}function Su(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&or(e))}function rn(e,n,a,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)l0(e,n,a,c),n=n.sibling}function l0(e,n,a,c){var m=n.flags;switch(n.tag){case 0:case 11:case 15:rn(e,n,a,c),m&2048&&vr(9,n);break;case 3:rn(e,n,a,c),m&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&or(e)));break;case 12:if(m&2048){rn(e,n,a,c),e=n.stateNode;try{var p=n.memoizedProps,S=p.id,L=p.onPostCommit;typeof L=="function"&&L(S,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(C){Pt(n,n.return,C)}}else rn(e,n,a,c);break;case 23:break;case 22:p=n.stateNode,n.memoizedState!==null?p._visibility&4?rn(e,n,a,c):Er(e,n):p._visibility&4?rn(e,n,a,c):(p._visibility|=4,ys(e,n,a,c,(n.subtreeFlags&10256)!==0)),m&2048&&Tu(n.alternate,n);break;case 24:rn(e,n,a,c),m&2048&&Su(n.alternate,n);break;default:rn(e,n,a,c)}}function ys(e,n,a,c,m){for(m=m&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=e,S=n,L=a,C=c,M=S.flags;switch(S.tag){case 0:case 11:case 15:ys(p,S,L,C,m),vr(8,S);break;case 23:break;case 22:var j=S.stateNode;S.memoizedState!==null?j._visibility&4?ys(p,S,L,C,m):Er(p,S):(j._visibility|=4,ys(p,S,L,C,m)),m&&M&2048&&Tu(S.alternate,S);break;case 24:ys(p,S,L,C,m),m&&M&2048&&Su(S.alternate,S);break;default:ys(p,S,L,C,m)}n=n.sibling}}function Er(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,c=n,m=c.flags;switch(c.tag){case 22:Er(a,c),m&2048&&Tu(c.alternate,c);break;case 24:Er(a,c),m&2048&&Su(c.alternate,c);break;default:Er(a,c)}n=n.sibling}}var Tr=8192;function vs(e){if(e.subtreeFlags&Tr)for(e=e.child;e!==null;)o0(e),e=e.sibling}function o0(e){switch(e.tag){case 26:vs(e),e.flags&Tr&&e.memoizedState!==null&&oE(Ze,e.memoizedState,e.memoizedProps);break;case 5:vs(e);break;case 3:case 4:var n=Ze;Ze=Ja(e.stateNode.containerInfo),vs(e),Ze=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=Tr,Tr=16777216,vs(e),Tr=n):vs(e));break;default:vs(e)}}function u0(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Sr(e){var n=e.deletions;if(e.flags&16){if(n!==null)for(var a=0;a<n.length;a++){var c=n[a];oe=c,f0(c,e)}u0(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)c0(e),e=e.sibling}function c0(e){switch(e.tag){case 0:case 11:case 15:Sr(e),e.flags&2048&&nn(9,e,e.return);break;case 3:Sr(e);break;case 12:Sr(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&4&&(e.return===null||e.return.tag!==13)?(n._visibility&=-5,Pa(e)):Sr(e);break;default:Sr(e)}}function Pa(e){var n=e.deletions;if(e.flags&16){if(n!==null)for(var a=0;a<n.length;a++){var c=n[a];oe=c,f0(c,e)}u0(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:nn(8,n,n.return),Pa(n);break;case 22:a=n.stateNode,a._visibility&4&&(a._visibility&=-5,Pa(n));break;default:Pa(n)}e=e.sibling}}function f0(e,n){for(;oe!==null;){var a=oe;switch(a.tag){case 0:case 11:case 15:nn(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:or(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,oe=c;else t:for(a=e;oe!==null;){c=oe;var m=c.sibling,p=c.return;if(i0(c),c===a){oe=null;break t}if(m!==null){m.return=p,oe=m;break t}oe=p}}}function Sv(e,n,a,c){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ve(e,n,a,c){return new Sv(e,n,a,c)}function xu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function an(e,n){var a=e.alternate;return a===null?(a=Ve(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&31457280,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function h0(e,n){e.flags&=31457282;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Ga(e,n,a,c,m,p){var S=0;if(c=e,typeof e=="function")xu(e)&&(S=1);else if(typeof e=="string")S=aE(e,a,ni.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case h:return Un(a.children,m,p,n);case d:S=8,m|=24;break;case g:return e=Ve(12,a,n,m|2),e.elementType=g,e.lanes=p,e;case x:return e=Ve(13,a,n,m),e.elementType=x,e.lanes=p,e;case A:return e=Ve(19,a,n,m),e.elementType=A,e.lanes=p,e;case _:return d0(a,m,p,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case y:case T:S=10;break t;case v:S=9;break t;case E:S=11;break t;case R:S=14;break t;case O:S=16,c=null;break t}S=29,a=Error(s(130,e===null?"null":typeof e,"")),c=null}return n=Ve(S,a,n,m),n.elementType=e,n.type=c,n.lanes=p,n}function Un(e,n,a,c){return e=Ve(7,e,c,n),e.lanes=a,e}function d0(e,n,a,c){e=Ve(22,e,c,n),e.elementType=_,e.lanes=a;var m={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var p=m._current;if(p===null)throw Error(s(456));if(!(m._pendingVisibility&2)){var S=qi(p,2);S!==null&&(m._pendingVisibility|=2,xe(S,p,2))}},attach:function(){var p=m._current;if(p===null)throw Error(s(456));if(m._pendingVisibility&2){var S=qi(p,2);S!==null&&(m._pendingVisibility&=-3,xe(S,p,2))}}};return e.stateNode=m,e}function Au(e,n,a){return e=Ve(6,e,null,n),e.lanes=a,e}function bu(e,n,a){return n=Ve(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function wi(e){e.flags|=4}function m0(e,n){if(n.type!=="stylesheet"||n.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!Z0(n)){if(n=$e.current,n!==null&&((_t&4194176)===_t?ai!==null:(_t&62914560)!==_t&&!(_t&536870912)||n!==ai))throw rr=_o,Ih;e.flags|=8192}}function $a(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?wf():536870912,e.lanes|=n,Ts|=n)}function xr(e,n){if(!It)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Kt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,c=0;if(n)for(var m=e.child;m!==null;)a|=m.lanes|m.childLanes,c|=m.subtreeFlags&31457280,c|=m.flags&31457280,m.return=e,m=m.sibling;else for(m=e.child;m!==null;)a|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=e,m=m.sibling;return e.subtreeFlags|=c,e.childLanes=a,n}function xv(e,n,a){var c=n.pendingProps;switch(Do(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(n),null;case 1:return Kt(n),null;case 3:return a=n.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Ci(se),qn(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(er(n)?wi(n):e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Qe!==null&&(wu(Qe),Qe=null))),Kt(n),null;case 26:return a=n.memoizedState,e===null?(wi(n),a!==null?(Kt(n),m0(n,a)):(Kt(n),n.flags&=-16777217)):a?a!==e.memoizedState?(wi(n),Kt(n),m0(n,a)):(Kt(n),n.flags&=-16777217):(e.memoizedProps!==c&&wi(n),Kt(n),n.flags&=-16777217),null;case 27:Jr(n),a=zi.current;var m=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==c&&wi(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Kt(n),null}e=ni.current,er(n)?_h(n):(e=V0(m,c,a),n.stateNode=e,wi(n))}return Kt(n),null;case 5:if(Jr(n),a=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&wi(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Kt(n),null}if(e=ni.current,er(n))_h(n);else{switch(m=Za(zi.current),e){case 1:e=m.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=m.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=m.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=m.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof c.is=="string"?m.createElement("select",{is:c.is}):m.createElement("select"),c.multiple?e.multiple=!0:c.size&&(e.size=c.size);break;default:e=typeof c.is=="string"?m.createElement(a,{is:c.is}):m.createElement(a)}}e[ye]=n,e[Ae]=c;t:for(m=n.child;m!==null;){if(m.tag===5||m.tag===6)e.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break t;for(;m.sibling===null;){if(m.return===null||m.return===n)break t;m=m.return}m.sibling.return=m.return,m=m.sibling}n.stateNode=e;t:switch(ge(e,a,c),a){case"button":case"input":case"select":case"textarea":e=!!c.autoFocus;break t;case"img":e=!0;break t;default:e=!1}e&&wi(n)}}return Kt(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==c&&wi(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(e=zi.current,er(n)){if(e=n.stateNode,a=n.memoizedProps,c=null,m=Se,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}e[ye]=n,e=!!(e.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||B0(e.nodeValue,a)),e||Ln(n)}else e=Za(e).createTextNode(c),e[ye]=n,n.stateNode=e}return Kt(n),null;case 13:if(c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(m=er(n),c!==null&&c.dehydrated!==null){if(e===null){if(!m)throw Error(s(318));if(m=n.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[ye]=n}else ir(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Kt(n),m=!1}else Qe!==null&&(wu(Qe),Qe=null),m=!0;if(!m)return n.flags&256?(bi(n),n):(bi(n),null)}if(bi(n),n.flags&128)return n.lanes=a,n;if(a=c!==null,e=e!==null&&e.memoizedState!==null,a){c=n.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool);var p=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==m&&(c.flags|=2048)}return a!==e&&a&&(n.child.flags|=8192),$a(n,n.updateQueue),Kt(n),null;case 4:return qn(),e===null&&zu(n.stateNode.containerInfo),Kt(n),null;case 10:return Ci(n.type),Kt(n),null;case 19:if(zt(ne),m=n.memoizedState,m===null)return Kt(n),null;if(c=(n.flags&128)!==0,p=m.rendering,p===null)if(c)xr(m,!1);else{if(Wt!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(p=ba(e),p!==null){for(n.flags|=128,xr(m,!1),e=p.updateQueue,n.updateQueue=e,$a(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)h0(a,e),a=a.sibling;return Vt(ne,ne.current&1|2),n.child}e=e.sibling}m.tail!==null&&si()>Ha&&(n.flags|=128,c=!0,xr(m,!1),n.lanes=4194304)}else{if(!c)if(e=ba(p),e!==null){if(n.flags|=128,c=!0,e=e.updateQueue,n.updateQueue=e,$a(n,e),xr(m,!0),m.tail===null&&m.tailMode==="hidden"&&!p.alternate&&!It)return Kt(n),null}else 2*si()-m.renderingStartTime>Ha&&a!==536870912&&(n.flags|=128,c=!0,xr(m,!1),n.lanes=4194304);m.isBackwards?(p.sibling=n.child,n.child=p):(e=m.last,e!==null?e.sibling=p:n.child=p,m.last=p)}return m.tail!==null?(n=m.tail,m.rendering=n,m.tail=n.sibling,m.renderingStartTime=si(),n.sibling=null,e=ne.current,Vt(ne,c?e&1|2:e&1),n):(Kt(n),null);case 22:case 23:return bi(n),Io(),c=n.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?a&536870912&&!(n.flags&128)&&(Kt(n),n.subtreeFlags&6&&(n.flags|=8192)):Kt(n),a=n.updateQueue,a!==null&&$a(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==a&&(n.flags|=2048),e!==null&&zt(Cn),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),Ci(se),Kt(n),null;case 25:return null}throw Error(s(156,n.tag))}function Av(e,n){switch(Do(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ci(se),qn(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Jr(n),null;case 13:if(bi(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ir()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return zt(ne),null;case 4:return qn(),null;case 10:return Ci(n.type),null;case 22:case 23:return bi(n),Io(),e!==null&&zt(Cn),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Ci(se),null;case 25:return null;default:return null}}function g0(e,n){switch(Do(n),n.tag){case 3:Ci(se),qn();break;case 26:case 27:case 5:Jr(n);break;case 4:qn();break;case 13:bi(n);break;case 19:zt(ne);break;case 10:Ci(n.type);break;case 22:case 23:bi(n),Io(),e!==null&&zt(Cn);break;case 24:Ci(se)}}var bv={getCacheForType:function(e){var n=ve(se),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a}},Rv=typeof WeakMap=="function"?WeakMap:Map,Yt=0,Gt=null,Lt=null,_t=0,$t=0,Me=null,Mi=!1,Es=!1,Ru=!1,ki=0,Wt=0,ln=0,Fn=0,Lu=0,Ke=0,Ts=0,Ar=null,oi=null,Du=!1,Cu=0,Ha=1/0,za=null,on=null,Va=!1,Bn=null,br=0,_u=0,Ou=null,Rr=0,Iu=null;function ke(){if(Yt&2&&_t!==0)return _t&-_t;if(z.T!==null){var e=fs;return e!==0?e:Pu()}return Uf()}function p0(){Ke===0&&(Ke=!(_t&536870912)||It?If():536870912);var e=$e.current;return e!==null&&(e.flags|=32),Ke}function xe(e,n,a){(e===Gt&&$t===2||e.cancelPendingCommit!==null)&&(Ss(e,0),Ni(e,_t,Ke,!1)),zs(e,a),(!(Yt&2)||e!==Gt)&&(e===Gt&&(!(Yt&2)&&(Fn|=a),Wt===4&&Ni(e,_t,Ke,!1)),ui(e))}function y0(e,n,a){if(Yt&6)throw Error(s(327));var c=!a&&(n&60)===0&&(n&e.expiredLanes)===0||Hs(e,n),m=c?Cv(e,n):Nu(e,n,!0),p=c;do{if(m===0){Es&&!c&&Ni(e,n,0,!1);break}else if(m===6)Ni(e,n,0,!Mi);else{if(a=e.current.alternate,p&&!Lv(a)){m=Nu(e,n,!1),p=!1;continue}if(m===2){if(p=n,e.errorRecoveryDisabledLanes&p)var S=0;else S=e.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){n=S;t:{var L=e;m=Ar;var C=L.current.memoizedState.isDehydrated;if(C&&(Ss(L,S).flags|=256),S=Nu(L,S,!1),S!==2){if(Ru&&!C){L.errorRecoveryDisabledLanes|=p,Fn|=p,m=4;break t}p=oi,oi=m,p!==null&&wu(p)}m=S}if(p=!1,m!==2)continue}}if(m===1){Ss(e,0),Ni(e,n,0,!0);break}t:{switch(c=e,m){case 0:case 1:throw Error(s(345));case 4:if((n&4194176)===n){Ni(c,n,Ke,!Mi);break t}break;case 2:oi=null;break;case 3:case 5:break;default:throw Error(s(329))}if(c.finishedWork=a,c.finishedLanes=n,(n&62914560)===n&&(p=Cu+300-si(),10<p)){if(Ni(c,n,Ke,!Mi),na(c,0)!==0)break t;c.timeoutHandle=$0(v0.bind(null,c,a,oi,za,Du,n,Ke,Fn,Ts,Mi,2,-0,0),p);break t}v0(c,a,oi,za,Du,n,Ke,Fn,Ts,Mi,0,-0,0)}}break}while(!0);ui(e)}function wu(e){oi===null?oi=e:oi.push.apply(oi,e)}function v0(e,n,a,c,m,p,S,L,C,M,j,tt,$){var Y=n.subtreeFlags;if((Y&8192||(Y&16785408)===16785408)&&(Ir={stylesheets:null,count:0,unsuspend:lE},o0(n),n=uE(),n!==null)){e.cancelPendingCommit=n(R0.bind(null,e,a,c,m,S,L,C,1,tt,$)),Ni(e,p,S,!M);return}R0(e,a,c,m,S,L,C,j,tt,$)}function Lv(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var m=a[c],p=m.getSnapshot;m=m.value;try{if(!Oe(p(),m))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ni(e,n,a,c){n&=~Lu,n&=~Fn,e.suspendedLanes|=n,e.pingedLanes&=~n,c&&(e.warmLanes|=n),c=e.expirationTimes;for(var m=n;0<m;){var p=31-_e(m),S=1<<p;c[p]=-1,m&=~S}a!==0&&Mf(e,a,n)}function Ka(){return Yt&6?!0:(Lr(0),!1)}function Mu(){if(Lt!==null){if($t===0)var e=Lt.return;else e=Lt,Di=Mn=null,Po(e),us=null,ar=0,e=Lt;for(;e!==null;)g0(e.alternate,e),e=e.return;Lt=null}}function Ss(e,n){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Kv(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Mu(),Gt=e,Lt=a=an(e.current,null),_t=n,$t=0,Me=null,Mi=!1,Es=Hs(e,n),Ru=!1,Ts=Ke=Lu=Fn=ln=Wt=0,oi=Ar=null,Du=!1,n&8&&(n|=n&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=n;0<c;){var m=31-_e(c),p=1<<m;n|=e[m],c&=~p}return ki=n,ga(),a}function E0(e,n){bt=null,z.H=li,n===sr?(n=kh(),$t=3):n===Ih?(n=kh(),$t=4):$t=n===wd?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Me=n,Lt===null&&(Wt=1,Na(e,Be(n,e.current)))}function T0(){var e=z.H;return z.H=li,e===null?li:e}function S0(){var e=z.A;return z.A=bv,e}function ku(){Wt=4,Mi||(_t&4194176)!==_t&&$e.current!==null||(Es=!0),!(ln&134217727)&&!(Fn&134217727)||Gt===null||Ni(Gt,_t,Ke,!1)}function Nu(e,n,a){var c=Yt;Yt|=2;var m=T0(),p=S0();(Gt!==e||_t!==n)&&(za=null,Ss(e,n)),n=!1;var S=Wt;t:do try{if($t!==0&&Lt!==null){var L=Lt,C=Me;switch($t){case 8:Mu(),S=6;break t;case 3:case 2:case 6:$e.current===null&&(n=!0);var M=$t;if($t=0,Me=null,xs(e,L,C,M),a&&Es){S=0;break t}break;default:M=$t,$t=0,Me=null,xs(e,L,C,M)}}Dv(),S=Wt;break}catch(j){E0(e,j)}while(!0);return n&&e.shellSuspendCounter++,Di=Mn=null,Yt=c,z.H=m,z.A=p,Lt===null&&(Gt=null,_t=0,ga()),S}function Dv(){for(;Lt!==null;)x0(Lt)}function Cv(e,n){var a=Yt;Yt|=2;var c=T0(),m=S0();Gt!==e||_t!==n?(za=null,Ha=si()+500,Ss(e,n)):Es=Hs(e,n);t:do try{if($t!==0&&Lt!==null){n=Lt;var p=Me;e:switch($t){case 1:$t=0,Me=null,xs(e,n,p,1);break;case 2:if(wh(p)){$t=0,Me=null,A0(n);break}n=function(){$t===2&&Gt===e&&($t=7),ui(e)},p.then(n,n);break t;case 3:$t=7;break t;case 4:$t=5;break t;case 7:wh(p)?($t=0,Me=null,A0(n)):($t=0,Me=null,xs(e,n,p,7));break;case 5:var S=null;switch(Lt.tag){case 26:S=Lt.memoizedState;case 5:case 27:var L=Lt;if(!S||Z0(S)){$t=0,Me=null;var C=L.sibling;if(C!==null)Lt=C;else{var M=L.return;M!==null?(Lt=M,Ya(M)):Lt=null}break e}}$t=0,Me=null,xs(e,n,p,5);break;case 6:$t=0,Me=null,xs(e,n,p,6);break;case 8:Mu(),Wt=6;break t;default:throw Error(s(462))}}_v();break}catch(j){E0(e,j)}while(!0);return Di=Mn=null,z.H=c,z.A=m,Yt=a,Lt!==null?0:(Gt=null,_t=0,ga(),Wt)}function _v(){for(;Lt!==null&&!Qp();)x0(Lt)}function x0(e){var n=Vd(e.alternate,e,ki);e.memoizedProps=e.pendingProps,n===null?Ya(e):Lt=n}function A0(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=Bd(a,n,n.pendingProps,n.type,void 0,_t);break;case 11:n=Bd(a,n,n.pendingProps,n.type.render,n.ref,_t);break;case 5:Po(n);default:g0(a,n),n=Lt=h0(n,ki),n=Vd(a,n,ki)}e.memoizedProps=e.pendingProps,n===null?Ya(e):Lt=n}function xs(e,n,a,c){Di=Mn=null,Po(n),us=null,ar=0;var m=n.return;try{if(yv(e,m,n,a,_t)){Wt=1,Na(e,Be(a,e.current)),Lt=null;return}}catch(p){if(m!==null)throw Lt=m,p;Wt=1,Na(e,Be(a,e.current)),Lt=null;return}n.flags&32768?(It||c===1?e=!0:Es||_t&536870912?e=!1:(Mi=e=!0,(c===2||c===3||c===6)&&(c=$e.current,c!==null&&c.tag===13&&(c.flags|=16384))),b0(n,e)):Ya(n)}function Ya(e){var n=e;do{if(n.flags&32768){b0(n,Mi);return}e=n.return;var a=xv(n.alternate,n,ki);if(a!==null){Lt=a;return}if(n=n.sibling,n!==null){Lt=n;return}Lt=n=e}while(n!==null);Wt===0&&(Wt=5)}function b0(e,n){do{var a=Av(e.alternate,e);if(a!==null){a.flags&=32767,Lt=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){Lt=e;return}Lt=e=a}while(e!==null);Wt=6,Lt=null}function R0(e,n,a,c,m,p,S,L,C,M){var j=z.T,tt=nt.p;try{nt.p=2,z.T=null,Ov(e,n,a,c,tt,m,p,S,L,C,M)}finally{z.T=j,nt.p=tt}}function Ov(e,n,a,c,m,p,S,L){do As();while(Bn!==null);if(Yt&6)throw Error(s(327));var C=e.finishedWork;if(c=e.finishedLanes,C===null)return null;if(e.finishedWork=null,e.finishedLanes=0,C===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var M=C.lanes|C.childLanes;if(M|=bo,oy(e,c,M,p,S,L),e===Gt&&(Lt=Gt=null,_t=0),!(C.subtreeFlags&10256)&&!(C.flags&10256)||Va||(Va=!0,_u=M,Ou=a,kv(ta,function(){return As(),null})),a=(C.flags&15990)!==0,C.subtreeFlags&15990||a?(a=z.T,z.T=null,p=nt.p,nt.p=2,S=Yt,Yt|=4,Ev(e,C),r0(C,e),tv(qu,e.containerInfo),sl=!!Yu,qu=Yu=null,e.current=C,e0(e,C.alternate,C),Zp(),Yt=S,nt.p=p,z.T=a):e.current=C,Va?(Va=!1,Bn=e,br=c):L0(e,M),M=e.pendingLanes,M===0&&(on=null),ny(C.stateNode),ui(e),n!==null)for(m=e.onRecoverableError,C=0;C<n.length;C++)M=n[C],m(M.value,{componentStack:M.stack});return br&3&&As(),M=e.pendingLanes,c&4194218&&M&42?e===Iu?Rr++:(Rr=0,Iu=e):Rr=0,Lr(0),null}function L0(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,or(n)))}function As(){if(Bn!==null){var e=Bn,n=_u;_u=0;var a=Nf(br),c=z.T,m=nt.p;try{if(nt.p=32>a?32:a,z.T=null,Bn===null)var p=!1;else{a=Ou,Ou=null;var S=Bn,L=br;if(Bn=null,br=0,Yt&6)throw Error(s(331));var C=Yt;if(Yt|=4,c0(S.current),l0(S,S.current,L,a),Yt=C,Lr(0,!1),Ce&&typeof Ce.onPostCommitFiberRoot=="function")try{Ce.onPostCommitFiberRoot($s,S)}catch{}p=!0}return p}finally{nt.p=m,z.T=c,L0(e,n)}}return!1}function D0(e,n,a){n=Be(a,n),n=Jo(e.stateNode,n,2),e=en(e,n,2),e!==null&&(zs(e,2),ui(e))}function Pt(e,n,a){if(e.tag===3)D0(e,e,a);else for(;n!==null;){if(n.tag===3){D0(n,e,a);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(on===null||!on.has(c))){e=Be(a,e),a=Od(2),c=en(n,a,2),c!==null&&(Id(a,c,n,e),zs(c,2),ui(c));break}}n=n.return}}function Uu(e,n,a){var c=e.pingCache;if(c===null){c=e.pingCache=new Rv;var m=new Set;c.set(n,m)}else m=c.get(n),m===void 0&&(m=new Set,c.set(n,m));m.has(a)||(Ru=!0,m.add(a),e=Iv.bind(null,e,n,a),n.then(e,e))}function Iv(e,n,a){var c=e.pingCache;c!==null&&c.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,Gt===e&&(_t&a)===a&&(Wt===4||Wt===3&&(_t&62914560)===_t&&300>si()-Cu?!(Yt&2)&&Ss(e,0):Lu|=a,Ts===_t&&(Ts=0)),ui(e)}function C0(e,n){n===0&&(n=wf()),e=qi(e,n),e!==null&&(zs(e,n),ui(e))}function wv(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),C0(e,a)}function Mv(e,n){var a=0;switch(e.tag){case 13:var c=e.stateNode,m=e.memoizedState;m!==null&&(a=m.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),C0(e,a)}function kv(e,n){return Jl(e,n)}var qa=null,bs=null,Fu=!1,ja=!1,Bu=!1,Pn=0;function ui(e){e!==bs&&e.next===null&&(bs===null?qa=bs=e:bs=bs.next=e),ja=!0,Fu||(Fu=!0,Uv(Nv))}function Lr(e,n){if(!Bu&&ja){Bu=!0;do for(var a=!1,c=qa;c!==null;){if(e!==0){var m=c.pendingLanes;if(m===0)var p=0;else{var S=c.suspendedLanes,L=c.pingedLanes;p=(1<<31-_e(42|e)+1)-1,p&=m&~(S&~L),p=p&201326677?p&201326677|1:p?p|2:0}p!==0&&(a=!0,I0(c,p))}else p=_t,p=na(c,c===Gt?p:0),!(p&3)||Hs(c,p)||(a=!0,I0(c,p));c=c.next}while(a);Bu=!1}}function Nv(){ja=Fu=!1;var e=0;Pn!==0&&(Vv()&&(e=Pn),Pn=0);for(var n=si(),a=null,c=qa;c!==null;){var m=c.next,p=_0(c,n);p===0?(c.next=null,a===null?qa=m:a.next=m,m===null&&(bs=a)):(a=c,(e!==0||p&3)&&(ja=!0)),c=m}Lr(e)}function _0(e,n){for(var a=e.suspendedLanes,c=e.pingedLanes,m=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var S=31-_e(p),L=1<<S,C=m[S];C===-1?(!(L&a)||L&c)&&(m[S]=ly(L,n)):C<=n&&(e.expiredLanes|=L),p&=~L}if(n=Gt,a=_t,a=na(e,e===n?a:0),c=e.callbackNode,a===0||e===n&&$t===2||e.cancelPendingCommit!==null)return c!==null&&c!==null&&to(c),e.callbackNode=null,e.callbackPriority=0;if(!(a&3)||Hs(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(c!==null&&to(c),Nf(a)){case 2:case 8:a=_f;break;case 32:a=ta;break;case 268435456:a=Of;break;default:a=ta}return c=O0.bind(null,e),a=Jl(a,c),e.callbackPriority=n,e.callbackNode=a,n}return c!==null&&c!==null&&to(c),e.callbackPriority=2,e.callbackNode=null,2}function O0(e,n){var a=e.callbackNode;if(As()&&e.callbackNode!==a)return null;var c=_t;return c=na(e,e===Gt?c:0),c===0?null:(y0(e,c,n),_0(e,si()),e.callbackNode!=null&&e.callbackNode===a?O0.bind(null,e):null)}function I0(e,n){if(As())return null;y0(e,n,!0)}function Uv(e){Yv(function(){Yt&6?Jl(Cf,e):e()})}function Pu(){return Pn===0&&(Pn=If()),Pn}function w0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:oa(""+e)}function M0(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Fv(e,n,a,c,m){if(n==="submit"&&a&&a.stateNode===m){var p=w0((m[Ae]||null).action),S=c.submitter;S&&(n=(n=S[Ae]||null)?w0(n.formAction):S.getAttribute("formAction"),n!==null&&(p=n,S=null));var L=new ha("action","action",null,c,m);e.push({event:L,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Pn!==0){var C=S?M0(m,S):new FormData(m);jo(a,{pending:!0,data:C,method:m.method,action:p},null,C)}}else typeof p=="function"&&(L.preventDefault(),C=S?M0(m,S):new FormData(m),jo(a,{pending:!0,data:C,method:m.method,action:p},p,C))},currentTarget:m}]})}}for(var Gu=0;Gu<Rh.length;Gu++){var $u=Rh[Gu],Bv=$u.toLowerCase(),Pv=$u[0].toUpperCase()+$u.slice(1);We(Bv,"on"+Pv)}We(Th,"onAnimationEnd"),We(Sh,"onAnimationIteration"),We(xh,"onAnimationStart"),We("dblclick","onDoubleClick"),We("focusin","onFocus"),We("focusout","onBlur"),We(iv,"onTransitionRun"),We(nv,"onTransitionStart"),We(sv,"onTransitionCancel"),We(Ah,"onTransitionEnd"),Qn("onMouseEnter",["mouseout","mouseover"]),Qn("onMouseLeave",["mouseout","mouseover"]),Qn("onPointerEnter",["pointerout","pointerover"]),Qn("onPointerLeave",["pointerout","pointerover"]),Tn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dr));function k0(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var c=e[a],m=c.event;c=c.listeners;t:{var p=void 0;if(n)for(var S=c.length-1;0<=S;S--){var L=c[S],C=L.instance,M=L.currentTarget;if(L=L.listener,C!==p&&m.isPropagationStopped())break t;p=L,m.currentTarget=M;try{p(m)}catch(j){ka(j)}m.currentTarget=null,p=C}else for(S=0;S<c.length;S++){if(L=c[S],C=L.instance,M=L.currentTarget,L=L.listener,C!==p&&m.isPropagationStopped())break t;p=L,m.currentTarget=M;try{p(m)}catch(j){ka(j)}m.currentTarget=null,p=C}}}}function Ct(e,n){var a=n[io];a===void 0&&(a=n[io]=new Set);var c=e+"__bubble";a.has(c)||(N0(n,e,2,!1),a.add(c))}function Hu(e,n,a){var c=0;n&&(c|=4),N0(a,e,c,n)}var Xa="_reactListening"+Math.random().toString(36).slice(2);function zu(e){if(!e[Xa]){e[Xa]=!0,Bf.forEach(function(a){a!=="selectionchange"&&(Gv.has(a)||Hu(a,!1,e),Hu(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Xa]||(n[Xa]=!0,Hu("selectionchange",!1,n))}}function N0(e,n,a,c){switch(sm(n)){case 2:var m=hE;break;case 8:m=dE;break;default:m=ic}a=m.bind(null,n,a,e),m=void 0,!co||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),c?m!==void 0?e.addEventListener(n,a,{capture:!0,passive:m}):e.addEventListener(n,a,!0):m!==void 0?e.addEventListener(n,a,{passive:m}):e.addEventListener(n,a,!1)}function Vu(e,n,a,c,m){var p=c;if(!(n&1)&&!(n&2)&&c!==null)t:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var L=c.stateNode.containerInfo;if(L===m||L.nodeType===8&&L.parentNode===m)break;if(S===4)for(S=c.return;S!==null;){var C=S.tag;if((C===3||C===4)&&(C=S.stateNode.containerInfo,C===m||C.nodeType===8&&C.parentNode===m))return;S=S.return}for(;L!==null;){if(S=En(L),S===null)return;if(C=S.tag,C===5||C===6||C===26||C===27){c=p=S;continue t}L=L.parentNode}}c=c.return}Wf(function(){var M=p,j=oo(a),tt=[];t:{var $=bh.get(e);if($!==void 0){var Y=ha,ft=e;switch(e){case"keypress":if(ca(a)===0)break t;case"keydown":case"keyup":Y=My;break;case"focusin":ft="focus",Y=go;break;case"focusout":ft="blur",Y=go;break;case"beforeblur":case"afterblur":Y=go;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=Uy;break;case Th:case Sh:case xh:Y=by;break;case Ah:Y=By;break;case"scroll":case"scrollend":Y=Ey;break;case"wheel":Y=Gy;break;case"copy":case"cut":case"paste":Y=Ly;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=eh;break;case"toggle":case"beforetoggle":Y=Hy}var St=(n&4)!==0,Qt=!St&&(e==="scroll"||e==="scrollend"),k=St?$!==null?$+"Capture":null:$;St=[];for(var w=M,U;w!==null;){var W=w;if(U=W.stateNode,W=W.tag,W!==5&&W!==26&&W!==27||U===null||k===null||(W=Ys(w,k),W!=null&&St.push(Cr(w,W,U))),Qt)break;w=w.return}0<St.length&&($=new Y($,ft,null,a,j),tt.push({event:$,listeners:St}))}}if(!(n&7)){t:{if($=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",$&&a!==lo&&(ft=a.relatedTarget||a.fromElement)&&(En(ft)||ft[jn]))break t;if((Y||$)&&($=j.window===j?j:($=j.ownerDocument)?$.defaultView||$.parentWindow:window,Y?(ft=a.relatedTarget||a.toElement,Y=M,ft=ft?En(ft):null,ft!==null&&(Qt=at(ft),St=ft.tag,ft!==Qt||St!==5&&St!==27&&St!==6)&&(ft=null)):(Y=null,ft=M),Y!==ft)){if(St=Jf,W="onMouseLeave",k="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(St=eh,W="onPointerLeave",k="onPointerEnter",w="pointer"),Qt=Y==null?$:Ks(Y),U=ft==null?$:Ks(ft),$=new St(W,w+"leave",Y,a,j),$.target=Qt,$.relatedTarget=U,W=null,En(j)===M&&(St=new St(k,w+"enter",ft,a,j),St.target=U,St.relatedTarget=Qt,W=St),Qt=W,Y&&ft)e:{for(St=Y,k=ft,w=0,U=St;U;U=Rs(U))w++;for(U=0,W=k;W;W=Rs(W))U++;for(;0<w-U;)St=Rs(St),w--;for(;0<U-w;)k=Rs(k),U--;for(;w--;){if(St===k||k!==null&&St===k.alternate)break e;St=Rs(St),k=Rs(k)}St=null}else St=null;Y!==null&&U0(tt,$,Y,St,!1),ft!==null&&Qt!==null&&U0(tt,Qt,ft,St,!0)}}t:{if($=M?Ks(M):window,Y=$.nodeName&&$.nodeName.toLowerCase(),Y==="select"||Y==="input"&&$.type==="file")var ut=uh;else if(lh($))if(ch)ut=Zy;else{ut=Wy;var Rt=Xy}else Y=$.nodeName,!Y||Y.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?M&&ao(M.elementType)&&(ut=uh):ut=Qy;if(ut&&(ut=ut(e,M))){oh(tt,ut,a,j);break t}Rt&&Rt(e,$,M),e==="focusout"&&M&&$.type==="number"&&M.memoizedProps.value!=null&&ro($,"number",$.value)}switch(Rt=M?Ks(M):window,e){case"focusin":(lh(Rt)||Rt.contentEditable==="true")&&(ns=Rt,So=M,tr=null);break;case"focusout":tr=So=ns=null;break;case"mousedown":xo=!0;break;case"contextmenu":case"mouseup":case"dragend":xo=!1,vh(tt,a,j);break;case"selectionchange":if(ev)break;case"keydown":case"keyup":vh(tt,a,j)}var dt;if(yo)t:{switch(e){case"compositionstart":var Et="onCompositionStart";break t;case"compositionend":Et="onCompositionEnd";break t;case"compositionupdate":Et="onCompositionUpdate";break t}Et=void 0}else is?rh(e,a)&&(Et="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Et="onCompositionStart");Et&&(ih&&a.locale!=="ko"&&(is||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&is&&(dt=Qf()):(Yi=j,fo="value"in Yi?Yi.value:Yi.textContent,is=!0)),Rt=Wa(M,Et),0<Rt.length&&(Et=new th(Et,e,null,a,j),tt.push({event:Et,listeners:Rt}),dt?Et.data=dt:(dt=ah(a),dt!==null&&(Et.data=dt)))),(dt=Vy?Ky(e,a):Yy(e,a))&&(Et=Wa(M,"onBeforeInput"),0<Et.length&&(Rt=new th("onBeforeInput","beforeinput",null,a,j),tt.push({event:Rt,listeners:Et}),Rt.data=dt)),Fv(tt,e,M,a,j)}k0(tt,n)})}function Cr(e,n,a){return{instance:e,listener:n,currentTarget:a}}function Wa(e,n){for(var a=n+"Capture",c=[];e!==null;){var m=e,p=m.stateNode;m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Ys(e,a),m!=null&&c.unshift(Cr(e,m,p)),m=Ys(e,n),m!=null&&c.push(Cr(e,m,p))),e=e.return}return c}function Rs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function U0(e,n,a,c,m){for(var p=n._reactName,S=[];a!==null&&a!==c;){var L=a,C=L.alternate,M=L.stateNode;if(L=L.tag,C!==null&&C===c)break;L!==5&&L!==26&&L!==27||M===null||(C=M,m?(M=Ys(a,p),M!=null&&S.unshift(Cr(a,M,C))):m||(M=Ys(a,p),M!=null&&S.push(Cr(a,M,C)))),a=a.return}S.length!==0&&e.push({event:n,listeners:S})}var $v=/\r\n?/g,Hv=/\u0000|\uFFFD/g;function F0(e){return(typeof e=="string"?e:""+e).replace($v,`
`).replace(Hv,"")}function B0(e,n){return n=F0(n),F0(e)===n}function Qa(){}function Bt(e,n,a,c,m,p){switch(a){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||Jn(e,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&Jn(e,""+c);break;case"className":ra(e,"class",c);break;case"tabIndex":ra(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ra(e,a,c);break;case"style":jf(e,c,p);break;case"data":if(n!=="object"){ra(e,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(a);break}c=oa(""+c),e.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(a==="formAction"?(n!=="input"&&Bt(e,n,"name",m.name,m,null),Bt(e,n,"formEncType",m.formEncType,m,null),Bt(e,n,"formMethod",m.formMethod,m,null),Bt(e,n,"formTarget",m.formTarget,m,null)):(Bt(e,n,"encType",m.encType,m,null),Bt(e,n,"method",m.method,m,null),Bt(e,n,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(a);break}c=oa(""+c),e.setAttribute(a,c);break;case"onClick":c!=null&&(e.onclick=Qa);break;case"onScroll":c!=null&&Ct("scroll",e);break;case"onScrollEnd":c!=null&&Ct("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(a=c.__html,a!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}a=oa(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,""+c):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":c===!0?e.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,c):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(a,c):e.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(a):e.setAttribute(a,c);break;case"popover":Ct("beforetoggle",e),Ct("toggle",e),sa(e,"popover",c);break;case"xlinkActuate":Si(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Si(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Si(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Si(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Si(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Si(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Si(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Si(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Si(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":sa(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=yy.get(a)||a,sa(e,a,c))}}function Ku(e,n,a,c,m,p){switch(a){case"style":jf(e,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(a=c.__html,a!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof c=="string"?Jn(e,c):(typeof c=="number"||typeof c=="bigint")&&Jn(e,""+c);break;case"onScroll":c!=null&&Ct("scroll",e);break;case"onScrollEnd":c!=null&&Ct("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Qa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pf.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(m=a.endsWith("Capture"),n=a.slice(2,m?a.length-7:void 0),p=e[Ae]||null,p=p!=null?p[a]:null,typeof p=="function"&&e.removeEventListener(n,p,m),typeof c=="function")){typeof p!="function"&&p!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,c,m);break t}a in e?e[a]=c:c===!0?e.setAttribute(a,""):sa(e,a,c)}}}function ge(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",e),Ct("load",e);var c=!1,m=!1,p;for(p in a)if(a.hasOwnProperty(p)){var S=a[p];if(S!=null)switch(p){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Bt(e,n,p,S,a,null)}}m&&Bt(e,n,"srcSet",a.srcSet,a,null),c&&Bt(e,n,"src",a.src,a,null);return;case"input":Ct("invalid",e);var L=p=S=m=null,C=null,M=null;for(c in a)if(a.hasOwnProperty(c)){var j=a[c];if(j!=null)switch(c){case"name":m=j;break;case"type":S=j;break;case"checked":C=j;break;case"defaultChecked":M=j;break;case"value":p=j;break;case"defaultValue":L=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:Bt(e,n,c,j,a,null)}}Vf(e,p,L,C,M,S,m,!1),aa(e);return;case"select":Ct("invalid",e),c=S=p=null;for(m in a)if(a.hasOwnProperty(m)&&(L=a[m],L!=null))switch(m){case"value":p=L;break;case"defaultValue":S=L;break;case"multiple":c=L;default:Bt(e,n,m,L,a,null)}n=p,a=S,e.multiple=!!c,n!=null?Zn(e,!!c,n,!1):a!=null&&Zn(e,!!c,a,!0);return;case"textarea":Ct("invalid",e),p=m=c=null;for(S in a)if(a.hasOwnProperty(S)&&(L=a[S],L!=null))switch(S){case"value":c=L;break;case"defaultValue":m=L;break;case"children":p=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(s(91));break;default:Bt(e,n,S,L,a,null)}Yf(e,c,m,p),aa(e);return;case"option":for(C in a)if(a.hasOwnProperty(C)&&(c=a[C],c!=null))switch(C){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Bt(e,n,C,c,a,null)}return;case"dialog":Ct("cancel",e),Ct("close",e);break;case"iframe":case"object":Ct("load",e);break;case"video":case"audio":for(c=0;c<Dr.length;c++)Ct(Dr[c],e);break;case"image":Ct("error",e),Ct("load",e);break;case"details":Ct("toggle",e);break;case"embed":case"source":case"link":Ct("error",e),Ct("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(M in a)if(a.hasOwnProperty(M)&&(c=a[M],c!=null))switch(M){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Bt(e,n,M,c,a,null)}return;default:if(ao(n)){for(j in a)a.hasOwnProperty(j)&&(c=a[j],c!==void 0&&Ku(e,n,j,c,a,void 0));return}}for(L in a)a.hasOwnProperty(L)&&(c=a[L],c!=null&&Bt(e,n,L,c,a,null))}function zv(e,n,a,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,S=null,L=null,C=null,M=null,j=null;for(Y in a){var tt=a[Y];if(a.hasOwnProperty(Y)&&tt!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":C=tt;default:c.hasOwnProperty(Y)||Bt(e,n,Y,null,c,tt)}}for(var $ in c){var Y=c[$];if(tt=a[$],c.hasOwnProperty($)&&(Y!=null||tt!=null))switch($){case"type":p=Y;break;case"name":m=Y;break;case"checked":M=Y;break;case"defaultChecked":j=Y;break;case"value":S=Y;break;case"defaultValue":L=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(137,n));break;default:Y!==tt&&Bt(e,n,$,Y,c,tt)}}so(e,S,L,C,M,j,p,m);return;case"select":Y=S=L=$=null;for(p in a)if(C=a[p],a.hasOwnProperty(p)&&C!=null)switch(p){case"value":break;case"multiple":Y=C;default:c.hasOwnProperty(p)||Bt(e,n,p,null,c,C)}for(m in c)if(p=c[m],C=a[m],c.hasOwnProperty(m)&&(p!=null||C!=null))switch(m){case"value":$=p;break;case"defaultValue":L=p;break;case"multiple":S=p;default:p!==C&&Bt(e,n,m,p,c,C)}n=L,a=S,c=Y,$!=null?Zn(e,!!a,$,!1):!!c!=!!a&&(n!=null?Zn(e,!!a,n,!0):Zn(e,!!a,a?[]:"",!1));return;case"textarea":Y=$=null;for(L in a)if(m=a[L],a.hasOwnProperty(L)&&m!=null&&!c.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Bt(e,n,L,null,c,m)}for(S in c)if(m=c[S],p=a[S],c.hasOwnProperty(S)&&(m!=null||p!=null))switch(S){case"value":$=m;break;case"defaultValue":Y=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==p&&Bt(e,n,S,m,c,p)}Kf(e,$,Y);return;case"option":for(var ft in a)if($=a[ft],a.hasOwnProperty(ft)&&$!=null&&!c.hasOwnProperty(ft))switch(ft){case"selected":e.selected=!1;break;default:Bt(e,n,ft,null,c,$)}for(C in c)if($=c[C],Y=a[C],c.hasOwnProperty(C)&&$!==Y&&($!=null||Y!=null))switch(C){case"selected":e.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:Bt(e,n,C,$,c,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var St in a)$=a[St],a.hasOwnProperty(St)&&$!=null&&!c.hasOwnProperty(St)&&Bt(e,n,St,null,c,$);for(M in c)if($=c[M],Y=a[M],c.hasOwnProperty(M)&&$!==Y&&($!=null||Y!=null))switch(M){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(s(137,n));break;default:Bt(e,n,M,$,c,Y)}return;default:if(ao(n)){for(var Qt in a)$=a[Qt],a.hasOwnProperty(Qt)&&$!==void 0&&!c.hasOwnProperty(Qt)&&Ku(e,n,Qt,void 0,c,$);for(j in c)$=c[j],Y=a[j],!c.hasOwnProperty(j)||$===Y||$===void 0&&Y===void 0||Ku(e,n,j,$,c,Y);return}}for(var k in a)$=a[k],a.hasOwnProperty(k)&&$!=null&&!c.hasOwnProperty(k)&&Bt(e,n,k,null,c,$);for(tt in c)$=c[tt],Y=a[tt],!c.hasOwnProperty(tt)||$===Y||$==null&&Y==null||Bt(e,n,tt,$,c,Y)}var Yu=null,qu=null;function Za(e){return e.nodeType===9?e:e.ownerDocument}function P0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function G0(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function ju(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Xu=null;function Vv(){var e=window.event;return e&&e.type==="popstate"?e===Xu?!1:(Xu=e,!0):(Xu=null,!1)}var $0=typeof setTimeout=="function"?setTimeout:void 0,Kv=typeof clearTimeout=="function"?clearTimeout:void 0,H0=typeof Promise=="function"?Promise:void 0,Yv=typeof queueMicrotask=="function"?queueMicrotask:typeof H0<"u"?function(e){return H0.resolve(null).then(e).catch(qv)}:$0;function qv(e){setTimeout(function(){throw e})}function Wu(e,n){var a=n,c=0;do{var m=a.nextSibling;if(e.removeChild(a),m&&m.nodeType===8)if(a=m.data,a==="/$"){if(c===0){e.removeChild(m),Ur(n);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=m}while(a);Ur(n)}function Qu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Qu(a),no(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function jv(e,n,a,c){for(;e.nodeType===1;){var m=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[Vs])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==m.rel||e.getAttribute("href")!==(m.href==null?null:m.href)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||e.getAttribute("title")!==(m.title==null?null:m.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(m.src==null?null:m.src)||e.getAttribute("type")!==(m.type==null?null:m.type)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=Je(e.nextSibling),e===null)break}return null}function Xv(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Je(e.nextSibling),e===null))return null;return e}function Je(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}function z0(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(n===0)return e;n--}else a==="/$"&&n++}e=e.previousSibling}return null}function V0(e,n,a){switch(n=Za(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}var Ye=new Map,K0=new Set;function Ja(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var Ui=nt.d;nt.d={f:Wv,r:Qv,D:Zv,C:Jv,L:tE,m:eE,X:nE,S:iE,M:sE};function Wv(){var e=Ui.f(),n=Ka();return e||n}function Qv(e){var n=Xn(e);n!==null&&n.tag===5&&n.type==="form"?vd(n):Ui.r(e)}var Ls=typeof document>"u"?null:document;function Y0(e,n,a){var c=Ls;if(c&&typeof n=="string"&&n){var m=Ue(n);m='link[rel="'+e+'"][href="'+m+'"]',typeof a=="string"&&(m+='[crossorigin="'+a+'"]'),K0.has(m)||(K0.add(m),e={rel:e,crossOrigin:a,href:n},c.querySelector(m)===null&&(n=c.createElement("link"),ge(n,"link",e),ae(n),c.head.appendChild(n)))}}function Zv(e){Ui.D(e),Y0("dns-prefetch",e,null)}function Jv(e,n){Ui.C(e,n),Y0("preconnect",e,n)}function tE(e,n,a){Ui.L(e,n,a);var c=Ls;if(c&&e&&n){var m='link[rel="preload"][as="'+Ue(n)+'"]';n==="image"&&a&&a.imageSrcSet?(m+='[imagesrcset="'+Ue(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(m+='[imagesizes="'+Ue(a.imageSizes)+'"]')):m+='[href="'+Ue(e)+'"]';var p=m;switch(n){case"style":p=Ds(e);break;case"script":p=Cs(e)}Ye.has(p)||(e=P({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),Ye.set(p,e),c.querySelector(m)!==null||n==="style"&&c.querySelector(_r(p))||n==="script"&&c.querySelector(Or(p))||(n=c.createElement("link"),ge(n,"link",e),ae(n),c.head.appendChild(n)))}}function eE(e,n){Ui.m(e,n);var a=Ls;if(a&&e){var c=n&&typeof n.as=="string"?n.as:"script",m='link[rel="modulepreload"][as="'+Ue(c)+'"][href="'+Ue(e)+'"]',p=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Cs(e)}if(!Ye.has(p)&&(e=P({rel:"modulepreload",href:e},n),Ye.set(p,e),a.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Or(p)))return}c=a.createElement("link"),ge(c,"link",e),ae(c),a.head.appendChild(c)}}}function iE(e,n,a){Ui.S(e,n,a);var c=Ls;if(c&&e){var m=Wn(c).hoistableStyles,p=Ds(e);n=n||"default";var S=m.get(p);if(!S){var L={loading:0,preload:null};if(S=c.querySelector(_r(p)))L.loading=5;else{e=P({rel:"stylesheet",href:e,"data-precedence":n},a),(a=Ye.get(p))&&Zu(e,a);var C=S=c.createElement("link");ae(C),ge(C,"link",e),C._p=new Promise(function(M,j){C.onload=M,C.onerror=j}),C.addEventListener("load",function(){L.loading|=1}),C.addEventListener("error",function(){L.loading|=2}),L.loading|=4,tl(S,n,c)}S={type:"stylesheet",instance:S,count:1,state:L},m.set(p,S)}}}function nE(e,n){Ui.X(e,n);var a=Ls;if(a&&e){var c=Wn(a).hoistableScripts,m=Cs(e),p=c.get(m);p||(p=a.querySelector(Or(m)),p||(e=P({src:e,async:!0},n),(n=Ye.get(m))&&Ju(e,n),p=a.createElement("script"),ae(p),ge(p,"link",e),a.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function sE(e,n){Ui.M(e,n);var a=Ls;if(a&&e){var c=Wn(a).hoistableScripts,m=Cs(e),p=c.get(m);p||(p=a.querySelector(Or(m)),p||(e=P({src:e,async:!0,type:"module"},n),(n=Ye.get(m))&&Ju(e,n),p=a.createElement("script"),ae(p),ge(p,"link",e),a.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function q0(e,n,a,c){var m=(m=zi.current)?Ja(m):null;if(!m)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=Ds(a.href),a=Wn(m).hoistableStyles,c=a.get(n),c||(c={type:"style",instance:null,count:0,state:null},a.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Ds(a.href);var p=Wn(m).hoistableStyles,S=p.get(e);if(S||(m=m.ownerDocument||m,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,S),(p=m.querySelector(_r(e)))&&!p._p&&(S.instance=p,S.state.loading=5),Ye.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Ye.set(e,a),p||rE(m,e,a,S.state))),n&&c===null)throw Error(s(528,""));return S}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Cs(a),a=Wn(m).hoistableScripts,c=a.get(n),c||(c={type:"script",instance:null,count:0,state:null},a.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Ds(e){return'href="'+Ue(e)+'"'}function _r(e){return'link[rel="stylesheet"]['+e+"]"}function j0(e){return P({},e,{"data-precedence":e.precedence,precedence:null})}function rE(e,n,a,c){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=e.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),ge(n,"link",a),ae(n),e.head.appendChild(n))}function Cs(e){return'[src="'+Ue(e)+'"]'}function Or(e){return"script[async]"+e}function X0(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var c=e.querySelector('style[data-href~="'+Ue(a.href)+'"]');if(c)return n.instance=c,ae(c),c;var m=P({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),ae(c),ge(c,"style",m),tl(c,a.precedence,e),n.instance=c;case"stylesheet":m=Ds(a.href);var p=e.querySelector(_r(m));if(p)return n.state.loading|=4,n.instance=p,ae(p),p;c=j0(a),(m=Ye.get(m))&&Zu(c,m),p=(e.ownerDocument||e).createElement("link"),ae(p);var S=p;return S._p=new Promise(function(L,C){S.onload=L,S.onerror=C}),ge(p,"link",c),n.state.loading|=4,tl(p,a.precedence,e),n.instance=p;case"script":return p=Cs(a.src),(m=e.querySelector(Or(p)))?(n.instance=m,ae(m),m):(c=a,(m=Ye.get(p))&&(c=P({},a),Ju(c,m)),e=e.ownerDocument||e,m=e.createElement("script"),ae(m),ge(m,"link",c),e.head.appendChild(m),n.instance=m);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&!(n.state.loading&4)&&(c=n.instance,n.state.loading|=4,tl(c,a.precedence,e));return n.instance}function tl(e,n,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,p=m,S=0;S<c.length;S++){var L=c[S];if(L.dataset.precedence===n)p=L;else if(p!==m)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function Zu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Ju(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var el=null;function W0(e,n,a){if(el===null){var c=new Map,m=el=new Map;m.set(a,c)}else m=el,c=m.get(a),c||(c=new Map,m.set(a,c));if(c.has(e))return c;for(c.set(e,null),a=a.getElementsByTagName(e),m=0;m<a.length;m++){var p=a[m];if(!(p[Vs]||p[ye]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var S=p.getAttribute(n)||"";S=e+S;var L=c.get(S);L?L.push(p):c.set(S,[p])}}return c}function Q0(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function aE(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Z0(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Ir=null;function lE(){}function oE(e,n,a){if(Ir===null)throw Error(s(475));var c=Ir;if(n.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var m=Ds(a.href),p=e.querySelector(_r(m));if(p){e=p._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(c.count++,c=il.bind(c),e.then(c,c)),n.state.loading|=4,n.instance=p,ae(p);return}p=e.ownerDocument||e,a=j0(a),(m=Ye.get(m))&&Zu(a,m),p=p.createElement("link"),ae(p);var S=p;S._p=new Promise(function(L,C){S.onload=L,S.onerror=C}),ge(p,"link",a),n.instance=p}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(c.count++,n=il.bind(c),e.addEventListener("load",n),e.addEventListener("error",n))}}function uE(){if(Ir===null)throw Error(s(475));var e=Ir;return e.stylesheets&&e.count===0&&tc(e,e.stylesheets),0<e.count?function(n){var a=setTimeout(function(){if(e.stylesheets&&tc(e,e.stylesheets),e.unsuspend){var c=e.unsuspend;e.unsuspend=null,c()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a)}}:null}function il(){if(this.count--,this.count===0){if(this.stylesheets)tc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var nl=null;function tc(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,nl=new Map,n.forEach(cE,e),nl=null,il.call(e))}function cE(e,n){if(!(n.state.loading&4)){var a=nl.get(e);if(a)var c=a.get(null);else{a=new Map,nl.set(e,a);for(var m=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var S=m[p];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(a.set(S.dataset.precedence,S),c=S)}c&&a.set(null,c)}m=n.instance,S=m.getAttribute("data-precedence"),p=a.get(S)||c,p===c&&a.set(null,m),a.set(S,m),this.count++,c=il.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),p?p.parentNode.insertBefore(m,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(m,e.firstChild)),n.state.loading|=4}}var wr={$$typeof:T,Provider:null,Consumer:null,_currentValue:pt,_currentValue2:pt,_threadCount:0};function fE(e,n,a,c,m,p,S,L){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=eo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eo(0),this.hiddenUpdates=eo(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function J0(e,n,a,c,m,p,S,L,C,M,j,tt){return e=new fE(e,n,a,S,L,C,M,tt),n=1,p===!0&&(n|=24),p=Ve(3,null,null,n),e.current=p,p.stateNode=e,n=wo(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:a,cache:n},hu(p),e}function tm(e){return e?(e=as,e):as}function em(e,n,a,c,m,p){m=tm(m),c.context===null?c.context=m:c.pendingContext=m,c=tn(n),c.payload={element:a},p=p===void 0?null:p,p!==null&&(c.callback=p),a=en(e,c,n),a!==null&&(xe(a,e,n),gr(a,e,n))}function im(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function ec(e,n){im(e,n),(e=e.alternate)&&im(e,n)}function nm(e){if(e.tag===13){var n=qi(e,67108864);n!==null&&xe(n,e,67108864),ec(e,67108864)}}var sl=!0;function hE(e,n,a,c){var m=z.T;z.T=null;var p=nt.p;try{nt.p=2,ic(e,n,a,c)}finally{nt.p=p,z.T=m}}function dE(e,n,a,c){var m=z.T;z.T=null;var p=nt.p;try{nt.p=8,ic(e,n,a,c)}finally{nt.p=p,z.T=m}}function ic(e,n,a,c){if(sl){var m=nc(c);if(m===null)Vu(e,n,c,rl,a),rm(e,c);else if(gE(m,e,n,a,c))c.stopPropagation();else if(rm(e,c),n&4&&-1<mE.indexOf(e)){for(;m!==null;){var p=Xn(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var S=vn(p.pendingLanes);if(S!==0){var L=p;for(L.pendingLanes|=2,L.entangledLanes|=2;S;){var C=1<<31-_e(S);L.entanglements[1]|=C,S&=~C}ui(p),!(Yt&6)&&(Ha=si()+500,Lr(0))}}break;case 13:L=qi(p,2),L!==null&&xe(L,p,2),Ka(),ec(p,2)}if(p=nc(c),p===null&&Vu(e,n,c,rl,a),p===m)break;m=p}m!==null&&c.stopPropagation()}else Vu(e,n,c,null,a)}}function nc(e){return e=oo(e),sc(e)}var rl=null;function sc(e){if(rl=null,e=En(e),e!==null){var n=at(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=et(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return rl=e,null}function sm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jp()){case Cf:return 2;case _f:return 8;case ta:case ty:return 32;case Of:return 268435456;default:return 32}default:return 32}}var rc=!1,un=null,cn=null,fn=null,Mr=new Map,kr=new Map,hn=[],mE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rm(e,n){switch(e){case"focusin":case"focusout":un=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":fn=null;break;case"pointerover":case"pointerout":Mr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":kr.delete(n.pointerId)}}function Nr(e,n,a,c,m,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:a,eventSystemFlags:c,nativeEvent:p,targetContainers:[m]},n!==null&&(n=Xn(n),n!==null&&nm(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),e)}function gE(e,n,a,c,m){switch(n){case"focusin":return un=Nr(un,e,n,a,c,m),!0;case"dragenter":return cn=Nr(cn,e,n,a,c,m),!0;case"mouseover":return fn=Nr(fn,e,n,a,c,m),!0;case"pointerover":var p=m.pointerId;return Mr.set(p,Nr(Mr.get(p)||null,e,n,a,c,m)),!0;case"gotpointercapture":return p=m.pointerId,kr.set(p,Nr(kr.get(p)||null,e,n,a,c,m)),!0}return!1}function am(e){var n=En(e.target);if(n!==null){var a=at(n);if(a!==null){if(n=a.tag,n===13){if(n=et(a),n!==null){e.blockedOn=n,uy(e.priority,function(){if(a.tag===13){var c=ke(),m=qi(a,c);m!==null&&xe(m,a,c),ec(a,c)}});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function al(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=nc(e.nativeEvent);if(a===null){a=e.nativeEvent;var c=new a.constructor(a.type,a);lo=c,a.target.dispatchEvent(c),lo=null}else return n=Xn(a),n!==null&&nm(n),e.blockedOn=a,!1;n.shift()}return!0}function lm(e,n,a){al(e)&&a.delete(n)}function pE(){rc=!1,un!==null&&al(un)&&(un=null),cn!==null&&al(cn)&&(cn=null),fn!==null&&al(fn)&&(fn=null),Mr.forEach(lm),kr.forEach(lm)}function ll(e,n){e.blockedOn===n&&(e.blockedOn=null,rc||(rc=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,pE)))}var ol=null;function om(e){ol!==e&&(ol=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){ol===e&&(ol=null);for(var n=0;n<e.length;n+=3){var a=e[n],c=e[n+1],m=e[n+2];if(typeof c!="function"){if(sc(c||a)===null)continue;break}var p=Xn(a);p!==null&&(e.splice(n,3),n-=3,jo(p,{pending:!0,data:m,method:a.method,action:c},c,m))}}))}function Ur(e){function n(C){return ll(C,e)}un!==null&&ll(un,e),cn!==null&&ll(cn,e),fn!==null&&ll(fn,e),Mr.forEach(n),kr.forEach(n);for(var a=0;a<hn.length;a++){var c=hn[a];c.blockedOn===e&&(c.blockedOn=null)}for(;0<hn.length&&(a=hn[0],a.blockedOn===null);)am(a),a.blockedOn===null&&hn.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var m=a[c],p=a[c+1],S=m[Ae]||null;if(typeof p=="function")S||om(a);else if(S){var L=null;if(p&&p.hasAttribute("formAction")){if(m=p,S=p[Ae]||null)L=S.formAction;else if(sc(m)!==null)continue}else L=S.action;typeof L=="function"?a[c+1]=L:(a.splice(c,3),c-=3),om(a)}}}function ac(e){this._internalRoot=e}ul.prototype.render=ac.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,c=ke();em(a,c,e,n,null,null)},ul.prototype.unmount=ac.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;e.tag===0&&As(),em(e.current,2,null,e,null,null),Ka(),n[jn]=null}};function ul(e){this._internalRoot=e}ul.prototype.unstable_scheduleHydration=function(e){if(e){var n=Uf();e={blockedOn:null,target:e,priority:n};for(var a=0;a<hn.length&&n!==0&&n<hn[a].priority;a++);hn.splice(a,0,e),a===0&&am(e)}};var um=t.version;if(um!=="19.0.0")throw Error(s(527,um,"19.0.0"));nt.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=K(n),e=e!==null?it(e):null,e=e===null?null:e.stateNode,e};var yE={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:z,findFiberByHostInstance:En,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{$s=cl.inject(yE),Ce=cl}catch{}}return Br.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,c="",m=Ld,p=Dd,S=Cd,L=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(m=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(L=n.unstable_transitionCallbacks)),n=J0(e,1,!1,null,null,a,c,m,p,S,L,null),e[jn]=n.current,zu(e.nodeType===8?e.parentNode:e),new ac(n)},Br.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var c=!1,m="",p=Ld,S=Dd,L=Cd,C=null,M=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(L=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(C=a.unstable_transitionCallbacks),a.formState!==void 0&&(M=a.formState)),n=J0(e,1,!0,n,a??null,c,m,p,S,L,C,M),n.context=tm(null),a=n.current,c=ke(),m=tn(c),m.callback=null,en(a,m,c),n.current.lanes=c,zs(n,c),ui(n),e[jn]=n.current,zu(e),new ul(n)},Br.version="19.0.0",Br}var Em;function DE(){if(Em)return uc.exports;Em=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),uc.exports=LE(),uc.exports}var CE=DE(),Pr={},Tm;function _E(){if(Tm)return Pr;Tm=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.parse=u,Pr.serialize=d;const l=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,o=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function u(v,T){const E=new o,x=v.length;if(x<2)return E;const A=(T==null?void 0:T.decode)||g;let R=0;do{const O=v.indexOf("=",R);if(O===-1)break;const _=v.indexOf(";",R),F=_===-1?x:_;if(O>F){R=v.lastIndexOf(";",O-1)+1;continue}const I=f(v,R,O),V=h(v,O,I),G=v.slice(I,V);if(E[G]===void 0){let Q=f(v,O+1,F),z=h(v,F,Q);const P=A(v.slice(Q,z));E[G]=P}R=F+1}while(R<x);return E}function f(v,T,E){do{const x=v.charCodeAt(T);if(x!==32&&x!==9)return T}while(++T<E);return E}function h(v,T,E){for(;T>E;){const x=v.charCodeAt(--T);if(x!==32&&x!==9)return T+1}return E}function d(v,T,E){const x=(E==null?void 0:E.encode)||encodeURIComponent;if(!l.test(v))throw new TypeError(`argument name is invalid: ${v}`);const A=x(T);if(!t.test(A))throw new TypeError(`argument val is invalid: ${T}`);let R=v+"="+A;if(!E)return R;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);R+="; Max-Age="+E.maxAge}if(E.domain){if(!i.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);R+="; Domain="+E.domain}if(E.path){if(!s.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);R+="; Path="+E.path}if(E.expires){if(!y(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);R+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(R+="; HttpOnly"),E.secure&&(R+="; Secure"),E.partitioned&&(R+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":R+="; Priority=Low";break;case"medium":R+="; Priority=Medium";break;case"high":R+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":R+="; SameSite=Strict";break;case"lax":R+="; SameSite=Lax";break;case"none":R+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return R}function g(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function y(v){return r.call(v)==="[object Date]"}return Pr}_E();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Sm="popstate";function OE(l={}){function t(s,r){let{pathname:o,search:u,hash:f}=s.location;return Bc("",{pathname:o,search:u,hash:f},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function i(s,r){return typeof r=="string"?r:zr(r)}return wE(t,i,null,l)}function jt(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}function yi(l,t){if(!l){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function IE(){return Math.random().toString(36).substring(2,10)}function xm(l,t){return{usr:l.state,key:l.key,idx:t}}function Bc(l,t,i=null,s){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof t=="string"?Bs(t):t,state:i,key:t&&t.key||s||IE()}}function zr({pathname:l="/",search:t="",hash:i=""}){return t&&t!=="?"&&(l+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(l+=i.charAt(0)==="#"?i:"#"+i),l}function Bs(l){let t={};if(l){let i=l.indexOf("#");i>=0&&(t.hash=l.substring(i),l=l.substring(0,i));let s=l.indexOf("?");s>=0&&(t.search=l.substring(s),l=l.substring(0,s)),l&&(t.pathname=l)}return t}function wE(l,t,i,s={}){let{window:r=document.defaultView,v5Compat:o=!1}=s,u=r.history,f="POP",h=null,d=g();d==null&&(d=0,u.replaceState({...u.state,idx:d},""));function g(){return(u.state||{idx:null}).idx}function y(){f="POP";let A=g(),R=A==null?null:A-d;d=A,h&&h({action:f,location:x.location,delta:R})}function v(A,R){f="PUSH";let O=Bc(x.location,A,R);d=g()+1;let _=xm(O,d),F=x.createHref(O);try{u.pushState(_,"",F)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;r.location.assign(F)}o&&h&&h({action:f,location:x.location,delta:1})}function T(A,R){f="REPLACE";let O=Bc(x.location,A,R);d=g();let _=xm(O,d),F=x.createHref(O);u.replaceState(_,"",F),o&&h&&h({action:f,location:x.location,delta:0})}function E(A){let R=r.location.origin!=="null"?r.location.origin:r.location.href,O=typeof A=="string"?A:zr(A);return O=O.replace(/ $/,"%20"),jt(R,`No window.location.(origin|href) available to create URL for href: ${O}`),new URL(O,R)}let x={get action(){return f},get location(){return l(r,u)},listen(A){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(Sm,y),h=A,()=>{r.removeEventListener(Sm,y),h=null}},createHref(A){return t(r,A)},createURL:E,encodeLocation(A){let R=E(A);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:v,replace:T,go(A){return u.go(A)}};return x}function Lg(l,t,i="/"){return ME(l,t,i,!1)}function ME(l,t,i,s){let r=typeof t=="string"?Bs(t):t,o=pn(r.pathname||"/",i);if(o==null)return null;let u=Dg(l);kE(u);let f=null;for(let h=0;f==null&&h<u.length;++h){let d=KE(o);f=zE(u[h],d,s)}return f}function Dg(l,t=[],i=[],s=""){let r=(o,u,f)=>{let h={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};h.relativePath.startsWith("/")&&(jt(h.relativePath.startsWith(s),`Absolute route path "${h.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(s.length));let d=$i([s,h.relativePath]),g=i.concat(h);o.children&&o.children.length>0&&(jt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Dg(o.children,t,g,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:$E(d,o.index),routesMeta:g})};return l.forEach((o,u)=>{var f;if(o.path===""||!((f=o.path)!=null&&f.includes("?")))r(o,u);else for(let h of Cg(o.path))r(o,u,h)}),t}function Cg(l){let t=l.split("/");if(t.length===0)return[];let[i,...s]=t,r=i.endsWith("?"),o=i.replace(/\?$/,"");if(s.length===0)return r?[o,""]:[o];let u=Cg(s.join("/")),f=[];return f.push(...u.map(h=>h===""?o:[o,h].join("/"))),r&&f.push(...u),f.map(h=>l.startsWith("/")&&h===""?"/":h)}function kE(l){l.sort((t,i)=>t.score!==i.score?i.score-t.score:HE(t.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var NE=/^:[\w-]+$/,UE=3,FE=2,BE=1,PE=10,GE=-2,Am=l=>l==="*";function $E(l,t){let i=l.split("/"),s=i.length;return i.some(Am)&&(s+=GE),t&&(s+=FE),i.filter(r=>!Am(r)).reduce((r,o)=>r+(NE.test(o)?UE:o===""?BE:PE),s)}function HE(l,t){return l.length===t.length&&l.slice(0,-1).every((s,r)=>s===t[r])?l[l.length-1]-t[t.length-1]:0}function zE(l,t,i=!1){let{routesMeta:s}=l,r={},o="/",u=[];for(let f=0;f<s.length;++f){let h=s[f],d=f===s.length-1,g=o==="/"?t:t.slice(o.length)||"/",y=Nl({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),v=h.route;if(!y&&d&&i&&!s[s.length-1].route.index&&(y=Nl({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!y)return null;Object.assign(r,y.params),u.push({params:r,pathname:$i([o,y.pathname]),pathnameBase:XE($i([o,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(o=$i([o,y.pathnameBase]))}return u}function Nl(l,t){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[i,s]=VE(l.path,l.caseSensitive,l.end),r=t.match(i);if(!r)return null;let o=r[0],u=o.replace(/(.)\/+$/,"$1"),f=r.slice(1);return{params:s.reduce((d,{paramName:g,isOptional:y},v)=>{if(g==="*"){let E=f[v]||"";u=o.slice(0,o.length-E.length).replace(/(.)\/+$/,"$1")}const T=f[v];return y&&!T?d[g]=void 0:d[g]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:u,pattern:l}}function VE(l,t=!1,i=!0){yi(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let s=[],r="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,h)=>(s.push({paramName:f,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return l.endsWith("*")?(s.push({paramName:"*"}),r+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":l!==""&&l!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function KE(l){try{return l.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yi(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),l}}function pn(l,t){if(t==="/")return l;if(!l.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,s=l.charAt(i);return s&&s!=="/"?null:l.slice(i)||"/"}function YE(l,t="/"){let{pathname:i,search:s="",hash:r=""}=typeof l=="string"?Bs(l):l;return{pathname:i?i.startsWith("/")?i:qE(i,t):t,search:WE(s),hash:QE(r)}}function qE(l,t){let i=t.replace(/\/+$/,"").split("/");return l.split("/").forEach(r=>{r===".."?i.length>1&&i.pop():r!=="."&&i.push(r)}),i.length>1?i.join("/"):"/"}function dc(l,t,i,s){return`Cannot include a '${l}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function jE(l){return l.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function _g(l){let t=jE(l);return t.map((i,s)=>s===t.length-1?i.pathname:i.pathnameBase)}function Og(l,t,i,s=!1){let r;typeof l=="string"?r=Bs(l):(r={...l},jt(!r.pathname||!r.pathname.includes("?"),dc("?","pathname","search",r)),jt(!r.pathname||!r.pathname.includes("#"),dc("#","pathname","hash",r)),jt(!r.search||!r.search.includes("#"),dc("#","search","hash",r)));let o=l===""||r.pathname==="",u=o?"/":r.pathname,f;if(u==null)f=i;else{let y=t.length-1;if(!s&&u.startsWith("..")){let v=u.split("/");for(;v[0]==="..";)v.shift(),y-=1;r.pathname=v.join("/")}f=y>=0?t[y]:"/"}let h=YE(r,f),d=u&&u!=="/"&&u.endsWith("/"),g=(o||u===".")&&i.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}var $i=l=>l.join("/").replace(/\/\/+/g,"/"),XE=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),WE=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,QE=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function ZE(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}var Ig=["POST","PUT","PATCH","DELETE"];new Set(Ig);var JE=["GET",...Ig];new Set(JE);var Ps=X.createContext(null);Ps.displayName="DataRouter";var ql=X.createContext(null);ql.displayName="DataRouterState";var wg=X.createContext({isTransitioning:!1});wg.displayName="ViewTransition";var tT=X.createContext(new Map);tT.displayName="Fetchers";var eT=X.createContext(null);eT.displayName="Await";var Ei=X.createContext(null);Ei.displayName="Navigation";var jr=X.createContext(null);jr.displayName="Location";var Hi=X.createContext({outlet:null,matches:[],isDataRoute:!1});Hi.displayName="Route";var sf=X.createContext(null);sf.displayName="RouteError";function iT(l,{relative:t}={}){jt(Xr(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=X.useContext(Ei),{hash:r,pathname:o,search:u}=Wr(l,{relative:t}),f=o;return i!=="/"&&(f=o==="/"?i:$i([i,o])),s.createHref({pathname:f,search:u,hash:r})}function Xr(){return X.useContext(jr)!=null}function yn(){return jt(Xr(),"useLocation() may be used only in the context of a <Router> component."),X.useContext(jr).location}var Mg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kg(l){X.useContext(Ei).static||X.useLayoutEffect(l)}function nT(){let{isDataRoute:l}=X.useContext(Hi);return l?pT():sT()}function sT(){jt(Xr(),"useNavigate() may be used only in the context of a <Router> component.");let l=X.useContext(Ps),{basename:t,navigator:i}=X.useContext(Ei),{matches:s}=X.useContext(Hi),{pathname:r}=yn(),o=JSON.stringify(_g(s)),u=X.useRef(!1);return kg(()=>{u.current=!0}),X.useCallback((h,d={})=>{if(yi(u.current,Mg),!u.current)return;if(typeof h=="number"){i.go(h);return}let g=Og(h,JSON.parse(o),r,d.relative==="path");l==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:$i([t,g.pathname])),(d.replace?i.replace:i.push)(g,d.state,d)},[t,i,o,r,l])}X.createContext(null);function Wr(l,{relative:t}={}){let{matches:i}=X.useContext(Hi),{pathname:s}=yn(),r=JSON.stringify(_g(i));return X.useMemo(()=>Og(l,JSON.parse(r),s,t==="path"),[l,r,s,t])}function rT(l,t){return Ng(l,t)}function Ng(l,t,i,s){var O;jt(Xr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:o}=X.useContext(Ei),{matches:u}=X.useContext(Hi),f=u[u.length-1],h=f?f.params:{},d=f?f.pathname:"/",g=f?f.pathnameBase:"/",y=f&&f.route;{let _=y&&y.path||"";Ug(d,!y||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let v=yn(),T;if(t){let _=typeof t=="string"?Bs(t):t;jt(g==="/"||((O=_.pathname)==null?void 0:O.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${_.pathname}" was given in the \`location\` prop.`),T=_}else T=v;let E=T.pathname||"/",x=E;if(g!=="/"){let _=g.replace(/^\//,"").split("/");x="/"+E.replace(/^\//,"").split("/").slice(_.length).join("/")}let A=!o&&i&&i.matches&&i.matches.length>0?i.matches:Lg(l,{pathname:x});yi(y||A!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),yi(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=cT(A&&A.map(_=>Object.assign({},_,{params:Object.assign({},h,_.params),pathname:$i([g,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?g:$i([g,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),u,i,s);return t&&R?X.createElement(jr.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},R):R}function aT(){let l=gT(),t=ZE(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),i=l instanceof Error?l.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",l),u=X.createElement(X.Fragment,null,X.createElement("p",null,"💿 Hey developer 👋"),X.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",X.createElement("code",{style:o},"ErrorBoundary")," or"," ",X.createElement("code",{style:o},"errorElement")," prop on your route.")),X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),i?X.createElement("pre",{style:r},i):null,u)}var lT=X.createElement(aT,null),oT=class extends X.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,t){return t.location!==l.location||t.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:t.error,location:t.location,revalidation:l.revalidation||t.revalidation}}componentDidCatch(l,t){console.error("React Router caught the following error during render",l,t)}render(){return this.state.error!==void 0?X.createElement(Hi.Provider,{value:this.props.routeContext},X.createElement(sf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function uT({routeContext:l,match:t,children:i}){let s=X.useContext(Ps);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),X.createElement(Hi.Provider,{value:l},i)}function cT(l,t=[],i=null,s=null){if(l==null){if(!i)return null;if(i.errors)l=i.matches;else if(t.length===0&&!i.initialized&&i.matches.length>0)l=i.matches;else return null}let r=l,o=i==null?void 0:i.errors;if(o!=null){let h=r.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);jt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,h+1))}let u=!1,f=-1;if(i)for(let h=0;h<r.length;h++){let d=r[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(f=h),d.route.id){let{loaderData:g,errors:y}=i,v=d.route.loader&&!g.hasOwnProperty(d.route.id)&&(!y||y[d.route.id]===void 0);if(d.route.lazy||v){u=!0,f>=0?r=r.slice(0,f+1):r=[r[0]];break}}}return r.reduceRight((h,d,g)=>{let y,v=!1,T=null,E=null;i&&(y=o&&d.route.id?o[d.route.id]:void 0,T=d.route.errorElement||lT,u&&(f<0&&g===0?(Ug("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,E=null):f===g&&(v=!0,E=d.route.hydrateFallbackElement||null)));let x=t.concat(r.slice(0,g+1)),A=()=>{let R;return y?R=T:v?R=E:d.route.Component?R=X.createElement(d.route.Component,null):d.route.element?R=d.route.element:R=h,X.createElement(uT,{match:d,routeContext:{outlet:h,matches:x,isDataRoute:i!=null},children:R})};return i&&(d.route.ErrorBoundary||d.route.errorElement||g===0)?X.createElement(oT,{location:i.location,revalidation:i.revalidation,component:T,error:y,children:A(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):A()},null)}function rf(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fT(l){let t=X.useContext(Ps);return jt(t,rf(l)),t}function hT(l){let t=X.useContext(ql);return jt(t,rf(l)),t}function dT(l){let t=X.useContext(Hi);return jt(t,rf(l)),t}function af(l){let t=dT(l),i=t.matches[t.matches.length-1];return jt(i.route.id,`${l} can only be used on routes that contain a unique "id"`),i.route.id}function mT(){return af("useRouteId")}function gT(){var s;let l=X.useContext(sf),t=hT("useRouteError"),i=af("useRouteError");return l!==void 0?l:(s=t.errors)==null?void 0:s[i]}function pT(){let{router:l}=fT("useNavigate"),t=af("useNavigate"),i=X.useRef(!1);return kg(()=>{i.current=!0}),X.useCallback(async(r,o={})=>{yi(i.current,Mg),i.current&&(typeof r=="number"?l.navigate(r):await l.navigate(r,{fromRouteId:t,...o}))},[l,t])}var bm={};function Ug(l,t,i){!t&&!bm[l]&&(bm[l]=!0,yi(!1,i))}X.memo(yT);function yT({routes:l,future:t,state:i}){return Ng(l,void 0,i,t)}function Pc(l){jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vT({basename:l="/",children:t=null,location:i,navigationType:s="POP",navigator:r,static:o=!1}){jt(!Xr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=l.replace(/^\/*/,"/"),f=X.useMemo(()=>({basename:u,navigator:r,static:o,future:{}}),[u,r,o]);typeof i=="string"&&(i=Bs(i));let{pathname:h="/",search:d="",hash:g="",state:y=null,key:v="default"}=i,T=X.useMemo(()=>{let E=pn(h,u);return E==null?null:{location:{pathname:E,search:d,hash:g,state:y,key:v},navigationType:s}},[u,h,d,g,y,v,s]);return yi(T!=null,`<Router basename="${u}"> is not able to match the URL "${h}${d}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:X.createElement(Ei.Provider,{value:f},X.createElement(jr.Provider,{children:t,value:T}))}function ET({children:l,location:t}){return rT(Gc(l),t)}function Gc(l,t=[]){let i=[];return X.Children.forEach(l,(s,r)=>{if(!X.isValidElement(s))return;let o=[...t,r];if(s.type===X.Fragment){i.push.apply(i,Gc(s.props.children,o));return}jt(s.type===Pc,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),jt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Gc(s.props.children,o)),i.push(u)}),i}var Rl="get",Ll="application/x-www-form-urlencoded";function jl(l){return l!=null&&typeof l.tagName=="string"}function TT(l){return jl(l)&&l.tagName.toLowerCase()==="button"}function ST(l){return jl(l)&&l.tagName.toLowerCase()==="form"}function xT(l){return jl(l)&&l.tagName.toLowerCase()==="input"}function AT(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function bT(l,t){return l.button===0&&(!t||t==="_self")&&!AT(l)}var fl=null;function RT(){if(fl===null)try{new FormData(document.createElement("form"),0),fl=!1}catch{fl=!0}return fl}var LT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mc(l){return l!=null&&!LT.has(l)?(yi(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ll}"`),null):l}function DT(l,t){let i,s,r,o,u;if(ST(l)){let f=l.getAttribute("action");s=f?pn(f,t):null,i=l.getAttribute("method")||Rl,r=mc(l.getAttribute("enctype"))||Ll,o=new FormData(l)}else if(TT(l)||xT(l)&&(l.type==="submit"||l.type==="image")){let f=l.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=l.getAttribute("formaction")||f.getAttribute("action");if(s=h?pn(h,t):null,i=l.getAttribute("formmethod")||f.getAttribute("method")||Rl,r=mc(l.getAttribute("formenctype"))||mc(f.getAttribute("enctype"))||Ll,o=new FormData(f,l),!RT()){let{name:d,type:g,value:y}=l;if(g==="image"){let v=d?`${d}.`:"";o.append(`${v}x`,"0"),o.append(`${v}y`,"0")}else d&&o.append(d,y)}}else{if(jl(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=Rl,s=null,r=Ll,u=l}return o&&r==="text/plain"&&(u=o,o=void 0),{action:s,method:i.toLowerCase(),encType:r,formData:o,body:u}}function lf(l,t){if(l===!1||l===null||typeof l>"u")throw new Error(t)}async function CT(l,t){if(l.id in t)return t[l.id];try{let i=await import(l.module);return t[l.id]=i,i}catch(i){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _T(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function OT(l,t,i){let s=await Promise.all(l.map(async r=>{let o=t.routes[r.route.id];if(o){let u=await CT(o,i);return u.links?u.links():[]}return[]}));return kT(s.flat(1).filter(_T).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Rm(l,t,i,s,r,o){let u=(h,d)=>i[d]?h.route.id!==i[d].route.id:!0,f=(h,d)=>{var g;return i[d].pathname!==h.pathname||((g=i[d].route.path)==null?void 0:g.endsWith("*"))&&i[d].params["*"]!==h.params["*"]};return o==="assets"?t.filter((h,d)=>u(h,d)||f(h,d)):o==="data"?t.filter((h,d)=>{var y;let g=s.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(u(h,d)||f(h,d))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((y=i[0])==null?void 0:y.params)||{},nextUrl:new URL(l,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function IT(l,t){return wT(l.map(i=>{let s=t.routes[i.route.id];if(!s)return[];let r=[s.module];return s.imports&&(r=r.concat(s.imports)),r}).flat(1))}function wT(l){return[...new Set(l)]}function MT(l){let t={},i=Object.keys(l).sort();for(let s of i)t[s]=l[s];return t}function kT(l,t){let i=new Set;return new Set(t),l.reduce((s,r)=>{let o=JSON.stringify(MT(r));return i.has(o)||(i.add(o),s.push({key:o,link:r})),s},[])}function NT(l){let t=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function UT(){let l=X.useContext(Ps);return lf(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function FT(){let l=X.useContext(ql);return lf(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var of=X.createContext(void 0);of.displayName="FrameworkContext";function Fg(){let l=X.useContext(of);return lf(l,"You must render this element inside a <HydratedRouter> element"),l}function BT(l,t){let i=X.useContext(of),[s,r]=X.useState(!1),[o,u]=X.useState(!1),{onFocus:f,onBlur:h,onMouseEnter:d,onMouseLeave:g,onTouchStart:y}=t,v=X.useRef(null);X.useEffect(()=>{if(l==="render"&&u(!0),l==="viewport"){let x=R=>{R.forEach(O=>{u(O.isIntersecting)})},A=new IntersectionObserver(x,{threshold:.5});return v.current&&A.observe(v.current),()=>{A.disconnect()}}},[l]),X.useEffect(()=>{if(s){let x=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(x)}}},[s]);let T=()=>{r(!0)},E=()=>{r(!1),u(!1)};return i?l!=="intent"?[o,v,{}]:[o,v,{onFocus:Gr(f,T),onBlur:Gr(h,E),onMouseEnter:Gr(d,T),onMouseLeave:Gr(g,E),onTouchStart:Gr(y,T)}]:[!1,v,{}]}function Gr(l,t){return i=>{l&&l(i),i.defaultPrevented||t(i)}}function PT({page:l,...t}){let{router:i}=UT(),s=X.useMemo(()=>Lg(i.routes,l,i.basename),[i.routes,l,i.basename]);return s?X.createElement($T,{page:l,matches:s,...t}):null}function GT(l){let{manifest:t,routeModules:i}=Fg(),[s,r]=X.useState([]);return X.useEffect(()=>{let o=!1;return OT(l,t,i).then(u=>{o||r(u)}),()=>{o=!0}},[l,t,i]),s}function $T({page:l,matches:t,...i}){let s=yn(),{manifest:r,routeModules:o}=Fg(),{loaderData:u,matches:f}=FT(),h=X.useMemo(()=>Rm(l,t,f,r,s,"data"),[l,t,f,r,s]),d=X.useMemo(()=>Rm(l,t,f,r,s,"assets"),[l,t,f,r,s]),g=X.useMemo(()=>{if(l===s.pathname+s.search+s.hash)return[];let T=new Set,E=!1;if(t.forEach(A=>{var O;let R=r.routes[A.route.id];!R||!R.hasLoader||(!h.some(_=>_.route.id===A.route.id)&&A.route.id in u&&((O=o[A.route.id])!=null&&O.shouldRevalidate)||R.hasClientLoader?E=!0:T.add(A.route.id))}),T.size===0)return[];let x=NT(l);return E&&T.size>0&&x.searchParams.set("_routes",t.filter(A=>T.has(A.route.id)).map(A=>A.route.id).join(",")),[x.pathname+x.search]},[u,s,r,h,t,l,o]),y=X.useMemo(()=>IT(d,r),[d,r]),v=GT(d);return X.createElement(X.Fragment,null,g.map(T=>X.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...i})),y.map(T=>X.createElement("link",{key:T,rel:"modulepreload",href:T,...i})),v.map(({key:T,link:E})=>X.createElement("link",{key:T,...E})))}function HT(...l){return t=>{l.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var Bg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Bg&&(window.__reactRouterVersion="7.1.5")}catch{}function zT({basename:l,children:t,window:i}){let s=X.useRef();s.current==null&&(s.current=OE({window:i,v5Compat:!0}));let r=s.current,[o,u]=X.useState({action:r.action,location:r.location}),f=X.useCallback(h=>{X.startTransition(()=>u(h))},[u]);return X.useLayoutEffect(()=>r.listen(f),[r,f]),X.createElement(vT,{basename:l,children:t,location:o.location,navigationType:o.action,navigator:r})}var Pg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uf=X.forwardRef(function({onClick:t,discover:i="render",prefetch:s="none",relative:r,reloadDocument:o,replace:u,state:f,target:h,to:d,preventScrollReset:g,viewTransition:y,...v},T){let{basename:E}=X.useContext(Ei),x=typeof d=="string"&&Pg.test(d),A,R=!1;if(typeof d=="string"&&x&&(A=d,Bg))try{let z=new URL(window.location.href),P=d.startsWith("//")?new URL(z.protocol+d):new URL(d),J=pn(P.pathname,E);P.origin===z.origin&&J!=null?d=J+P.search+P.hash:R=!0}catch{yi(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=iT(d,{relative:r}),[_,F,I]=BT(s,v),V=qT(d,{replace:u,state:f,target:h,preventScrollReset:g,relative:r,viewTransition:y});function G(z){t&&t(z),z.defaultPrevented||V(z)}let Q=X.createElement("a",{...v,...I,href:A||O,onClick:R||o?t:G,ref:HT(T,F),target:h,"data-discover":!x&&i==="render"?"true":void 0});return _&&!x?X.createElement(X.Fragment,null,Q,X.createElement(PT,{page:O})):Q});uf.displayName="Link";var VT=X.forwardRef(function({"aria-current":t="page",caseSensitive:i=!1,className:s="",end:r=!1,style:o,to:u,viewTransition:f,children:h,...d},g){let y=Wr(u,{relative:d.relative}),v=yn(),T=X.useContext(ql),{navigator:E,basename:x}=X.useContext(Ei),A=T!=null&&ZT(y)&&f===!0,R=E.encodeLocation?E.encodeLocation(y).pathname:y.pathname,O=v.pathname,_=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;i||(O=O.toLowerCase(),_=_?_.toLowerCase():null,R=R.toLowerCase()),_&&x&&(_=pn(_,x)||_);const F=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let I=O===R||!r&&O.startsWith(R)&&O.charAt(F)==="/",V=_!=null&&(_===R||!r&&_.startsWith(R)&&_.charAt(R.length)==="/"),G={isActive:I,isPending:V,isTransitioning:A},Q=I?t:void 0,z;typeof s=="function"?z=s(G):z=[s,I?"active":null,V?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(G):o;return X.createElement(uf,{...d,"aria-current":Q,className:z,ref:g,style:P,to:u,viewTransition:f},typeof h=="function"?h(G):h)});VT.displayName="NavLink";var KT=X.forwardRef(({discover:l="render",fetcherKey:t,navigate:i,reloadDocument:s,replace:r,state:o,method:u=Rl,action:f,onSubmit:h,relative:d,preventScrollReset:g,viewTransition:y,...v},T)=>{let E=WT(),x=QT(f,{relative:d}),A=u.toLowerCase()==="get"?"get":"post",R=typeof f=="string"&&Pg.test(f),O=_=>{if(h&&h(_),_.defaultPrevented)return;_.preventDefault();let F=_.nativeEvent.submitter,I=(F==null?void 0:F.getAttribute("formmethod"))||u;E(F||_.currentTarget,{fetcherKey:t,method:I,navigate:i,replace:r,state:o,relative:d,preventScrollReset:g,viewTransition:y})};return X.createElement("form",{ref:T,method:A,action:x,onSubmit:s?h:O,...v,"data-discover":!R&&l==="render"?"true":void 0})});KT.displayName="Form";function YT(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Gg(l){let t=X.useContext(Ps);return jt(t,YT(l)),t}function qT(l,{target:t,replace:i,state:s,preventScrollReset:r,relative:o,viewTransition:u}={}){let f=nT(),h=yn(),d=Wr(l,{relative:o});return X.useCallback(g=>{if(bT(g,t)){g.preventDefault();let y=i!==void 0?i:zr(h)===zr(d);f(l,{replace:y,state:s,preventScrollReset:r,relative:o,viewTransition:u})}},[h,f,d,i,s,t,l,r,o,u])}var jT=0,XT=()=>`__${String(++jT)}__`;function WT(){let{router:l}=Gg("useSubmit"),{basename:t}=X.useContext(Ei),i=mT();return X.useCallback(async(s,r={})=>{let{action:o,method:u,encType:f,formData:h,body:d}=DT(s,t);if(r.navigate===!1){let g=r.fetcherKey||XT();await l.fetch(g,i,r.action||o,{preventScrollReset:r.preventScrollReset,formData:h,body:d,formMethod:r.method||u,formEncType:r.encType||f,flushSync:r.flushSync})}else await l.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:h,body:d,formMethod:r.method||u,formEncType:r.encType||f,replace:r.replace,state:r.state,fromRouteId:i,flushSync:r.flushSync,viewTransition:r.viewTransition})},[l,t,i])}function QT(l,{relative:t}={}){let{basename:i}=X.useContext(Ei),s=X.useContext(Hi);jt(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),o={...Wr(l||".",{relative:t})},u=yn();if(l==null){o.search=u.search;let f=new URLSearchParams(o.search),h=f.getAll("index");if(h.some(g=>g==="")){f.delete("index"),h.filter(y=>y).forEach(y=>f.append("index",y));let g=f.toString();o.search=g?`?${g}`:""}}return(!l||l===".")&&r.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(o.pathname=o.pathname==="/"?i:$i([i,o.pathname])),zr(o)}function ZT(l,t={}){let i=X.useContext(wg);jt(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Gg("useViewTransitionState"),r=Wr(l,{relative:t.relative});if(!i.isTransitioning)return!1;let o=pn(i.currentLocation.pathname,s)||i.currentLocation.pathname,u=pn(i.nextLocation.pathname,s)||i.nextLocation.pathname;return Nl(r.pathname,u)!=null||Nl(r.pathname,o)!=null}new TextEncoder;function JT(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var $g={exports:{}};(function(l,t){(function(i){var s=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,f={buildAbsoluteURL:function(h,d,g){if(g=g||{},h=h.trim(),d=d.trim(),!d){if(!g.alwaysNormalize)return h;var y=f.parseURL(h);if(!y)throw new Error("Error trying to parse base URL.");return y.path=f.normalizePath(y.path),f.buildURLFromParts(y)}var v=f.parseURL(d);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return g.alwaysNormalize?(v.path=f.normalizePath(v.path),f.buildURLFromParts(v)):d;var T=f.parseURL(h);if(!T)throw new Error("Error trying to parse base URL.");if(!T.netLoc&&T.path&&T.path[0]!=="/"){var E=r.exec(T.path);T.netLoc=E[1],T.path=E[2]}T.netLoc&&!T.path&&(T.path="/");var x={scheme:T.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(x.netLoc=T.netLoc,v.path[0]!=="/"))if(!v.path)x.path=T.path,v.params||(x.params=T.params,v.query||(x.query=T.query));else{var A=T.path,R=A.substring(0,A.lastIndexOf("/")+1)+v.path;x.path=f.normalizePath(R)}return x.path===null&&(x.path=g.alwaysNormalize?f.normalizePath(v.path):v.path),f.buildURLFromParts(x)},parseURL:function(h){var d=s.exec(h);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(o,"");h.length!==(h=h.replace(u,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};l.exports=f})()})($g);var cf=$g.exports;function Lm(l,t){var i=Object.keys(l);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(l);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(l,r).enumerable})),i.push.apply(i,s)}return i}function he(l){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Lm(Object(i),!0).forEach(function(s){iS(l,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(i)):Lm(Object(i)).forEach(function(s){Object.defineProperty(l,s,Object.getOwnPropertyDescriptor(i,s))})}return l}function tS(l,t){if(typeof l!="object"||!l)return l;var i=l[Symbol.toPrimitive];if(i!==void 0){var s=i.call(l,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(l)}function eS(l){var t=tS(l,"string");return typeof t=="symbol"?t:String(t)}function iS(l,t,i){return t=eS(t),t in l?Object.defineProperty(l,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):l[t]=i,l}function ie(){return ie=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(l[s]=i[s])}return l},ie.apply(this,arguments)}const ot=Number.isFinite||function(l){return typeof l=="number"&&isFinite(l)},nS=Number.isSafeInteger||function(l){return typeof l=="number"&&Math.abs(l)<=sS},sS=Number.MAX_SAFE_INTEGER||9007199254740991;let b=function(l){return l.MEDIA_ATTACHING="hlsMediaAttaching",l.MEDIA_ATTACHED="hlsMediaAttached",l.MEDIA_DETACHING="hlsMediaDetaching",l.MEDIA_DETACHED="hlsMediaDetached",l.BUFFER_RESET="hlsBufferReset",l.BUFFER_CODECS="hlsBufferCodecs",l.BUFFER_CREATED="hlsBufferCreated",l.BUFFER_APPENDING="hlsBufferAppending",l.BUFFER_APPENDED="hlsBufferAppended",l.BUFFER_EOS="hlsBufferEos",l.BUFFER_FLUSHING="hlsBufferFlushing",l.BUFFER_FLUSHED="hlsBufferFlushed",l.MANIFEST_LOADING="hlsManifestLoading",l.MANIFEST_LOADED="hlsManifestLoaded",l.MANIFEST_PARSED="hlsManifestParsed",l.LEVEL_SWITCHING="hlsLevelSwitching",l.LEVEL_SWITCHED="hlsLevelSwitched",l.LEVEL_LOADING="hlsLevelLoading",l.LEVEL_LOADED="hlsLevelLoaded",l.LEVEL_UPDATED="hlsLevelUpdated",l.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",l.LEVELS_UPDATED="hlsLevelsUpdated",l.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",l.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",l.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",l.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",l.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",l.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",l.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",l.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",l.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",l.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",l.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",l.CUES_PARSED="hlsCuesParsed",l.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",l.INIT_PTS_FOUND="hlsInitPtsFound",l.FRAG_LOADING="hlsFragLoading",l.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",l.FRAG_LOADED="hlsFragLoaded",l.FRAG_DECRYPTED="hlsFragDecrypted",l.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",l.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",l.FRAG_PARSING_METADATA="hlsFragParsingMetadata",l.FRAG_PARSED="hlsFragParsed",l.FRAG_BUFFERED="hlsFragBuffered",l.FRAG_CHANGED="hlsFragChanged",l.FPS_DROP="hlsFpsDrop",l.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",l.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",l.ERROR="hlsError",l.DESTROYING="hlsDestroying",l.KEY_LOADING="hlsKeyLoading",l.KEY_LOADED="hlsKeyLoaded",l.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",l.BACK_BUFFER_REACHED="hlsBackBufferReached",l.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",l}({}),Tt=function(l){return l.NETWORK_ERROR="networkError",l.MEDIA_ERROR="mediaError",l.KEY_SYSTEM_ERROR="keySystemError",l.MUX_ERROR="muxError",l.OTHER_ERROR="otherError",l}({}),H=function(l){return l.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",l.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",l.KEY_SYSTEM_NO_SESSION="keySystemNoSession",l.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",l.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",l.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",l.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",l.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",l.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",l.MANIFEST_LOAD_ERROR="manifestLoadError",l.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",l.MANIFEST_PARSING_ERROR="manifestParsingError",l.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",l.LEVEL_EMPTY_ERROR="levelEmptyError",l.LEVEL_LOAD_ERROR="levelLoadError",l.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",l.LEVEL_PARSING_ERROR="levelParsingError",l.LEVEL_SWITCH_ERROR="levelSwitchError",l.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",l.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",l.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",l.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",l.FRAG_LOAD_ERROR="fragLoadError",l.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",l.FRAG_DECRYPT_ERROR="fragDecryptError",l.FRAG_PARSING_ERROR="fragParsingError",l.FRAG_GAP="fragGap",l.REMUX_ALLOC_ERROR="remuxAllocError",l.KEY_LOAD_ERROR="keyLoadError",l.KEY_LOAD_TIMEOUT="keyLoadTimeOut",l.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",l.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",l.BUFFER_APPEND_ERROR="bufferAppendError",l.BUFFER_APPENDING_ERROR="bufferAppendingError",l.BUFFER_STALLED_ERROR="bufferStalledError",l.BUFFER_FULL_ERROR="bufferFullError",l.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",l.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",l.INTERNAL_EXCEPTION="internalException",l.INTERNAL_ABORTED="aborted",l.UNKNOWN="unknown",l}({});const $n=function(){},$c={trace:$n,debug:$n,log:$n,warn:$n,info:$n,error:$n};let Hr=$c;function rS(l){const t=self.console[l];return t?t.bind(self.console,`[${l}] >`):$n}function aS(l,...t){t.forEach(function(i){Hr[i]=l[i]?l[i].bind(l):rS(i)})}function lS(l,t){if(typeof console=="object"&&l===!0||typeof l=="object"){aS(l,"debug","log","info","warn","error");try{Hr.log(`Debug logs enabled for "${t}" in hls.js version 1.5.20`)}catch{Hr=$c}}else Hr=$c}const N=Hr,oS=/^(\d+)x(\d+)$/,Dm=/(.+?)=(".*?"|.*?)(?:,|$)/g;class qt{constructor(t){typeof t=="string"&&(t=qt.parseAttrList(t)),ie(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const i=parseInt(this[t],10);return i>Number.MAX_SAFE_INTEGER?1/0:i}hexadecimalInteger(t){if(this[t]){let i=(this[t]||"0x").slice(2);i=(i.length&1?"0":"")+i;const s=new Uint8Array(i.length/2);for(let r=0;r<i.length/2;r++)s[r]=parseInt(i.slice(r*2,r*2+2),16);return s}else return null}hexadecimalIntegerAsNumber(t){const i=parseInt(this[t],16);return i>Number.MAX_SAFE_INTEGER?1/0:i}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,i){const s=this[t];return s?parseFloat(s):i}enumeratedString(t){return this[t]}bool(t){return this[t]==="YES"}decimalResolution(t){const i=oS.exec(this[t]);if(i!==null)return{width:parseInt(i[1],10),height:parseInt(i[2],10)}}static parseAttrList(t){let i;const s={},r='"';for(Dm.lastIndex=0;(i=Dm.exec(t))!==null;){let o=i[2];o.indexOf(r)===0&&o.lastIndexOf(r)===o.length-1&&(o=o.slice(1,-1));const u=i[1].trim();s[u]=o}return s}}function uS(l){return l!=="ID"&&l!=="CLASS"&&l!=="START-DATE"&&l!=="DURATION"&&l!=="END-DATE"&&l!=="END-ON-NEXT"}function cS(l){return l==="SCTE35-OUT"||l==="SCTE35-IN"}class Hg{constructor(t,i){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,i){const s=i.attr;for(const r in s)if(Object.prototype.hasOwnProperty.call(t,r)&&t[r]!==s[r]){N.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=r;break}t=ie(new qt({}),s,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const s=new Date(this.attr["END-DATE"]);ot(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const t=this.duration;return t!==null?new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(ot(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ot(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Xl{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Nt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class zg{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Nt.AUDIO]:null,[Nt.VIDEO]:null,[Nt.AUDIOVIDEO]:null},this.baseurl=t}setByteRange(t,i){const s=t.split("@",2);let r;s.length===1?r=(i==null?void 0:i.byteRangeEndOffset)||0:r=parseInt(s[1]),this._byteRange=[r,parseInt(s[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=cf.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class gc extends zg{constructor(t,i){super(i),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Xl,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const i=this.levelkeys.identity;if(i)this._decryptdata=i.getDecryptData(this.sn);else{const s=Object.keys(this.levelkeys);if(s.length===1)return this._decryptdata=this.levelkeys[s[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ot(this.programDateTime))return null;const t=ot(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){const i=Object.keys(this.levelkeys),s=i.length;if(s>1||s===1&&this.levelkeys[i[0]].encrypted)return!0}return!1}setKeyFormat(t){if(this.levelkeys){const i=this.levelkeys[t];i&&!this._decryptdata&&(this._decryptdata=i.getDecryptData(this.sn))}}abortRequests(){var t,i;(t=this.loader)==null||t.abort(),(i=this.keyLoader)==null||i.abort()}setElementaryStreamInfo(t,i,s,r,o,u=!1){const{elementaryStreams:f}=this,h=f[t];if(!h){f[t]={startPTS:i,endPTS:s,startDTS:r,endDTS:o,partial:u};return}h.startPTS=Math.min(h.startPTS,i),h.endPTS=Math.max(h.endPTS,s),h.startDTS=Math.min(h.startDTS,r),h.endDTS=Math.max(h.endDTS,o)}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Nt.AUDIO]=null,t[Nt.VIDEO]=null,t[Nt.AUDIOVIDEO]=null}}class fS extends zg{constructor(t,i,s,r,o){super(s),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Xl,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=i,this.index=r;const u=t.enumeratedString("BYTERANGE");u&&this.setByteRange(u,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}const hS=10;class dS{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const i=this.lastPartSn-t.lastPartSn,s=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!s||!!i||!this.live,this.advanced=this.endSN>t.endSN||i>0||i===0&&s>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ot(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||hS}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function ff(l){return Uint8Array.from(atob(l),t=>t.charCodeAt(0))}function mS(l){const t=Hc(l).subarray(0,16),i=new Uint8Array(16);return i.set(t,16-t.length),i}function gS(l){const t=function(s,r,o){const u=s[r];s[r]=s[o],s[o]=u};t(l,0,3),t(l,1,2),t(l,4,5),t(l,6,7)}function pS(l){const t=l.split(":");let i=null;if(t[0]==="data"&&t.length===2){const s=t[1].split(";"),r=s[s.length-1].split(",");if(r.length===2){const o=r[0]==="base64",u=r[1];o?(s.splice(-1,1),i=ff(u)):i=mS(u)}}return i}function Hc(l){return Uint8Array.from(unescape(encodeURIComponent(l)),t=>t.charCodeAt(0))}const Ns=typeof self<"u"?self:void 0;var kt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},De={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function pc(l){switch(l){case De.FAIRPLAY:return kt.FAIRPLAY;case De.PLAYREADY:return kt.PLAYREADY;case De.WIDEVINE:return kt.WIDEVINE;case De.CLEARKEY:return kt.CLEARKEY}}var hl={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function yc(l){if(l===hl.WIDEVINE)return kt.WIDEVINE;if(l===hl.PLAYREADY)return kt.PLAYREADY;if(l===hl.CENC||l===hl.CLEARKEY)return kt.CLEARKEY}function vc(l){switch(l){case kt.FAIRPLAY:return De.FAIRPLAY;case kt.PLAYREADY:return De.PLAYREADY;case kt.WIDEVINE:return De.WIDEVINE;case kt.CLEARKEY:return De.CLEARKEY}}function dl(l){const{drmSystems:t,widevineLicenseUrl:i}=l,s=t?[kt.FAIRPLAY,kt.WIDEVINE,kt.PLAYREADY,kt.CLEARKEY].filter(r=>!!t[r]):[];return!s[kt.WIDEVINE]&&i&&s.push(kt.WIDEVINE),s}const Vg=function(l){return Ns!=null&&(l=Ns.navigator)!=null&&l.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function yS(l,t,i,s){let r;switch(l){case kt.FAIRPLAY:r=["cenc","sinf"];break;case kt.WIDEVINE:case kt.PLAYREADY:r=["cenc"];break;case kt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${l}`)}return vS(r,t,i,s)}function vS(l,t,i,s){return[{initDataTypes:l,persistentState:s.persistentState||"optional",distinctiveIdentifier:s.distinctiveIdentifier||"optional",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:t.map(o=>({contentType:`audio/mp4; codecs="${o}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null})),videoCapabilities:i.map(o=>({contentType:`video/mp4; codecs="${o}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null}))}]}function Kg(l){const t=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/2),i=String.fromCharCode.apply(null,Array.from(t)),s=i.substring(i.indexOf("<"),i.length),u=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(u){const f=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(f){const h=ff(f).subarray(0,16);return gS(h),h}}return null}function Vn(l,t,i){return Uint8Array.prototype.slice?l.slice(t,i):new Uint8Array(Array.prototype.slice.call(l,t,i))}const hf=(l,t)=>t+10<=l.length&&l[t]===73&&l[t+1]===68&&l[t+2]===51&&l[t+3]<255&&l[t+4]<255&&l[t+6]<128&&l[t+7]<128&&l[t+8]<128&&l[t+9]<128,Yg=(l,t)=>t+10<=l.length&&l[t]===51&&l[t+1]===68&&l[t+2]===73&&l[t+3]<255&&l[t+4]<255&&l[t+6]<128&&l[t+7]<128&&l[t+8]<128&&l[t+9]<128,Vr=(l,t)=>{const i=t;let s=0;for(;hf(l,t);){s+=10;const r=Wl(l,t+6);s+=r,Yg(l,t+10)&&(s+=10),t+=s}if(s>0)return l.subarray(i,i+s)},Wl=(l,t)=>{let i=0;return i=(l[t]&127)<<21,i|=(l[t+1]&127)<<14,i|=(l[t+2]&127)<<7,i|=l[t+3]&127,i},ES=(l,t)=>hf(l,t)&&Wl(l,t+6)+10<=l.length-t,df=l=>{const t=jg(l);for(let i=0;i<t.length;i++){const s=t[i];if(qg(s))return RS(s)}},qg=l=>l&&l.key==="PRIV"&&l.info==="com.apple.streaming.transportStreamTimestamp",TS=l=>{const t=String.fromCharCode(l[0],l[1],l[2],l[3]),i=Wl(l,4),s=10;return{type:t,size:i,data:l.subarray(s,s+i)}},jg=l=>{let t=0;const i=[];for(;hf(l,t);){const s=Wl(l,t+6);t+=10;const r=t+s;for(;t+8<r;){const o=TS(l.subarray(t)),u=SS(o);u&&i.push(u),t+=o.size+10}Yg(l,t)&&(t+=10)}return i},SS=l=>l.type==="PRIV"?xS(l):l.type[0]==="W"?bS(l):AS(l),xS=l=>{if(l.size<2)return;const t=pi(l.data,!0),i=new Uint8Array(l.data.subarray(t.length+1));return{key:l.type,info:t,data:i.buffer}},AS=l=>{if(l.size<2)return;if(l.type==="TXXX"){let i=1;const s=pi(l.data.subarray(i),!0);i+=s.length+1;const r=pi(l.data.subarray(i));return{key:l.type,info:s,data:r}}const t=pi(l.data.subarray(1));return{key:l.type,data:t}},bS=l=>{if(l.type==="WXXX"){if(l.size<2)return;let i=1;const s=pi(l.data.subarray(i),!0);i+=s.length+1;const r=pi(l.data.subarray(i));return{key:l.type,info:s,data:r}}const t=pi(l.data);return{key:l.type,data:t}},RS=l=>{if(l.data.byteLength===8){const t=new Uint8Array(l.data),i=t[3]&1;let s=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return s/=45,i&&(s+=4772185884e-2),Math.round(s)}},pi=(l,t=!1)=>{const i=LS();if(i){const d=i.decode(l);if(t){const g=d.indexOf("\0");return g!==-1?d.substring(0,g):d}return d.replace(/\0/g,"")}const s=l.length;let r,o,u,f="",h=0;for(;h<s;){if(r=l[h++],r===0&&t)return f;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:f+=String.fromCharCode(r);break;case 12:case 13:o=l[h++],f+=String.fromCharCode((r&31)<<6|o&63);break;case 14:o=l[h++],u=l[h++],f+=String.fromCharCode((r&15)<<12|(o&63)<<6|(u&63)<<0);break}}return f};let Ec;function LS(){if(!navigator.userAgent.includes("PlayStation 4"))return!Ec&&typeof self.TextDecoder<"u"&&(Ec=new self.TextDecoder("utf-8")),Ec}const fi={hexDump:function(l){let t="";for(let i=0;i<l.length;i++){let s=l[i].toString(16);s.length<2&&(s="0"+s),t+=s}return t}},Ul=Math.pow(2,32)-1,DS=[].push,Xg={video:1,audio:2,id3:3,text:4};function re(l){return String.fromCharCode.apply(null,l)}function Wg(l,t){const i=l[t]<<8|l[t+1];return i<0?65536+i:i}function yt(l,t){const i=Qg(l,t);return i<0?4294967296+i:i}function Cm(l,t){let i=yt(l,t);return i*=Math.pow(2,32),i+=yt(l,t+4),i}function Qg(l,t){return l[t]<<24|l[t+1]<<16|l[t+2]<<8|l[t+3]}function Tc(l,t,i){l[t]=i>>24,l[t+1]=i>>16&255,l[t+2]=i>>8&255,l[t+3]=i&255}function CS(l){const t=l.byteLength;for(let i=0;i<t;){const s=yt(l,i);if(s>8&&l[i+4]===109&&l[i+5]===111&&l[i+6]===111&&l[i+7]===102)return!0;i=s>1?i+s:t}return!1}function xt(l,t){const i=[];if(!t.length)return i;const s=l.byteLength;for(let r=0;r<s;){const o=yt(l,r),u=re(l.subarray(r+4,r+8)),f=o>1?r+o:s;if(u===t[0])if(t.length===1)i.push(l.subarray(r+8,f));else{const h=xt(l.subarray(r+8,f),t.slice(1));h.length&&DS.apply(i,h)}r=f}return i}function _S(l){const t=[],i=l[0];let s=8;const r=yt(l,s);s+=4;let o=0,u=0;i===0?(o=yt(l,s),u=yt(l,s+4),s+=8):(o=Cm(l,s),u=Cm(l,s+8),s+=16),s+=2;let f=l.length+u;const h=Wg(l,s);s+=2;for(let d=0;d<h;d++){let g=s;const y=yt(l,g);g+=4;const v=y&2147483647;if((y&2147483648)>>>31===1)return N.warn("SIDX has hierarchical references (not supported)"),null;const E=yt(l,g);g+=4,t.push({referenceSize:v,subsegmentDuration:E,info:{duration:E/r,start:f,end:f+v-1}}),f+=v,g+=4,s=g}return{earliestPresentationTime:o,timescale:r,version:i,referencesCount:h,references:t}}function Zg(l){const t=[],i=xt(l,["moov","trak"]);for(let r=0;r<i.length;r++){const o=i[r],u=xt(o,["tkhd"])[0];if(u){let f=u[0];const h=yt(u,f===0?12:20),d=xt(o,["mdia","mdhd"])[0];if(d){f=d[0];const g=yt(d,f===0?12:20),y=xt(o,["mdia","hdlr"])[0];if(y){const v=re(y.subarray(8,12)),T={soun:Nt.AUDIO,vide:Nt.VIDEO}[v];if(T){const E=xt(o,["mdia","minf","stbl","stsd"])[0],x=OS(E);t[h]={timescale:g,type:T},t[T]=he({timescale:g,id:h},x)}}}}}return xt(l,["moov","mvex","trex"]).forEach(r=>{const o=yt(r,4),u=t[o];u&&(u.default={duration:yt(r,12),flags:yt(r,20)})}),t}function OS(l){const t=l.subarray(8),i=t.subarray(86),s=re(t.subarray(4,8));let r=s;const o=s==="enca"||s==="encv";if(o){const f=xt(t,[s])[0].subarray(s==="enca"?28:78);xt(f,["sinf"]).forEach(d=>{const g=xt(d,["schm"])[0];if(g){const y=re(g.subarray(4,8));if(y==="cbcs"||y==="cenc"){const v=xt(d,["frma"])[0];v&&(r=re(v))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const u=xt(i,["avcC"])[0];r+="."+ml(u[1])+ml(u[2])+ml(u[3]);break}case"mp4a":{const u=xt(t,[s])[0],f=xt(u.subarray(28),["esds"])[0];if(f&&f.length>12){let h=4;if(f[h++]!==3)break;h=Sc(f,h),h+=2;const d=f[h++];if(d&128&&(h+=2),d&64&&(h+=f[h++]),f[h++]!==4)break;h=Sc(f,h);const g=f[h++];if(g===64)r+="."+ml(g);else break;if(h+=12,f[h++]!==5)break;h=Sc(f,h);const y=f[h++];let v=(y&248)>>3;v===31&&(v+=1+((y&7)<<3)+((f[h]&224)>>5)),r+="."+v}break}case"hvc1":case"hev1":{const u=xt(i,["hvcC"])[0],f=u[1],h=["","A","B","C"][f>>6],d=f&31,g=yt(u,2),y=(f&32)>>5?"H":"L",v=u[12],T=u.subarray(6,12);r+="."+h+d,r+="."+g.toString(16).toUpperCase(),r+="."+y+v;let E="";for(let x=T.length;x--;){const A=T[x];(A||E)&&(E="."+A.toString(16).toUpperCase()+E)}r+=E;break}case"dvh1":case"dvhe":{const u=xt(i,["dvcC"])[0],f=u[2]>>1&127,h=u[2]<<5&32|u[3]>>3&31;r+="."+ci(f)+"."+ci(h);break}case"vp09":{const u=xt(i,["vpcC"])[0],f=u[4],h=u[5],d=u[6]>>4&15;r+="."+ci(f)+"."+ci(h)+"."+ci(d);break}case"av01":{const u=xt(i,["av1C"])[0],f=u[1]>>>5,h=u[1]&31,d=u[2]>>>7?"H":"M",g=(u[2]&64)>>6,y=(u[2]&32)>>5,v=f===2&&g?y?12:10:g?10:8,T=(u[2]&16)>>4,E=(u[2]&8)>>3,x=(u[2]&4)>>2,A=u[2]&3;r+="."+f+"."+ci(h)+d+"."+ci(v)+"."+T+"."+E+x+A+"."+ci(1)+"."+ci(1)+"."+ci(1)+"."+0;break}}return{codec:r,encrypted:o}}function Sc(l,t){const i=t+5;for(;l[t++]&128&&t<i;);return t}function ml(l){return("0"+l.toString(16).toUpperCase()).slice(-2)}function ci(l){return(l<10?"0":"")+l}function IS(l,t){if(!l||!t)return l;const i=t.keyId;return i&&t.isCommonEncryption&&xt(l,["moov","trak"]).forEach(r=>{const u=xt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let f=xt(u,["enca"]);const h=f.length>0;h||(f=xt(u,["encv"])),f.forEach(d=>{const g=h?d.subarray(28):d.subarray(78);xt(g,["sinf"]).forEach(v=>{const T=Jg(v);if(T){const E=T.subarray(8,24);E.some(x=>x!==0)||(N.log(`[eme] Patching keyId in 'enc${h?"a":"v"}>sinf>>tenc' box: ${fi.hexDump(E)} -> ${fi.hexDump(i)}`),T.set(i,8))}})})}),l}function Jg(l){const t=xt(l,["schm"])[0];if(t){const i=re(t.subarray(4,8));if(i==="cbcs"||i==="cenc")return xt(l,["schi","tenc"])[0]}return null}function wS(l,t){return xt(t,["moof","traf"]).reduce((i,s)=>{const r=xt(s,["tfdt"])[0],o=r[0],u=xt(s,["tfhd"]).reduce((f,h)=>{const d=yt(h,4),g=l[d];if(g){let y=yt(r,4);if(o===1){if(y===Ul)return N.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),f;y*=Ul+1,y+=yt(r,8)}const v=g.timescale||9e4,T=y/v;if(ot(T)&&(f===null||T<f))return T}return f},null);return u!==null&&ot(u)&&(i===null||u<i)?u:i},null)}function MS(l,t){let i=0,s=0,r=0;const o=xt(l,["moof","traf"]);for(let u=0;u<o.length;u++){const f=o[u],h=xt(f,["tfhd"])[0],d=yt(h,4),g=t[d];if(!g)continue;const y=g.default,v=yt(h,0)|(y==null?void 0:y.flags);let T=y==null?void 0:y.duration;v&8&&(v&2?T=yt(h,12):T=yt(h,8));const E=g.timescale||9e4,x=xt(f,["trun"]);for(let A=0;A<x.length;A++){if(i=kS(x[A]),!i&&T){const R=yt(x[A],4);i=T*R}g.type===Nt.VIDEO?s+=i/E:g.type===Nt.AUDIO&&(r+=i/E)}}if(s===0&&r===0){let u=1/0,f=0,h=0;const d=xt(l,["sidx"]);for(let g=0;g<d.length;g++){const y=_S(d[g]);if(y!=null&&y.references){u=Math.min(u,y.earliestPresentationTime/y.timescale);const v=y.references.reduce((T,E)=>T+E.info.duration||0,0);f=Math.max(f,v+y.earliestPresentationTime/y.timescale),h=f-u}}if(h&&ot(h))return h}return s||r}function kS(l){const t=yt(l,0);let i=8;t&1&&(i+=4),t&4&&(i+=4);let s=0;const r=yt(l,4);for(let o=0;o<r;o++){if(t&256){const u=yt(l,i);s+=u,i+=4}t&512&&(i+=4),t&1024&&(i+=4),t&2048&&(i+=4)}return s}function NS(l,t,i){xt(t,["moof","traf"]).forEach(s=>{xt(s,["tfhd"]).forEach(r=>{const o=yt(r,4),u=l[o];if(!u)return;const f=u.timescale||9e4;xt(s,["tfdt"]).forEach(h=>{const d=h[0],g=i*f;if(g){let y=yt(h,4);if(d===0)y-=g,y=Math.max(y,0),Tc(h,4,y);else{y*=Math.pow(2,32),y+=yt(h,8),y-=g,y=Math.max(y,0);const v=Math.floor(y/(Ul+1)),T=Math.floor(y%(Ul+1));Tc(h,4,v),Tc(h,8,T)}}})})})}function US(l){const t={valid:null,remainder:null},i=xt(l,["moof"]);if(i.length<2)return t.remainder=l,t;const s=i[i.length-1];return t.valid=Vn(l,0,s.byteOffset-8),t.remainder=Vn(l,s.byteOffset-8),t}function Xe(l,t){const i=new Uint8Array(l.length+t.length);return i.set(l),i.set(t,l.length),i}function _m(l,t){const i=[],s=t.samples,r=t.timescale,o=t.id;let u=!1;return xt(s,["moof"]).map(h=>{const d=h.byteOffset-8;xt(h,["traf"]).map(y=>{const v=xt(y,["tfdt"]).map(T=>{const E=T[0];let x=yt(T,4);return E===1&&(x*=Math.pow(2,32),x+=yt(T,8)),x/r})[0];return v!==void 0&&(l=v),xt(y,["tfhd"]).map(T=>{const E=yt(T,4),x=yt(T,0)&16777215,A=(x&1)!==0,R=(x&2)!==0,O=(x&8)!==0;let _=0;const F=(x&16)!==0;let I=0;const V=(x&32)!==0;let G=8;E===o&&(A&&(G+=8),R&&(G+=4),O&&(_=yt(T,G),G+=4),F&&(I=yt(T,G),G+=4),V&&(G+=4),t.type==="video"&&(u=FS(t.codec)),xt(y,["trun"]).map(Q=>{const z=Q[0],P=yt(Q,0)&16777215,J=(P&1)!==0;let gt=0;const rt=(P&4)!==0,mt=(P&256)!==0;let ct=0;const q=(P&512)!==0;let lt=0;const at=(P&1024)!==0,et=(P&2048)!==0;let D=0;const K=yt(Q,4);let it=8;J&&(gt=yt(Q,it),it+=4),rt&&(it+=4);let st=gt+d;for(let nt=0;nt<K;nt++){if(mt?(ct=yt(Q,it),it+=4):ct=_,q?(lt=yt(Q,it),it+=4):lt=I,at&&(it+=4),et&&(z===0?D=yt(Q,it):D=Qg(Q,it),it+=4),t.type===Nt.VIDEO){let pt=0;for(;pt<lt;){const ht=yt(s,st);if(st+=4,BS(u,s[st])){const Ut=s.subarray(st,st+ht);tp(Ut,u?2:1,l+D/r,i)}st+=ht,pt+=ht+4}}l+=ct/r}}))})})}),i}function FS(l){if(!l)return!1;const t=l.indexOf("."),i=t<0?l:l.substring(0,t);return i==="hvc1"||i==="hev1"||i==="dvh1"||i==="dvhe"}function BS(l,t){if(l){const i=t>>1&63;return i===39||i===40}else return(t&31)===6}function tp(l,t,i,s){const r=ep(l);let o=0;o+=t;let u=0,f=0,h=0;for(;o<r.length;){u=0;do{if(o>=r.length)break;h=r[o++],u+=h}while(h===255);f=0;do{if(o>=r.length)break;h=r[o++],f+=h}while(h===255);const d=r.length-o;let g=o;if(f<d)o+=f;else if(f>d){N.error(`Malformed SEI payload. ${f} is too small, only ${d} bytes left to parse.`);break}if(u===4){if(r[g++]===181){const v=Wg(r,g);if(g+=2,v===49){const T=yt(r,g);if(g+=4,T===1195456820){const E=r[g++];if(E===3){const x=r[g++],A=31&x,R=64&x,O=R?2+A*3:0,_=new Uint8Array(O);if(R){_[0]=x;for(let F=1;F<O;F++)_[F]=r[g++]}s.push({type:E,payloadType:u,pts:i,bytes:_})}}}}}else if(u===5&&f>16){const y=[];for(let E=0;E<16;E++){const x=r[g++].toString(16);y.push(x.length==1?"0"+x:x),(E===3||E===5||E===7||E===9)&&y.push("-")}const v=f-16,T=new Uint8Array(v);for(let E=0;E<v;E++)T[E]=r[g++];s.push({payloadType:u,pts:i,uuid:y.join(""),userData:pi(T),userDataBytes:T})}}}function ep(l){const t=l.byteLength,i=[];let s=1;for(;s<t-2;)l[s]===0&&l[s+1]===0&&l[s+2]===3?(i.push(s+2),s+=2):s++;if(i.length===0)return l;const r=t-i.length,o=new Uint8Array(r);let u=0;for(s=0;s<r;u++,s++)u===i[0]&&(u++,i.shift()),o[s]=l[u];return o}function PS(l){const t=l[0];let i="",s="",r=0,o=0,u=0,f=0,h=0,d=0;if(t===0){for(;re(l.subarray(d,d+1))!=="\0";)i+=re(l.subarray(d,d+1)),d+=1;for(i+=re(l.subarray(d,d+1)),d+=1;re(l.subarray(d,d+1))!=="\0";)s+=re(l.subarray(d,d+1)),d+=1;s+=re(l.subarray(d,d+1)),d+=1,r=yt(l,12),o=yt(l,16),f=yt(l,20),h=yt(l,24),d=28}else if(t===1){d+=4,r=yt(l,d),d+=4;const y=yt(l,d);d+=4;const v=yt(l,d);for(d+=4,u=2**32*y+v,nS(u)||(u=Number.MAX_SAFE_INTEGER,N.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),f=yt(l,d),d+=4,h=yt(l,d),d+=4;re(l.subarray(d,d+1))!=="\0";)i+=re(l.subarray(d,d+1)),d+=1;for(i+=re(l.subarray(d,d+1)),d+=1;re(l.subarray(d,d+1))!=="\0";)s+=re(l.subarray(d,d+1)),d+=1;s+=re(l.subarray(d,d+1)),d+=1}const g=l.subarray(d,l.byteLength);return{schemeIdUri:i,value:s,timeScale:r,presentationTime:u,presentationTimeDelta:o,eventDuration:f,id:h,payload:g}}function GS(l,...t){const i=t.length;let s=8,r=i;for(;r--;)s+=t[r].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=s&255,o.set(l,4),r=0,s=8;r<i;r++)o.set(t[r],s),s+=t[r].byteLength;return o}function $S(l,t,i){if(l.byteLength!==16)throw new RangeError("Invalid system id");let s,r;s=0,r=new Uint8Array;let o;s>0?(o=new Uint8Array(4),t.length>0&&new DataView(o.buffer).setUint32(0,t.length,!1)):o=new Uint8Array;const u=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(u.buffer).setUint32(0,i.byteLength,!1),GS([112,115,115,104],new Uint8Array([s,0,0,0]),l,o,r,u,i||new Uint8Array)}function HS(l){const t=[];if(l instanceof ArrayBuffer){const i=l.byteLength;let s=0;for(;s+32<i;){const r=new DataView(l,s),o=zS(r);t.push(o),s+=o.size}}return t}function zS(l){const t=l.getUint32(0),i=l.byteOffset,s=l.byteLength;if(s<t)return{offset:i,size:s};if(l.getUint32(4)!==1886614376)return{offset:i,size:t};const o=l.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:i,size:t};const u=l.buffer,f=fi.hexDump(new Uint8Array(u,i+12,16)),h=l.getUint32(28);let d=null,g=null;if(o===0){if(t-32<h||h<22)return{offset:i,size:t};g=new Uint8Array(u,i+32,h)}else if(o===1){if(!h||s<i+32+h*16+16)return{offset:i,size:t};d=[];for(let y=0;y<h;y++)d.push(new Uint8Array(u,i+32+y*16,16))}return{version:o,systemId:f,kids:d,data:g,offset:i,size:t}}let gl={};class Kr{static clearKeyUriToKeyIdMap(){gl={}}constructor(t,i,s,r=[1],o=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=i,this.keyFormat=s,this.keyFormatVersions=r,this.iv=o,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&t!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case De.FAIRPLAY:case De.WIDEVINE:case De.PLAYREADY:case De.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method==="AES-128"&&!this.iv&&N.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const s=VS(t);return new Kr(this.method,this.uri,"identity",this.keyFormatVersions,s)}const i=pS(this.uri);if(i)switch(this.keyFormat){case De.WIDEVINE:this.pssh=i,i.length>=22&&(this.keyId=i.subarray(i.length-22,i.length-6));break;case De.PLAYREADY:{const s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=$S(s,null,i),this.keyId=Kg(i);break}default:{let s=i.subarray(0,16);if(s.length!==16){const r=new Uint8Array(16);r.set(s,16-s.length),s=r}this.keyId=s;break}}if(!this.keyId||this.keyId.byteLength!==16){let s=gl[this.uri];if(!s){const r=Object.keys(gl).length%Number.MAX_SAFE_INTEGER;s=new Uint8Array(16),new DataView(s.buffer,12,4).setUint32(0,r),gl[this.uri]=s}this.keyId=s}return this}}function VS(l){const t=new Uint8Array(16);for(let i=12;i<16;i++)t[i]=l>>8*(15-i)&255;return t}const ip=/\{\$([a-zA-Z0-9-_]+)\}/g;function Om(l){return ip.test(l)}function Le(l,t,i){if(l.variableList!==null||l.hasVariableRefs)for(let s=i.length;s--;){const r=i[s],o=t[r];o&&(t[r]=zc(l,o))}}function zc(l,t){if(l.variableList!==null||l.hasVariableRefs){const i=l.variableList;return t.replace(ip,s=>{const r=s.substring(2,s.length-1),o=i==null?void 0:i[r];return o===void 0?(l.playlistParsingError||(l.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),s):o})}return t}function Im(l,t,i){let s=l.variableList;s||(l.variableList=s={});let r,o;if("QUERYPARAM"in t){r=t.QUERYPARAM;try{const u=new self.URL(i).searchParams;if(u.has(r))o=u.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${i}"`)}catch(u){l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${u.message}`))}}else r=t.NAME,o=t.VALUE;r in s?l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):s[r]=o||""}function KS(l,t,i){const s=t.IMPORT;if(i&&s in i){let r=l.variableList;r||(l.variableList=r={}),r[s]=i[s]}else l.playlistParsingError||(l.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}function Yn(l=!0){return typeof self>"u"?void 0:(l||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function YS(l){return typeof self<"u"&&l===self.ManagedMediaSource}const Fl={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function qS(l,t){const i=Fl[t];return!!i&&!!i[l.slice(0,4)]}function xc(l,t,i=!0){return!l.split(",").some(s=>!np(s,t,i))}function np(l,t,i=!0){var s;const r=Yn(i);return(s=r==null?void 0:r.isTypeSupported(Yr(l,t)))!=null?s:!1}function Yr(l,t){return`${t}/mp4;codecs="${l}"`}function wm(l){if(l){const t=l.substring(0,4);return Fl.video[t]}return 2}function Bl(l){return l.split(",").reduce((t,i)=>{const s=Fl.video[i];return s?(s*2+t)/(t?3:2):(Fl.audio[i]+t)/(t?2:1)},0)}const Ac={};function jS(l,t=!0){if(Ac[l])return Ac[l];const i={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[l];for(let s=0;s<i.length;s++)if(np(i[s],"audio",t))return Ac[l]=i[s],i[s];return l}const XS=/flac|opus/i;function Pl(l,t=!0){return l.replace(XS,i=>jS(i.toLowerCase(),t))}function Mm(l,t){return l&&l!=="mp4a"?l:t&&t.split(",")[0]}function WS(l){const t=l.split(",");for(let i=0;i<t.length;i++){const s=t[i].split(".");if(s.length>2){let r=s.shift()+".";r+=parseInt(s.shift()).toString(16),r+=("000"+parseInt(s.shift()).toString(16)).slice(-4),t[i]=r}}return t.join(",")}const km=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Nm=/#EXT-X-MEDIA:(.*)/g,QS=/^#EXT(?:INF|-X-TARGETDURATION):/m,Um=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),ZS=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class di{static findGroup(t,i){for(let s=0;s<t.length;s++){const r=t[s];if(r.id===i)return r}}static resolve(t,i){return cf.buildAbsoluteURL(i,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return QS.test(t)}static parseMasterPlaylist(t,i){const s=Om(t),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:s},o=[];km.lastIndex=0;let u;for(;(u=km.exec(t))!=null;)if(u[1]){var f;const d=new qt(u[1]);Le(r,d,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const g=zc(r,u[2]),y={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:di.resolve(g,i)},v=d.decimalResolution("RESOLUTION");v&&(y.width=v.width,y.height=v.height),JS(d.CODECS,y),(f=y.unknownCodecs)!=null&&f.length||o.push(y),r.levels.push(y)}else if(u[3]){const d=u[3],g=u[4];switch(d){case"SESSION-DATA":{const y=new qt(g);Le(r,y,["DATA-ID","LANGUAGE","VALUE","URI"]);const v=y["DATA-ID"];v&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[v]=y);break}case"SESSION-KEY":{const y=Fm(g,i,r);y.encrypted&&y.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(y)):N.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{{const y=new qt(g);Le(r,y,["NAME","VALUE","QUERYPARAM"]),Im(r,y,i)}break}case"CONTENT-STEERING":{const y=new qt(g);Le(r,y,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:di.resolve(y["SERVER-URI"],i),pathwayId:y["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=Bm(g);break}}}const h=o.length>0&&o.length<r.levels.length;return r.levels=h?o:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(t,i,s){let r;const o={},u=s.levels,f={AUDIO:u.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:u.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let h=0;for(Nm.lastIndex=0;(r=Nm.exec(t))!==null;){const d=new qt(r[1]),g=d.TYPE;if(g){const y=f[g],v=o[g]||[];o[g]=v,Le(s,d,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const T=d.LANGUAGE,E=d["ASSOC-LANGUAGE"],x=d.CHANNELS,A=d.CHARACTERISTICS,R=d["INSTREAM-ID"],O={attrs:d,bitrate:0,id:h++,groupId:d["GROUP-ID"]||"",name:d.NAME||T||"",type:g,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:T,url:d.URI?di.resolve(d.URI,i):""};if(E&&(O.assocLang=E),x&&(O.channels=x),A&&(O.characteristics=A),R&&(O.instreamId=R),y!=null&&y.length){const _=di.findGroup(y,O.groupId)||y[0];Pm(O,_,"audioCodec"),Pm(O,_,"textCodec")}v.push(O)}}return o}static parseLevelPlaylist(t,i,s,r,o,u){const f=new dS(i),h=f.fragments;let d=null,g=0,y=0,v=0,T=0,E=null,x=new gc(r,i),A,R,O,_=-1,F=!1,I=null;for(Um.lastIndex=0,f.m3u8=t,f.hasVariableRefs=Om(t);(A=Um.exec(t))!==null;){F&&(F=!1,x=new gc(r,i),x.start=v,x.sn=g,x.cc=T,x.level=s,d&&(x.initSegment=d,x.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,I&&(x.setByteRange(I),I=null)));const z=A[1];if(z){x.duration=parseFloat(z);const P=(" "+A[2]).slice(1);x.title=P||null,x.tagList.push(P?["INF",z,P]:["INF",z])}else if(A[3]){if(ot(x.duration)){x.start=v,O&&Hm(x,O,f),x.sn=g,x.level=s,x.cc=T,h.push(x);const P=(" "+A[3]).slice(1);x.relurl=zc(f,P),Gm(x,E),E=x,v+=x.duration,g++,y=0,F=!0}}else if(A[4]){const P=(" "+A[4]).slice(1);E?x.setByteRange(P,E):x.setByteRange(P)}else if(A[5])x.rawProgramDateTime=(" "+A[5]).slice(1),x.tagList.push(["PROGRAM-DATE-TIME",x.rawProgramDateTime]),_===-1&&(_=h.length);else{if(A=A[0].match(ZS),!A){N.warn("No matches on slow regex match for level playlist!");continue}for(R=1;R<A.length&&!(typeof A[R]<"u");R++);const P=(" "+A[R]).slice(1),J=(" "+A[R+1]).slice(1),gt=A[R+2]?(" "+A[R+2]).slice(1):"";switch(P){case"PLAYLIST-TYPE":f.type=J.toUpperCase();break;case"MEDIA-SEQUENCE":g=f.startSN=parseInt(J);break;case"SKIP":{const rt=new qt(J);Le(f,rt,["RECENTLY-REMOVED-DATERANGES"]);const mt=rt.decimalInteger("SKIPPED-SEGMENTS");if(ot(mt)){f.skippedSegments=mt;for(let q=mt;q--;)h.unshift(null);g+=mt}const ct=rt.enumeratedString("RECENTLY-REMOVED-DATERANGES");ct&&(f.recentlyRemovedDateranges=ct.split("	"));break}case"TARGETDURATION":f.targetduration=Math.max(parseInt(J),1);break;case"VERSION":f.version=parseInt(J);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":f.live=!1;break;case"#":(J||gt)&&x.tagList.push(gt?[J,gt]:[J]);break;case"DISCONTINUITY":T++,x.tagList.push(["DIS"]);break;case"GAP":x.gap=!0,x.tagList.push([P]);break;case"BITRATE":x.tagList.push([P,J]);break;case"DATERANGE":{const rt=new qt(J);Le(f,rt,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Le(f,rt,rt.clientAttrs);const mt=new Hg(rt,f.dateRanges[rt.ID]);mt.isValid||f.skippedSegments?f.dateRanges[mt.id]=mt:N.warn(`Ignoring invalid DATERANGE tag: "${J}"`),x.tagList.push(["EXT-X-DATERANGE",J]);break}case"DEFINE":{{const rt=new qt(J);Le(f,rt,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in rt?KS(f,rt,u):Im(f,rt,i)}break}case"DISCONTINUITY-SEQUENCE":T=parseInt(J);break;case"KEY":{const rt=Fm(J,i,f);if(rt.isSupported()){if(rt.method==="NONE"){O=void 0;break}O||(O={}),O[rt.keyFormat]&&(O=ie({},O)),O[rt.keyFormat]=rt}else N.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${J}"`);break}case"START":f.startTimeOffset=Bm(J);break;case"MAP":{const rt=new qt(J);if(Le(f,rt,["BYTERANGE","URI"]),x.duration){const mt=new gc(r,i);$m(mt,rt,s,O),d=mt,x.initSegment=d,d.rawProgramDateTime&&!x.rawProgramDateTime&&(x.rawProgramDateTime=d.rawProgramDateTime)}else{const mt=x.byteRangeEndOffset;if(mt){const ct=x.byteRangeStartOffset;I=`${mt-ct}@${ct}`}else I=null;$m(x,rt,s,O),d=x,F=!0}break}case"SERVER-CONTROL":{const rt=new qt(J);f.canBlockReload=rt.bool("CAN-BLOCK-RELOAD"),f.canSkipUntil=rt.optionalFloat("CAN-SKIP-UNTIL",0),f.canSkipDateRanges=f.canSkipUntil>0&&rt.bool("CAN-SKIP-DATERANGES"),f.partHoldBack=rt.optionalFloat("PART-HOLD-BACK",0),f.holdBack=rt.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const rt=new qt(J);f.partTarget=rt.decimalFloatingPoint("PART-TARGET");break}case"PART":{let rt=f.partList;rt||(rt=f.partList=[]);const mt=y>0?rt[rt.length-1]:void 0,ct=y++,q=new qt(J);Le(f,q,["BYTERANGE","URI"]);const lt=new fS(q,x,i,ct,mt);rt.push(lt),x.duration+=lt.duration;break}case"PRELOAD-HINT":{const rt=new qt(J);Le(f,rt,["URI"]),f.preloadHint=rt;break}case"RENDITION-REPORT":{const rt=new qt(J);Le(f,rt,["URI"]),f.renditionReports=f.renditionReports||[],f.renditionReports.push(rt);break}default:N.warn(`line parsed but not handled: ${A}`);break}}}E&&!E.relurl?(h.pop(),v-=E.duration,f.partList&&(f.fragmentHint=E)):f.partList&&(Gm(x,E),x.cc=T,f.fragmentHint=x,O&&Hm(x,O,f));const V=h.length,G=h[0],Q=h[V-1];if(v+=f.skippedSegments*f.targetduration,v>0&&V&&Q){f.averagetargetduration=v/V;const z=Q.sn;f.endSN=z!=="initSegment"?z:0,f.live||(Q.endList=!0),G&&(f.startCC=G.cc)}else f.endSN=0,f.startCC=0;return f.fragmentHint&&(v+=f.fragmentHint.duration),f.totalduration=v,f.endCC=T,_>0&&tx(h,_),f}}function Fm(l,t,i){var s,r;const o=new qt(l);Le(i,o,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const u=(s=o.METHOD)!=null?s:"",f=o.URI,h=o.hexadecimalInteger("IV"),d=o.KEYFORMATVERSIONS,g=(r=o.KEYFORMAT)!=null?r:"identity";f&&o.IV&&!h&&N.error(`Invalid IV: ${o.IV}`);const y=f?di.resolve(f,t):"",v=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Kr(u,y,g,v,h)}function Bm(l){const i=new qt(l).decimalFloatingPoint("TIME-OFFSET");return ot(i)?i:null}function JS(l,t){let i=(l||"").split(/[ ,]+/).filter(s=>s);["video","audio","text"].forEach(s=>{const r=i.filter(o=>qS(o,s));r.length&&(t[`${s}Codec`]=r.join(","),i=i.filter(o=>r.indexOf(o)===-1))}),t.unknownCodecs=i}function Pm(l,t,i){const s=t[i];s&&(l[i]=s)}function tx(l,t){let i=l[t];for(let s=t;s--;){const r=l[s];if(!r)return;r.programDateTime=i.programDateTime-r.duration*1e3,i=r}}function Gm(l,t){l.rawProgramDateTime?l.programDateTime=Date.parse(l.rawProgramDateTime):t!=null&&t.programDateTime&&(l.programDateTime=t.endProgramDateTime),ot(l.programDateTime)||(l.programDateTime=null,l.rawProgramDateTime=null)}function $m(l,t,i,s){l.relurl=t.URI,t.BYTERANGE&&l.setByteRange(t.BYTERANGE),l.level=i,l.sn="initSegment",s&&(l.levelkeys=s),l.initSegment=null}function Hm(l,t,i){l.levelkeys=t;const{encryptedFragments:s}=i;(!s.length||s[s.length-1].levelkeys!==t)&&Object.keys(t).some(r=>t[r].isCommonEncryption)&&s.push(l)}var Ot={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},vt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function zm(l){const{type:t}=l;switch(t){case Ot.AUDIO_TRACK:return vt.AUDIO;case Ot.SUBTITLE_TRACK:return vt.SUBTITLE;default:return vt.MAIN}}function bc(l,t){let i=l.url;return(i===void 0||i.indexOf("data:")===0)&&(i=t.url),i}class ex{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.LEVEL_LOADING,this.onLevelLoading,this),t.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.LEVEL_LOADING,this.onLevelLoading,this),t.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const i=this.hls.config,s=i.pLoader,r=i.loader,o=s||r,u=new o(i);return this.loaders[t.type]=u,u}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const i=this.loaders[t];i&&i.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,i){const{url:s}=i;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ot.MANIFEST,url:s,deliveryDirectives:null})}onLevelLoading(t,i){const{id:s,level:r,pathwayId:o,url:u,deliveryDirectives:f}=i;this.load({id:s,level:r,pathwayId:o,responseType:"text",type:Ot.LEVEL,url:u,deliveryDirectives:f})}onAudioTrackLoading(t,i){const{id:s,groupId:r,url:o,deliveryDirectives:u}=i;this.load({id:s,groupId:r,level:null,responseType:"text",type:Ot.AUDIO_TRACK,url:o,deliveryDirectives:u})}onSubtitleTrackLoading(t,i){const{id:s,groupId:r,url:o,deliveryDirectives:u}=i;this.load({id:s,groupId:r,level:null,responseType:"text",type:Ot.SUBTITLE_TRACK,url:o,deliveryDirectives:u})}load(t){var i;const s=this.hls.config;let r=this.getInternalLoader(t);if(r){const d=r.context;if(d&&d.url===t.url&&d.level===t.level){N.trace("[playlist-loader]: playlist request ongoing");return}N.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),r.abort()}let o;if(t.type===Ot.MANIFEST?o=s.manifestLoadPolicy.default:o=ie({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(t),ot((i=t.deliveryDirectives)==null?void 0:i.part)){let d;if(t.type===Ot.LEVEL&&t.level!==null?d=this.hls.levels[t.level].details:t.type===Ot.AUDIO_TRACK&&t.id!==null?d=this.hls.audioTracks[t.id].details:t.type===Ot.SUBTITLE_TRACK&&t.id!==null&&(d=this.hls.subtitleTracks[t.id].details),d){const g=d.partTarget,y=d.targetduration;if(g&&y){const v=Math.max(g*3,y*.8)*1e3;o=ie({},o,{maxTimeToFirstByteMs:Math.min(v,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(v,o.maxTimeToFirstByteMs)})}}}const u=o.errorRetry||o.timeoutRetry||{},f={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},h={onSuccess:(d,g,y,v)=>{const T=this.getInternalLoader(y);this.resetInternalLoader(y.type);const E=d.data;if(E.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(d,y,new Error("no EXTM3U delimiter"),v||null,g);return}g.parsing.start=performance.now(),di.isMediaPlaylist(E)?this.handleTrackOrLevelPlaylist(d,g,y,v||null,T):this.handleMasterPlaylist(d,g,y,v)},onError:(d,g,y,v)=>{this.handleNetworkError(g,y,!1,d,v)},onTimeout:(d,g,y)=>{this.handleNetworkError(g,y,!0,void 0,d)}};r.load(t,f,h)}handleMasterPlaylist(t,i,s,r){const o=this.hls,u=t.data,f=bc(t,s),h=di.parseMasterPlaylist(u,f);if(h.playlistParsingError){this.handleManifestParsingError(t,s,h.playlistParsingError,r,i);return}const{contentSteering:d,levels:g,sessionData:y,sessionKeys:v,startTimeOffset:T,variableList:E}=h;this.variableList=E;const{AUDIO:x=[],SUBTITLES:A,"CLOSED-CAPTIONS":R}=di.parseMasterPlaylistMedia(u,f,h);x.length&&!x.some(_=>!_.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(N.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new qt({}),bitrate:0,url:""})),o.trigger(b.MANIFEST_LOADED,{levels:g,audioTracks:x,subtitles:A,captions:R,contentSteering:d,url:f,stats:i,networkDetails:r,sessionData:y,sessionKeys:v,startTimeOffset:T,variableList:E})}handleTrackOrLevelPlaylist(t,i,s,r,o){const u=this.hls,{id:f,level:h,type:d}=s,g=bc(t,s),y=0,v=ot(h)?h:ot(f)?f:0,T=zm(s),E=di.parseLevelPlaylist(t.data,g,v,T,y,this.variableList);if(d===Ot.MANIFEST){const x={attrs:new qt({}),bitrate:0,details:E,name:"",url:g};u.trigger(b.MANIFEST_LOADED,{levels:[x],audioTracks:[],url:g,stats:i,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}i.parsing.end=performance.now(),s.levelDetails=E,this.handlePlaylistLoaded(E,t,i,s,r,o)}handleManifestParsingError(t,i,s,r,o){this.hls.trigger(b.ERROR,{type:Tt.NETWORK_ERROR,details:H.MANIFEST_PARSING_ERROR,fatal:i.type===Ot.MANIFEST,url:t.url,err:s,error:s,reason:s.message,response:t,context:i,networkDetails:r,stats:o})}handleNetworkError(t,i,s=!1,r,o){let u=`A network ${s?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${t.type}`;t.type===Ot.LEVEL?u+=`: ${t.level} id: ${t.id}`:(t.type===Ot.AUDIO_TRACK||t.type===Ot.SUBTITLE_TRACK)&&(u+=` id: ${t.id} group-id: "${t.groupId}"`);const f=new Error(u);N.warn(`[playlist-loader]: ${u}`);let h=H.UNKNOWN,d=!1;const g=this.getInternalLoader(t);switch(t.type){case Ot.MANIFEST:h=s?H.MANIFEST_LOAD_TIMEOUT:H.MANIFEST_LOAD_ERROR,d=!0;break;case Ot.LEVEL:h=s?H.LEVEL_LOAD_TIMEOUT:H.LEVEL_LOAD_ERROR,d=!1;break;case Ot.AUDIO_TRACK:h=s?H.AUDIO_TRACK_LOAD_TIMEOUT:H.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Ot.SUBTITLE_TRACK:h=s?H.SUBTITLE_TRACK_LOAD_TIMEOUT:H.SUBTITLE_LOAD_ERROR,d=!1;break}g&&this.resetInternalLoader(t.type);const y={type:Tt.NETWORK_ERROR,details:h,fatal:d,url:t.url,loader:g,context:t,error:f,networkDetails:i,stats:o};if(r){const v=(i==null?void 0:i.url)||t.url;y.response=he({url:v,data:void 0},r)}this.hls.trigger(b.ERROR,y)}handlePlaylistLoaded(t,i,s,r,o,u){const f=this.hls,{type:h,level:d,id:g,groupId:y,deliveryDirectives:v}=r,T=bc(i,r),E=zm(r),x=typeof r.level=="number"&&E===vt.MAIN?d:void 0;if(!t.fragments.length){const R=new Error("No Segments found in Playlist");f.trigger(b.ERROR,{type:Tt.NETWORK_ERROR,details:H.LEVEL_EMPTY_ERROR,fatal:!1,url:T,error:R,reason:R.message,response:i,context:r,level:x,parent:E,networkDetails:o,stats:s});return}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const A=t.playlistParsingError;if(A){f.trigger(b.ERROR,{type:Tt.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:T,error:A,reason:A.message,response:i,context:r,level:x,parent:E,networkDetails:o,stats:s});return}switch(t.live&&u&&(u.getCacheAge&&(t.ageHeader=u.getCacheAge()||0),(!u.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),h){case Ot.MANIFEST:case Ot.LEVEL:f.trigger(b.LEVEL_LOADED,{details:t,level:x||0,id:g||0,stats:s,networkDetails:o,deliveryDirectives:v});break;case Ot.AUDIO_TRACK:f.trigger(b.AUDIO_TRACK_LOADED,{details:t,id:g||0,groupId:y||"",stats:s,networkDetails:o,deliveryDirectives:v});break;case Ot.SUBTITLE_TRACK:f.trigger(b.SUBTITLE_TRACK_LOADED,{details:t,id:g||0,groupId:y||"",stats:s,networkDetails:o,deliveryDirectives:v});break}}}function sp(l,t){let i;try{i=new Event("addtrack")}catch{i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=l,t.dispatchEvent(i)}function rp(l,t){const i=l.mode;if(i==="disabled"&&(l.mode="hidden"),l.cues&&!l.cues.getCueById(t.id))try{if(l.addCue(t),!l.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(s){N.debug(`[texttrack-utils]: ${s}`);try{const r=new self.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,l.addCue(r)}catch(r){N.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}i==="disabled"&&(l.mode=i)}function Ms(l){const t=l.mode;if(t==="disabled"&&(l.mode="hidden"),l.cues)for(let i=l.cues.length;i--;)l.removeCue(l.cues[i]);t==="disabled"&&(l.mode=t)}function Vc(l,t,i,s){const r=l.mode;if(r==="disabled"&&(l.mode="hidden"),l.cues&&l.cues.length>0){const o=nx(l.cues,t,i);for(let u=0;u<o.length;u++)(!s||s(o[u]))&&l.removeCue(o[u])}r==="disabled"&&(l.mode=r)}function ix(l,t){if(t<l[0].startTime)return 0;const i=l.length-1;if(t>l[i].endTime)return-1;let s=0,r=i;for(;s<=r;){const o=Math.floor((r+s)/2);if(t<l[o].startTime)r=o-1;else if(t>l[o].startTime&&s<i)s=o+1;else return o}return l[s].startTime-t<t-l[r].startTime?s:r}function nx(l,t,i){const s=[],r=ix(l,t);if(r>-1)for(let o=r,u=l.length;o<u;o++){const f=l[o];if(f.startTime>=t&&f.endTime<=i)s.push(f);else if(f.startTime>i)return s}return s}function Dl(l){const t=[];for(let i=0;i<l.length;i++){const s=l[i];(s.kind==="subtitles"||s.kind==="captions")&&s.label&&t.push(l[i])}return t}var ii={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const sx=.25;function Kc(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Vm(l,t,i,s,r){let o=new l(t,i,"");try{o.value=s,r&&(o.type=r)}catch{o=new l(t,i,JSON.stringify(r?he({type:r},s):s))}return o}const pl=(()=>{const l=Kc();try{l&&new l(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Rc(l,t){return l.getTime()/1e3-t}function rx(l){return Uint8Array.from(l.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ax{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(b.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,i){this.media=i.media}onMediaDetaching(){this.id3Track&&(Ms(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const i=this.getID3Track(t.textTracks);return i.mode="hidden",i}getID3Track(t){if(this.media){for(let i=0;i<t.length;i++){const s=t[i];if(s.kind==="metadata"&&s.label==="id3")return sp(s,this.media),s}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,i){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:s,enableID3MetadataCues:r}}}=this;if(!s&&!r)return;const{samples:o}=i;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=Kc();if(u)for(let f=0;f<o.length;f++){const h=o[f].type;if(h===ii.emsg&&!s||!r)continue;const d=jg(o[f].data);if(d){const g=o[f].pts;let y=g+o[f].duration;y>pl&&(y=pl),y-g<=0&&(y=g+sx);for(let T=0;T<d.length;T++){const E=d[T];if(!qg(E)){this.updateId3CueEnds(g,h);const x=Vm(u,g,y,E,h);x&&this.id3Track.addCue(x)}}}}}updateId3CueEnds(t,i){var s;const r=(s=this.id3Track)==null?void 0:s.cues;if(r)for(let o=r.length;o--;){const u=r[o];u.type===i&&u.startTime<t&&u.endTime===pl&&(u.endTime=t)}}onBufferFlushing(t,{startOffset:i,endOffset:s,type:r}){const{id3Track:o,hls:u}=this;if(!u)return;const{config:{enableEmsgMetadataCues:f,enableID3MetadataCues:h}}=u;if(o&&(f||h)){let d;r==="audio"?d=g=>g.type===ii.audioId3&&h:r==="video"?d=g=>g.type===ii.emsg&&f:d=g=>g.type===ii.audioId3&&h||g.type===ii.emsg&&f,Vc(o,i,s,d)}}onLevelUpdated(t,{details:i}){if(!this.media||!i.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:s,id3Track:r}=this,{dateRanges:o}=i,u=Object.keys(o);if(r){const g=Object.keys(s).filter(y=>!u.includes(y));for(let y=g.length;y--;){const v=g[y];Object.keys(s[v].cues).forEach(T=>{r.removeCue(s[v].cues[T])}),delete s[v]}}const f=i.fragments[i.fragments.length-1];if(u.length===0||!ot(f==null?void 0:f.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const h=f.programDateTime/1e3-f.start,d=Kc();for(let g=0;g<u.length;g++){const y=u[g],v=o[y],T=Rc(v.startDate,h),E=s[y],x=(E==null?void 0:E.cues)||{};let A=(E==null?void 0:E.durationKnown)||!1,R=pl;const O=v.endDate;if(O)R=Rc(O,h),A=!0;else if(v.endOnNext&&!A){const F=u.reduce((I,V)=>{if(V!==v.id){const G=o[V];if(G.class===v.class&&G.startDate>v.startDate&&(!I||v.startDate<I.startDate))return G}return I},null);F&&(R=Rc(F.startDate,h),A=!0)}const _=Object.keys(v.attr);for(let F=0;F<_.length;F++){const I=_[F];if(!uS(I))continue;const V=x[I];if(V)A&&!E.durationKnown&&(V.endTime=R);else if(d){let G=v.attr[I];cS(I)&&(G=rx(G));const Q=Vm(d,T,R,{key:I,data:G},ii.dateRange);Q&&(Q.id=y,this.id3Track.addCue(Q),x[I]=Q)}}s[y]={cues:x,dateRange:v,durationKnown:A}}}}class lx{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:i}=this;return t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:i?t.liveMaxLatencyDurationCount*i.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(t===null)return null;const{holdBack:i,partHoldBack:s,targetduration:r}=t,{liveSyncDuration:o,liveSyncDurationCount:u,lowLatencyMode:f}=this.config,h=this.hls.userConfig;let d=f&&s||i;(h.liveSyncDuration||h.liveSyncDurationCount||d===0)&&(d=o!==void 0?o:u*r);const g=r;return d+Math.min(this.stallCount*1,g)}get liveSyncPosition(){const t=this.estimateLiveEdge(),i=this.targetLatency,s=this.levelDetails;if(t===null||i===null||s===null)return null;const r=s.edge,o=t-i-this.edgeStalled,u=r-s.totalduration,f=r-(this.config.lowLatencyMode&&s.partTarget||s.targetduration);return Math.min(Math.max(u,o),f)}get drift(){const{levelDetails:t}=this;return t===null?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(t===null)return 0;const i=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-i,0)}get forwardBufferLength(){const{media:t,levelDetails:i}=this;if(!t||!i)return 0;const s=t.buffered.length;return(s?t.buffered.end(s-1):i.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(b.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(b.ERROR,this.onError,this)}onMediaAttached(t,i){this.media=i.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:i}){this.levelDetails=i,i.advanced&&this.timeupdate(),!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,i){var s;i.details===H.BUFFER_STALLED_ERROR&&(this.stallCount++,(s=this.levelDetails)!=null&&s.live&&N.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:i}=this;if(!t||!i)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:o}=this.config;if(!r||o===1||!i.live)return;const u=this.targetLatency;if(u===null)return;const f=s-u,h=Math.min(this.maxLatency,u+i.targetduration);if(f<h&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,o)),y=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20;t.playbackRate=Math.min(g,Math.max(1,y))}else t.playbackRate!==1&&t.playbackRate!==0&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}const Yc=["NONE","TYPE-0","TYPE-1",null];function ox(l){return Yc.indexOf(l)>-1}const Gl=["SDR","PQ","HLG"];function ux(l){return!!l&&Gl.indexOf(l)>-1}var Cl={No:"",Yes:"YES",v2:"v2"};function Km(l){const{canSkipUntil:t,canSkipDateRanges:i,age:s}=l,r=s<t/2;return t&&r?i?Cl.v2:Cl.Yes:Cl.No}class Ym{constructor(t,i,s){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=i,this.skip=s}addDirectives(t){const i=new self.URL(t);return this.msn!==void 0&&i.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&i.searchParams.set("_HLS_part",this.part.toString()),this.skip&&i.searchParams.set("_HLS_skip",this.skip),i.href}}class Us{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return qm(this._audioGroups,t)}hasSubtitleGroup(t){return qm(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,i){if(i){if(t==="audio"){let s=this._audioGroups;s||(s=this._audioGroups=[]),s.indexOf(i)===-1&&s.push(i)}else if(t==="text"){let s=this._subtitleGroups;s||(s=this._subtitleGroups=[]),s.indexOf(i)===-1&&s.push(i)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function qm(l,t){return!t||!l?!1:l.indexOf(t)!==-1}function Lc(l,t){const i=t.startPTS;if(ot(i)){let s=0,r;t.sn>l.sn?(s=i-l.start,r=l):(s=l.start-i,r=t),r.duration!==s&&(r.duration=s)}else t.sn>l.sn?l.cc===t.cc&&l.minEndPTS?t.start=l.start+(l.minEndPTS-l.start):t.start=l.start+l.duration:t.start=Math.max(l.start-t.duration,0)}function ap(l,t,i,s,r,o){s-i<=0&&(N.warn("Fragment should have a positive duration",t),s=i+t.duration,o=r+t.duration);let f=i,h=s;const d=t.startPTS,g=t.endPTS;if(ot(d)){const A=Math.abs(d-i);ot(t.deltaPTS)?t.deltaPTS=Math.max(A,t.deltaPTS):t.deltaPTS=A,f=Math.max(i,d),i=Math.min(i,d),r=Math.min(r,t.startDTS),h=Math.min(s,g),s=Math.max(s,g),o=Math.max(o,t.endDTS)}const y=i-t.start;t.start!==0&&(t.start=i),t.duration=s-t.start,t.startPTS=i,t.maxStartPTS=f,t.startDTS=r,t.endPTS=s,t.minEndPTS=h,t.endDTS=o;const v=t.sn;if(!l||v<l.startSN||v>l.endSN)return 0;let T;const E=v-l.startSN,x=l.fragments;for(x[E]=t,T=E;T>0;T--)Lc(x[T],x[T-1]);for(T=E;T<x.length-1;T++)Lc(x[T],x[T+1]);return l.fragmentHint&&Lc(x[x.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,y}function cx(l,t){let i=null;const s=l.fragments;for(let f=s.length-1;f>=0;f--){const h=s[f].initSegment;if(h){i=h;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;let r;dx(l,t,(f,h,d,g)=>{if(t.skippedSegments&&h.cc!==f.cc){const y=f.cc-h.cc;for(let v=d;v<g.length;v++)g[v].cc+=y}ot(f.startPTS)&&ot(f.endPTS)&&(h.start=h.startPTS=f.startPTS,h.startDTS=f.startDTS,h.maxStartPTS=f.maxStartPTS,h.endPTS=f.endPTS,h.endDTS=f.endDTS,h.minEndPTS=f.minEndPTS,h.duration=f.endPTS-f.startPTS,h.duration&&(r=h),t.PTSKnown=t.alignedSliding=!0),h.elementaryStreams=f.elementaryStreams,h.loader=f.loader,h.stats=f.stats,f.initSegment&&(h.initSegment=f.initSegment,i=f.initSegment)});const o=t.fragments;if(i&&(t.fragmentHint?o.concat(t.fragmentHint):o).forEach(h=>{var d;h&&(!h.initSegment||h.initSegment.relurl===((d=i)==null?void 0:d.relurl))&&(h.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=o.some(f=>!f),t.deltaUpdateFailed){N.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let f=t.skippedSegments;f--;)o.shift();t.startSN=o[0].sn}else t.canSkipDateRanges&&(t.dateRanges=fx(l.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));t.startCC=t.fragments[0].cc,t.endCC=o[o.length-1].cc}hx(l.partList,t.partList,(f,h)=>{h.elementaryStreams=f.elementaryStreams,h.stats=f.stats}),r?ap(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):lp(l,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=l.driftStartTime,t.driftStart=l.driftStart;const u=t.advancedDateTime;if(t.advanced&&u){const f=t.edge;t.driftStart||(t.driftStartTime=u,t.driftStart=f),t.driftEndTime=u,t.driftEnd=f}else t.driftEndTime=l.driftEndTime,t.driftEnd=l.driftEnd,t.advancedDateTime=l.advancedDateTime}function fx(l,t,i){const s=ie({},l);return i&&i.forEach(r=>{delete s[r]}),Object.keys(t).forEach(r=>{const o=new Hg(t[r].attr,s[r]);o.isValid?s[r]=o:N.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[r].attr)}"`)}),s}function hx(l,t,i){if(l&&t){let s=0;for(let r=0,o=l.length;r<=o;r++){const u=l[r],f=t[r+s];u&&f&&u.index===f.index&&u.fragment.sn===f.fragment.sn?i(u,f):s--}}}function dx(l,t,i){const s=t.skippedSegments,r=Math.max(l.startSN,t.startSN)-t.startSN,o=(l.fragmentHint?1:0)+(s?t.endSN:Math.min(l.endSN,t.endSN))-t.startSN,u=t.startSN-l.startSN,f=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,h=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments;for(let d=r;d<=o;d++){const g=h[u+d];let y=f[d];s&&!y&&d<s&&(y=t.fragments[d]=g),g&&y&&i(g,y,d,f)}}function lp(l,t){const i=t.startSN+t.skippedSegments-l.startSN,s=l.fragments;i<0||i>=s.length||qc(t,s[i].start)}function qc(l,t){if(t){const i=l.fragments;for(let s=l.skippedSegments;s<i.length;s++)i[s].start+=t;l.fragmentHint&&(l.fragmentHint.start+=t)}}function mx(l,t=1/0){let i=1e3*l.targetduration;if(l.updated){const s=l.fragments;if(s.length&&i*4>t){const o=s[s.length-1].duration*1e3;o<i&&(i=o)}}else i/=2;return Math.round(i)}function gx(l,t,i){if(!(l!=null&&l.details))return null;const s=l.details;let r=s.fragments[t-s.startSN];return r||(r=s.fragmentHint,r&&r.sn===t)?r:t<s.startSN&&i&&i.sn===t?i:null}function jm(l,t,i){var s;return l!=null&&l.details?op((s=l.details)==null?void 0:s.partList,t,i):null}function op(l,t,i){if(l)for(let s=l.length;s--;){const r=l[s];if(r.index===i&&r.fragment.sn===t)return r}return null}function up(l){l.forEach((t,i)=>{const{details:s}=t;s!=null&&s.fragments&&s.fragments.forEach(r=>{r.level=i})})}function $l(l){switch(l.details){case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_TIMEOUT:case H.LEVEL_LOAD_TIMEOUT:case H.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Xm(l,t){const i=$l(t);return l.default[`${i?"timeout":"error"}Retry`]}function mf(l,t){const i=l.backoff==="linear"?1:Math.pow(2,t);return Math.min(i*l.retryDelayMs,l.maxRetryDelayMs)}function Wm(l){return he(he({},l),{errorRetry:null,timeoutRetry:null})}function Hl(l,t,i,s){if(!l)return!1;const r=s==null?void 0:s.code,o=t<l.maxNumRetry&&(px(r)||!!i);return l.shouldRetry?l.shouldRetry(l,t,i,s,o):o}function px(l){return l===0&&navigator.onLine===!1||!!l&&(l<400||l>499)}const cp={search:function(l,t){let i=0,s=l.length-1,r=null,o=null;for(;i<=s;){r=(i+s)/2|0,o=l[r];const u=t(o);if(u>0)i=r+1;else if(u<0)s=r-1;else return o}return null}};function yx(l,t,i){if(t===null||!Array.isArray(l)||!l.length||!ot(t))return null;const s=l[0].programDateTime;if(t<(s||0))return null;const r=l[l.length-1].endProgramDateTime;if(t>=(r||0))return null;i=i||0;for(let o=0;o<l.length;++o){const u=l[o];if(Ex(t,i,u))return u}return null}function zl(l,t,i=0,s=0,r=.005){let o=null;if(l){o=t[l.sn-t[0].sn+1]||null;const f=l.endDTS-i;f>0&&f<15e-7&&(i+=15e-7)}else i===0&&t[0].start===0&&(o=t[0]);if(o&&((!l||l.level===o.level)&&jc(i,s,o)===0||vx(o,l,Math.min(r,s))))return o;const u=cp.search(t,jc.bind(null,i,s));return u&&(u!==l||!o)?u:o}function vx(l,t,i){if(t&&t.start===0&&t.level<l.level&&(t.endPTS||0)>0){const s=t.tagList.reduce((r,o)=>(o[0]==="INF"&&(r+=parseFloat(o[1])),r),i);return l.start<=s}return!1}function jc(l=0,t=0,i){if(i.start<=l&&i.start+i.duration>l)return 0;const s=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-s<=l?1:i.start-s>l&&i.start?-1:0}function Ex(l,t,i){const s=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0))*1e3;return(i.endProgramDateTime||0)-s>l}function Tx(l,t){return cp.search(l,i=>i.cc<t?1:i.cc>t?-1:0)}var pe={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},ti={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class Sx{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=N.log.bind(N,"[info]:"),this.warn=N.warn.bind(N,"[warning]:"),this.error=N.error.bind(N,"[error]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(b.ERROR,this.onError,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(b.ERROR,this.onError,this),t.off(b.ERROR,this.onErrorOut,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(t==null?void 0:t.type)===vt.MAIN?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,i){var s,r;if(i.fatal)return;const o=this.hls,u=i.context;switch(i.details){case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:i.errorAction=this.getFragRetryOrSwitchAction(i);return;case H.FRAG_PARSING_ERROR:if((s=i.frag)!=null&&s.gap){i.errorAction={action:pe.DoNothing,flags:ti.None};return}case H.FRAG_GAP:case H.FRAG_DECRYPT_ERROR:{i.errorAction=this.getFragRetryOrSwitchAction(i),i.errorAction.action=pe.SendAlternateToPenaltyBox;return}case H.LEVEL_EMPTY_ERROR:case H.LEVEL_PARSING_ERROR:{var f,h;const d=i.parent===vt.MAIN?i.level:o.loadLevel;i.details===H.LEVEL_EMPTY_ERROR&&((f=i.context)!=null&&(h=f.levelDetails)!=null&&h.live)?i.errorAction=this.getPlaylistRetryOrSwitchAction(i,d):(i.levelRetry=!1,i.errorAction=this.getLevelSwitchAction(i,d))}return;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:typeof(u==null?void 0:u.level)=="number"&&(i.errorAction=this.getPlaylistRetryOrSwitchAction(i,u.level));return;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.SUBTITLE_LOAD_ERROR:case H.SUBTITLE_TRACK_LOAD_TIMEOUT:if(u){const d=o.levels[o.loadLevel];if(d&&(u.type===Ot.AUDIO_TRACK&&d.hasAudioGroup(u.groupId)||u.type===Ot.SUBTITLE_TRACK&&d.hasSubtitleGroup(u.groupId))){i.errorAction=this.getPlaylistRetryOrSwitchAction(i,o.loadLevel),i.errorAction.action=pe.SendAlternateToPenaltyBox,i.errorAction.flags=ti.MoveAllAlternatesMatchingHost;return}}return;case H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const d=o.levels[o.loadLevel],g=d==null?void 0:d.attrs["HDCP-LEVEL"];g?i.errorAction={action:pe.SendAlternateToPenaltyBox,flags:ti.MoveAllAlternatesMatchingHDCP,hdcpLevel:g}:this.keySystemError(i)}return;case H.BUFFER_ADD_CODEC_ERROR:case H.REMUX_ALLOC_ERROR:case H.BUFFER_APPEND_ERROR:i.errorAction=this.getLevelSwitchAction(i,(r=i.level)!=null?r:o.loadLevel);return;case H.INTERNAL_EXCEPTION:case H.BUFFER_APPENDING_ERROR:case H.BUFFER_FULL_ERROR:case H.LEVEL_SWITCH_ERROR:case H.BUFFER_STALLED_ERROR:case H.BUFFER_SEEK_OVER_HOLE:case H.BUFFER_NUDGE_ON_STALL:i.errorAction={action:pe.DoNothing,flags:ti.None};return}i.type===Tt.KEY_SYSTEM_ERROR&&this.keySystemError(i)}keySystemError(t){const i=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,i)}getPlaylistRetryOrSwitchAction(t,i){const s=this.hls,r=Xm(s.config.playlistLoadPolicy,t),o=this.playlistError++;if(Hl(r,o,$l(t),t.response))return{action:pe.RetryRequest,flags:ti.None,retryConfig:r,retryCount:o};const f=this.getLevelSwitchAction(t,i);return r&&(f.retryConfig=r,f.retryCount=o),f}getFragRetryOrSwitchAction(t){const i=this.hls,s=this.getVariantLevelIndex(t.frag),r=i.levels[s],{fragLoadPolicy:o,keyLoadPolicy:u}=i.config,f=Xm(t.details.startsWith("key")?u:o,t),h=i.levels.reduce((g,y)=>g+y.fragmentError,0);if(r&&(t.details!==H.FRAG_GAP&&r.fragmentError++,Hl(f,h,$l(t),t.response)))return{action:pe.RetryRequest,flags:ti.None,retryConfig:f,retryCount:h};const d=this.getLevelSwitchAction(t,s);return f&&(d.retryConfig=f,d.retryCount=h),d}getLevelSwitchAction(t,i){const s=this.hls;i==null&&(i=s.loadLevel);const r=this.hls.levels[i];if(r){var o,u;const d=t.details;r.loadError++,d===H.BUFFER_APPEND_ERROR&&r.fragmentError++;let g=-1;const{levels:y,loadLevel:v,minAutoLevel:T,maxAutoLevel:E}=s;s.autoLevelEnabled||(s.loadLevel=-1);const x=(o=t.frag)==null?void 0:o.type,R=(x===vt.AUDIO&&d===H.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(d===H.BUFFER_ADD_CODEC_ERROR||d===H.BUFFER_APPEND_ERROR))&&y.some(({audioCodec:V})=>r.audioCodec!==V),_=t.sourceBufferName==="video"&&(d===H.BUFFER_ADD_CODEC_ERROR||d===H.BUFFER_APPEND_ERROR)&&y.some(({codecSet:V,audioCodec:G})=>r.codecSet!==V&&r.audioCodec===G),{type:F,groupId:I}=(u=t.context)!=null?u:{};for(let V=y.length;V--;){const G=(V+v)%y.length;if(G!==v&&G>=T&&G<=E&&y[G].loadError===0){var f,h;const Q=y[G];if(d===H.FRAG_GAP&&x===vt.MAIN&&t.frag){const z=y[G].details;if(z){const P=zl(t.frag,z.fragments,t.frag.start);if(P!=null&&P.gap)continue}}else{if(F===Ot.AUDIO_TRACK&&Q.hasAudioGroup(I)||F===Ot.SUBTITLE_TRACK&&Q.hasSubtitleGroup(I))continue;if(x===vt.AUDIO&&(f=r.audioGroups)!=null&&f.some(z=>Q.hasAudioGroup(z))||x===vt.SUBTITLE&&(h=r.subtitleGroups)!=null&&h.some(z=>Q.hasSubtitleGroup(z))||R&&r.audioCodec===Q.audioCodec||!R&&r.audioCodec!==Q.audioCodec||_&&r.codecSet===Q.codecSet)continue}g=G;break}}if(g>-1&&s.loadLevel!==g)return t.levelRetry=!0,this.playlistError=0,{action:pe.SendAlternateToPenaltyBox,flags:ti.None,nextAutoLevel:g}}return{action:pe.SendAlternateToPenaltyBox,flags:ti.MoveAllAlternatesMatchingHost}}onErrorOut(t,i){var s;switch((s=i.errorAction)==null?void 0:s.action){case pe.DoNothing:break;case pe.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(i),!i.errorAction.resolved&&i.details!==H.FRAG_GAP?i.fatal=!0:/MediaSource readyState: ended/.test(i.error.message)&&(this.warn(`MediaSource ended after "${i.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(i.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const i=this.hls,s=t.errorAction;if(!s)return;const{flags:r,hdcpLevel:o,nextAutoLevel:u}=s;switch(r){case ti.None:this.switchLevel(t,u);break;case ti.MoveAllAlternatesMatchingHDCP:o&&(i.maxHdcpLevel=Yc[Yc.indexOf(o)-1],s.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${i.maxHdcpLevel}" or lower`);break}s.resolved||this.switchLevel(t,u)}switchLevel(t,i){i!==void 0&&t.errorAction&&(this.warn(`switching to level ${i} after ${t.details}`),this.hls.nextAutoLevel=i,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class gf{constructor(t,i){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=N.log.bind(N,`${i}:`),this.warn=N.warn.bind(N,`${i}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,i,s){const r=i==null?void 0:i.renditionReports;if(r){let o=-1;for(let u=0;u<r.length;u++){const f=r[u];let h;try{h=new self.URL(f.URI,i.url).href}catch(d){N.warn(`Could not construct new URL for Rendition Report: ${d}`),h=f.URI||""}if(h===t){o=u;break}else h===t.substring(0,h.length)&&(o=u)}if(o!==-1){const u=r[o],f=parseInt(u["LAST-MSN"])||(i==null?void 0:i.lastPartSn);let h=parseInt(u["LAST-PART"])||(i==null?void 0:i.lastPartIndex);if(this.hls.config.lowLatencyMode){const g=Math.min(i.age-i.partTarget,i.targetduration);h>=0&&g>i.partTarget&&(h+=1)}const d=s&&Km(s);return new Ym(f,h>=0?h:void 0,d)}}}loadPlaylist(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(t)}playlistLoaded(t,i,s){const{details:r,stats:o}=i,u=self.performance.now(),f=o.loading.first?Math.max(0,u-o.loading.first):0;if(r.advancedDateTime=Date.now()-f,r.live||s!=null&&s.live){if(r.reloaded(s),s&&this.log(`live playlist ${t} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),s&&r.fragments.length>0&&cx(s,r),!this.canLoad||!r.live)return;let h,d,g;if(r.canBlockReload&&r.endSN&&r.advanced){const A=this.hls.config.lowLatencyMode,R=r.lastPartSn,O=r.endSN,_=r.lastPartIndex,F=_!==-1,I=R===O,V=A?0:_;F?(d=I?O+1:R,g=I?V:_+1):d=O+1;const G=r.age,Q=G+r.ageHeader;let z=Math.min(Q-r.partTarget,r.targetduration*1.5);if(z>0){if(s&&z>s.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${s.tuneInGoal} to: ${z} with playlist age: ${r.age}`),z=0;else{const P=Math.floor(z/r.targetduration);if(d+=P,g!==void 0){const J=Math.round(z%r.targetduration/r.partTarget);g+=J}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${G.toFixed(2)}s goal: ${z} skip sn ${P} to part ${g}`)}r.tuneInGoal=z}if(h=this.getDeliveryDirectives(r,i.deliveryDirectives,d,g),A||!I){this.loadPlaylist(h);return}}else(r.canBlockReload||r.canSkipUntil)&&(h=this.getDeliveryDirectives(r,i.deliveryDirectives,d,g));const y=this.hls.mainForwardBufferInfo,v=y?y.end-y.len:0,T=(r.edge-v)*1e3,E=mx(r,T);r.updated&&u>this.requestScheduled+E&&(this.requestScheduled=o.loading.start),d!==void 0&&r.canBlockReload?this.requestScheduled=o.loading.first+E-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+E<u?this.requestScheduled=u:this.requestScheduled-u<=0&&(this.requestScheduled+=E);let x=this.requestScheduled-u;x=Math.max(0,x),this.log(`reload live playlist ${t} in ${Math.round(x)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(h),x)}else this.clearTimer()}getDeliveryDirectives(t,i,s,r){let o=Km(t);return i!=null&&i.skip&&t.deltaUpdateFailed&&(s=i.msn,r=i.part,o=Cl.No),new Ym(s,r,o)}checkRetry(t){const i=t.details,s=$l(t),r=t.errorAction,{action:o,retryCount:u=0,retryConfig:f}=r||{},h=!!r&&!!f&&(o===pe.RetryRequest||!r.resolved&&o===pe.SendAlternateToPenaltyBox);if(h){var d;if(this.requestScheduled=-1,u>=f.maxNumRetry)return!1;if(s&&(d=t.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${u+1}/${f.maxNumRetry} after "${i}" without delivery-directives`),this.loadPlaylist();else{const g=mf(f,u);this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${u+1}/${f.maxNumRetry} after "${i}" in ${g}ms`)}t.levelRetry=!0,r.resolved=!0}return h}}class _s{constructor(t,i=0,s=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=i,this.totalWeight_=s}sample(t,i){const s=Math.pow(this.alpha_,t);this.estimate_=i*(1-s)+s*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class xx{constructor(t,i,s,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new _s(t),this.fast_=new _s(i),this.defaultTTFB_=r,this.ttfb_=new _s(t)}update(t,i){const{slow_:s,fast_:r,ttfb_:o}=this;s.halfLife!==t&&(this.slow_=new _s(t,s.getEstimate(),s.getTotalWeight())),r.halfLife!==i&&(this.fast_=new _s(i,r.getEstimate(),r.getTotalWeight())),o.halfLife!==t&&(this.ttfb_=new _s(t,o.getEstimate(),o.getTotalWeight()))}sample(t,i){t=Math.max(t,this.minDelayMs_);const s=8*i,r=t/1e3,o=s/r;this.fast_.sample(r,o),this.slow_.sample(r,o)}sampleTTFB(t){const i=t/1e3,s=Math.sqrt(2)*Math.exp(-Math.pow(i,2)/2);this.ttfb_.sample(s,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const fp={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Qm={};function Ax(l,t,i,s,r,o){const u=l.audioCodec?l.audioGroups:null,f=o==null?void 0:o.audioCodec,h=o==null?void 0:o.channels,d=h?parseInt(h):f?1/0:2;let g=null;if(u!=null&&u.length)try{u.length===1&&u[0]?g=t.groups[u[0]].channels:g=u.reduce((y,v)=>{if(v){const T=t.groups[v];if(!T)throw new Error(`Audio track group ${v} not found`);Object.keys(T.channels).forEach(E=>{y[E]=(y[E]||0)+T.channels[E]})}return y},{2:0})}catch{return!0}return l.videoCodec!==void 0&&(l.width>1920&&l.height>1088||l.height>1920&&l.width>1088||l.frameRate>Math.max(s,30)||l.videoRange!=="SDR"&&l.videoRange!==i||l.bitrate>Math.max(r,8e6))||!!g&&ot(d)&&Object.keys(g).some(y=>parseInt(y)>d)}function bx(l,t,i){const s=l.videoCodec,r=l.audioCodec;if(!s||!r||!i)return Promise.resolve(fp);const o={width:l.width,height:l.height,bitrate:Math.ceil(Math.max(l.bitrate*.9,l.averageBitrate)),framerate:l.frameRate||30},u=l.videoRange;u!=="SDR"&&(o.transferFunction=u.toLowerCase());const f=s.split(",").map(h=>({type:"media-source",video:he(he({},o),{},{contentType:Yr(h,"video")})}));return r&&l.audioGroups&&l.audioGroups.forEach(h=>{var d;h&&((d=t.groups[h])==null||d.tracks.forEach(g=>{if(g.groupId===h){const y=g.channels||"",v=parseFloat(y);ot(v)&&v>2&&f.push.apply(f,r.split(",").map(T=>({type:"media-source",audio:{contentType:Yr(T,"audio"),channels:""+v}})))}}))}),Promise.all(f.map(h=>{const d=Rx(h);return Qm[d]||(Qm[d]=i.decodingInfo(h))})).then(h=>({supported:!h.some(d=>!d.supported),configurations:f,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:f,decodingInfoResults:[],error:h}))}function Rx(l){const{audio:t,video:i}=l,s=i||t;if(s){const r=s.contentType.split('"')[1];if(i)return`r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${r}_${Math.ceil(i.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${r}`}return""}function Lx(){if(typeof matchMedia=="function"){const l=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(l.media!==t.media)return l.matches===!0}return!1}function Dx(l,t){let i=!1,s=[];return l&&(i=l!=="SDR",s=[l]),t&&(s=t.allowedVideoRanges||Gl.slice(0),i=t.preferHDR!==void 0?t.preferHDR:Lx(),i?s=s.filter(r=>r!=="SDR"):s=["SDR"]),{preferHDR:i,allowedVideoRanges:s}}function Cx(l,t,i,s,r){const o=Object.keys(l),u=s==null?void 0:s.channels,f=s==null?void 0:s.audioCodec,h=u&&parseInt(u)===2;let d=!0,g=!1,y=1/0,v=1/0,T=1/0,E=0,x=[];const{preferHDR:A,allowedVideoRanges:R}=Dx(t,r);for(let I=o.length;I--;){const V=l[o[I]];d=V.channels[2]>0,y=Math.min(y,V.minHeight),v=Math.min(v,V.minFramerate),T=Math.min(T,V.minBitrate);const G=R.filter(Q=>V.videoRanges[Q]>0);G.length>0&&(g=!0,x=G)}y=ot(y)?y:0,v=ot(v)?v:0;const O=Math.max(1080,y),_=Math.max(30,v);return T=ot(T)?T:i,i=Math.max(T,i),g||(t=void 0,x=[]),{codecSet:o.reduce((I,V)=>{const G=l[V];if(V===I)return I;if(G.minBitrate>i)return Fi(V,`min bitrate of ${G.minBitrate} > current estimate of ${i}`),I;if(!G.hasDefaultAudio)return Fi(V,"no renditions with default or auto-select sound found"),I;if(f&&V.indexOf(f.substring(0,4))%5!==0)return Fi(V,`audio codec preference "${f}" not found`),I;if(u&&!h){if(!G.channels[u])return Fi(V,`no renditions with ${u} channel sound found (channels options: ${Object.keys(G.channels)})`),I}else if((!f||h)&&d&&G.channels[2]===0)return Fi(V,"no renditions with stereo sound found"),I;return G.minHeight>O?(Fi(V,`min resolution of ${G.minHeight} > maximum of ${O}`),I):G.minFramerate>_?(Fi(V,`min framerate of ${G.minFramerate} > maximum of ${_}`),I):x.some(Q=>G.videoRanges[Q]>0)?G.maxScore<E?(Fi(V,`max score of ${G.maxScore} < selected max of ${E}`),I):I&&(Bl(V)>=Bl(I)||G.fragmentError>l[I].fragmentError)?I:(E=G.maxScore,V):(Fi(V,`no variants with VIDEO-RANGE of ${JSON.stringify(x)} found`),I)},void 0),videoRanges:x,preferHDR:A,minFramerate:v,minBitrate:T}}function Fi(l,t){N.log(`[abr] start candidates with "${l}" ignored because ${t}`)}function _x(l){return l.reduce((t,i)=>{let s=t.groups[i.groupId];s||(s=t.groups[i.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),s.tracks.push(i);const r=i.channels||"2";return s.channels[r]=(s.channels[r]||0)+1,s.hasDefault=s.hasDefault||i.default,s.hasAutoSelect=s.hasAutoSelect||i.autoselect,s.hasDefault&&(t.hasDefaultAudio=!0),s.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Ox(l,t,i,s){return l.slice(i,s+1).reduce((r,o)=>{if(!o.codecSet)return r;const u=o.audioGroups;let f=r[o.codecSet];f||(r[o.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,o.bitrate);const h=Math.min(o.height,o.width);return f.minHeight=Math.min(f.minHeight,h),f.minFramerate=Math.min(f.minFramerate,o.frameRate),f.maxScore=Math.max(f.maxScore,o.score),f.fragmentError+=o.fragmentError,f.videoRanges[o.videoRange]=(f.videoRanges[o.videoRange]||0)+1,u&&u.forEach(d=>{if(!d)return;const g=t.groups[d];g&&(f.hasDefaultAudio=f.hasDefaultAudio||t.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(g.channels).forEach(y=>{f.channels[y]=(f.channels[y]||0)+g.channels[y]}))}),r},{})}function mi(l,t,i){if("attrs"in l){const s=t.indexOf(l);if(s!==-1)return s}for(let s=0;s<t.length;s++){const r=t[s];if(Kn(l,r,i))return s}return-1}function Kn(l,t,i){const{groupId:s,name:r,lang:o,assocLang:u,default:f}=l,h=l.forced;return(s===void 0||t.groupId===s)&&(r===void 0||t.name===r)&&(o===void 0||t.lang===o)&&(o===void 0||t.assocLang===u)&&(f===void 0||t.default===f)&&(h===void 0||t.forced===h)&&(!("characteristics"in l)||Ix(l.characteristics||"",t.characteristics))&&(i===void 0||i(l,t))}function Ix(l,t=""){const i=l.split(","),s=t.split(",");return i.length===s.length&&!i.some(r=>s.indexOf(r)===-1)}function Hn(l,t){const{audioCodec:i,channels:s}=l;return(i===void 0||(t.audioCodec||"").substring(0,4)===i.substring(0,4))&&(s===void 0||s===(t.channels||"2"))}function wx(l,t,i,s,r){const o=t[s],f=t.reduce((v,T,E)=>{const x=T.uri;return(v[x]||(v[x]=[])).push(E),v},{})[o.uri];f.length>1&&(s=Math.max.apply(Math,f));const h=o.videoRange,d=o.frameRate,g=o.codecSet.substring(0,4),y=Zm(t,s,v=>{if(v.videoRange!==h||v.frameRate!==d||v.codecSet.substring(0,4)!==g)return!1;const T=v.audioGroups,E=i.filter(x=>!T||T.indexOf(x.groupId)!==-1);return mi(l,E,r)>-1});return y>-1?y:Zm(t,s,v=>{const T=v.audioGroups,E=i.filter(x=>!T||T.indexOf(x.groupId)!==-1);return mi(l,E,r)>-1})}function Zm(l,t,i){for(let s=t;s>-1;s--)if(i(l[s]))return s;for(let s=t+1;s<l.length;s++)if(i(l[s]))return s;return-1}class Mx{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:i,partCurrent:s,hls:r}=this,{autoLevelEnabled:o,media:u}=r;if(!i||!u)return;const f=performance.now(),h=s?s.stats:i.stats,d=s?s.duration:i.duration,g=f-h.loading.start,y=r.minAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||i.level<=y){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o||u.paused||!u.playbackRate||!u.readyState)return;const v=r.mainForwardBufferInfo;if(v===null)return;const T=this.bwEstimator.getEstimateTTFB(),E=Math.abs(u.playbackRate);if(g<=Math.max(T,1e3*(d/(E*2))))return;const x=v.len/E,A=h.loading.first?h.loading.first-h.loading.start:-1,R=h.loaded&&A>-1,O=this.getBwEstimate(),_=r.levels,F=_[i.level],I=h.total||Math.max(h.loaded,Math.round(d*F.averageBitrate/8));let V=R?g-A:g;V<1&&R&&(V=Math.min(g,h.loaded*8/O));const G=R?h.loaded*1e3/V:0,Q=G?(I-h.loaded)/G:I*8/O+T/1e3;if(Q<=x)return;const z=G?G*8:O;let P=Number.POSITIVE_INFINITY,J;for(J=i.level-1;J>y;J--){const rt=_[J].maxBitrate;if(P=this.getTimeToLoadFrag(T/1e3,z,d*rt,!_[J].details),P<x)break}if(P>=Q||P>d*10)return;r.nextLoadLevel=r.nextAutoLevel=J,R?this.bwEstimator.sample(g-Math.min(T,A),h.loaded):this.bwEstimator.sampleTTFB(g);const gt=_[J].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>gt&&this.resetEstimator(gt),this.clearTimer(),N.warn(`[abr] Fragment ${i.sn}${s?" part "+s.index:""} of level ${i.level} is loading too slowly;
      Time to underbuffer: ${x.toFixed(3)} s
      Estimated load time for current fragment: ${Q.toFixed(3)} s
      Estimated load time for down switch fragment: ${P.toFixed(3)} s
      TTFB estimate: ${A|0} ms
      Current BW estimate: ${ot(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${J} @ ${gt|0} bps`),r.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:s,stats:h})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(N.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new xx(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.FRAG_LOADING,this.onFragLoading,this),t.on(b.FRAG_LOADED,this.onFragLoaded,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this),t.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.FRAG_LOADING,this.onFragLoading,this),t.off(b.FRAG_LOADED,this.onFragLoaded,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this),t.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(b.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,i){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,i){const s=i.frag;if(!this.ignoreFragment(s)){if(!s.bitrateTest){var r;this.fragCurrent=s,this.partCurrent=(r=i.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,i){this.clearTimer()}onError(t,i){if(!i.fatal)switch(i.details){case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case H.FRAG_LOAD_TIMEOUT:{const s=i.frag,{fragCurrent:r,partCurrent:o}=this;if(s&&r&&s.sn===r.sn&&s.level===r.level){const u=performance.now(),f=o?o.stats:s.stats,h=u-f.loading.start,d=f.loading.first?f.loading.first-f.loading.start:-1;if(f.loaded&&d>-1){const y=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(h-Math.min(y,d),f.loaded)}else this.bwEstimator.sampleTTFB(h)}break}}}getTimeToLoadFrag(t,i,s,r){const o=t+s/i,u=r?this.lastLevelLoadSec:0;return o+u}onLevelLoaded(t,i){const s=this.hls.config,{loading:r}=i.stats,o=r.end-r.start;ot(o)&&(this.lastLevelLoadSec=o/1e3),i.details.live?this.bwEstimator.update(s.abrEwmaSlowLive,s.abrEwmaFastLive):this.bwEstimator.update(s.abrEwmaSlowVoD,s.abrEwmaFastVoD)}onFragLoaded(t,{frag:i,part:s}){const r=s?s.stats:i.stats;if(i.type===vt.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(i)){if(this.clearTimer(),i.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=s?s.duration:i.duration,u=this.hls.levels[i.level],f=(u.loaded?u.loaded.bytes:0)+r.loaded,h=(u.loaded?u.loaded.duration:0)+o;u.loaded={bytes:f,duration:h},u.realBitrate=Math.round(8*f/h)}if(i.bitrateTest){const o={stats:r,frag:i,part:s,id:i.type};this.onFragBuffered(b.FRAG_BUFFERED,o),i.bitrateTest=!1}else this.lastLoadedFragLevel=i.level}}onFragBuffered(t,i){const{frag:s,part:r}=i,o=r!=null&&r.stats.loaded?r.stats:s.stats;if(o.aborted||this.ignoreFragment(s))return;const u=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(u,o.loaded),o.bwEstimate=this.getBwEstimate(),s.bitrateTest?this.bitrateTestDelay=u/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==vt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:i}=this.hls,s=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,o=this.findBestLevel(s,i,t,0,r,1,1);if(o>-1)return o;const u=this.hls.firstLevel,f=Math.min(Math.max(u,i),t);return N.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${u} clamped to ${f}`),f}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,s=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(t!==-1&&(!s||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const o=s&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const u=this.hls.levels;if(u.length>Math.max(t,o)&&u[t].loadError<=u[o].loadError)return t}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:i,hls:s}=this,{maxAutoLevel:r,config:o,minAutoLevel:u}=s,f=i?i.duration:t?t.duration:0,h=this.getBwEstimate(),d=this.getStarvationDelay();let g=o.abrBandWidthFactor,y=o.abrBandWidthUpFactor;if(d){const A=this.findBestLevel(h,u,r,d,0,g,y);if(A>=0)return A}let v=f?Math.min(f,o.maxStarvationDelay):o.maxStarvationDelay;if(!d){const A=this.bitrateTestDelay;A&&(v=(f?Math.min(f,o.maxLoadingDelay):o.maxLoadingDelay)-A,N.info(`[abr] bitrate test took ${Math.round(1e3*A)}ms, set first fragment max fetchDuration to ${Math.round(1e3*v)} ms`),g=y=1)}const T=this.findBestLevel(h,u,r,d,v,g,y);if(N.info(`[abr] ${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${T}`),T>-1)return T;const E=s.levels[u],x=s.levels[s.loadLevel];return(E==null?void 0:E.bitrate)<(x==null?void 0:x.bitrate)?u:s.loadLevel}getStarvationDelay(){const t=this.hls,i=t.media;if(!i)return 1/0;const s=i&&i.playbackRate!==0?Math.abs(i.playbackRate):1,r=t.mainForwardBufferInfo;return(r?r.len:0)/s}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,i,s,r,o,u,f){var h;const d=r+o,g=this.lastLoadedFragLevel,y=g===-1?this.hls.firstLevel:g,{fragCurrent:v,partCurrent:T}=this,{levels:E,allAudioTracks:x,loadLevel:A,config:R}=this.hls;if(E.length===1)return 0;const O=E[y],_=!!(O!=null&&(h=O.details)!=null&&h.live),F=A===-1||g===-1;let I,V="SDR",G=(O==null?void 0:O.frameRate)||0;const{audioPreference:Q,videoPreference:z}=R,P=this.audioTracksByGroup||(this.audioTracksByGroup=_x(x));if(F){if(this.firstSelection!==-1)return this.firstSelection;const ct=this.codecTiers||(this.codecTiers=Ox(E,P,i,s)),q=Cx(ct,V,t,Q,z),{codecSet:lt,videoRanges:at,minFramerate:et,minBitrate:D,preferHDR:K}=q;I=lt,V=K?at[at.length-1]:at[0],G=et,t=Math.max(t,D),N.log(`[abr] picked start tier ${JSON.stringify(q)}`)}else I=O==null?void 0:O.codecSet,V=O==null?void 0:O.videoRange;const J=T?T.duration:v?v.duration:0,gt=this.bwEstimator.getEstimateTTFB()/1e3,rt=[];for(let ct=s;ct>=i;ct--){var mt;const q=E[ct],lt=ct>y;if(!q)continue;if(R.useMediaCapabilities&&!q.supportedResult&&!q.supportedPromise){const nt=navigator.mediaCapabilities;typeof(nt==null?void 0:nt.decodingInfo)=="function"&&Ax(q,P,V,G,t,Q)?(q.supportedPromise=bx(q,P,nt),q.supportedPromise.then(pt=>{if(!this.hls)return;q.supportedResult=pt;const ht=this.hls.levels,Ut=ht.indexOf(q);pt.error?N.warn(`[abr] MediaCapabilities decodingInfo error: "${pt.error}" for level ${Ut} ${JSON.stringify(pt)}`):pt.supported||(N.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Ut} ${JSON.stringify(pt)}`),Ut>-1&&ht.length>1&&(N.log(`[abr] Removing unsupported level ${Ut}`),this.hls.removeLevel(Ut)))})):q.supportedResult=fp}if(I&&q.codecSet!==I||V&&q.videoRange!==V||lt&&G>q.frameRate||!lt&&G>0&&G<q.frameRate||q.supportedResult&&!((mt=q.supportedResult.decodingInfoResults)!=null&&mt[0].smooth)){rt.push(ct);continue}const at=q.details,et=(T?at==null?void 0:at.partTarget:at==null?void 0:at.averagetargetduration)||J;let D;lt?D=f*t:D=u*t;const K=J&&r>=J*2&&o===0?E[ct].averageBitrate:E[ct].maxBitrate,it=this.getTimeToLoadFrag(gt,D,K*et,at===void 0);if(D>=K&&(ct===g||q.loadError===0&&q.fragmentError===0)&&(it<=gt||!ot(it)||_&&!this.bitrateTestDelay||it<d)){const nt=this.forcedAutoLevel;return ct!==A&&(nt===-1||nt!==A)&&(rt.length&&N.trace(`[abr] Skipped level(s) ${rt.join(",")} of ${s} max with CODECS and VIDEO-RANGE:"${E[rt[0]].codecs}" ${E[rt[0]].videoRange}; not compatible with "${O.codecs}" ${V}`),N.info(`[abr] switch candidate:${y}->${ct} adjustedbw(${Math.round(D)})-bitrate=${Math.round(D-K)} ttfb:${gt.toFixed(1)} avgDuration:${et.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${it.toFixed(1)} firstSelection:${F} codecSet:${I} videoRange:${V} hls.loadLevel:${A}`)),F&&(this.firstSelection=ct),ct}}return-1}set nextAutoLevel(t){const{maxAutoLevel:i,minAutoLevel:s}=this.hls,r=Math.min(Math.max(t,s),i);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class kx{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var fe={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Nx{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(b.BUFFER_APPENDED,this.onBufferAppended,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this),t.on(b.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.BUFFER_APPENDED,this.onBufferAppended,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this),t.off(b.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,i){const s=this.activePartLists[i];if(s)for(let r=s.length;r--;){const o=s[r];if(!o)break;const u=o.end;if(o.start<=t&&u!==null&&t<=u)return o}return this.getBufferedFrag(t,i)}getBufferedFrag(t,i){const{fragments:s}=this,r=Object.keys(s);for(let o=r.length;o--;){const u=s[r[o]];if((u==null?void 0:u.body.type)===i&&u.buffered){const f=u.body;if(f.start<=t&&t<=f.end)return f}}return null}detectEvictedFragments(t,i,s,r){this.timeRanges&&(this.timeRanges[t]=i);const o=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(u=>{const f=this.fragments[u];if(!f||o>=f.body.sn)return;if(!f.buffered&&!f.loaded){f.body.type===s&&this.removeFragment(f.body);return}const h=f.range[t];h&&h.time.some(d=>{const g=!this.isTimeBuffered(d.startPTS,d.endPTS,i);return g&&this.removeFragment(f.body),g})})}detectPartialFragments(t){const i=this.timeRanges,{frag:s,part:r}=t;if(!i||s.sn==="initSegment")return;const o=Os(s),u=this.fragments[o];if(!u||u.buffered&&s.gap)return;const f=!s.relurl;Object.keys(i).forEach(h=>{const d=s.elementaryStreams[h];if(!d)return;const g=i[h],y=f||d.partial===!0;u.range[h]=this.getBufferedTimes(s,r,y,g)}),u.loaded=null,Object.keys(u.range).length?(u.buffered=!0,(u.body.endList=s.endList||u.body.endList)&&(this.endListFragments[u.body.type]=u),yl(u)||this.removeParts(s.sn-1,s.type)):this.removeFragment(u.body)}removeParts(t,i){const s=this.activePartLists[i];s&&(this.activePartLists[i]=s.filter(r=>r.fragment.sn>=t))}fragBuffered(t,i){const s=Os(t);let r=this.fragments[s];!r&&i&&(r=this.fragments[s]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(t,i,s,r){const o={time:[],partial:s},u=t.start,f=t.end,h=t.minEndPTS||f,d=t.maxStartPTS||u;for(let g=0;g<r.length;g++){const y=r.start(g)-this.bufferPadding,v=r.end(g)+this.bufferPadding;if(d>=y&&h<=v){o.time.push({startPTS:Math.max(u,r.start(g)),endPTS:Math.min(f,r.end(g))});break}else if(u<v&&f>y){const T=Math.max(u,r.start(g)),E=Math.min(f,r.end(g));E>T&&(o.partial=!0,o.time.push({startPTS:T,endPTS:E}))}else if(f<=y)break}return o}getPartialFragment(t){let i=null,s,r,o,u=0;const{bufferPadding:f,fragments:h}=this;return Object.keys(h).forEach(d=>{const g=h[d];g&&yl(g)&&(r=g.body.start-f,o=g.body.end+f,t>=r&&t<=o&&(s=Math.min(t-r,o-t),u<=s&&(i=g.body,u=s)))}),i}isEndListAppended(t){const i=this.endListFragments[t];return i!==void 0&&(i.buffered||yl(i))}getState(t){const i=Os(t),s=this.fragments[i];return s?s.buffered?yl(s)?fe.PARTIAL:fe.OK:fe.APPENDING:fe.NOT_LOADED}isTimeBuffered(t,i,s){let r,o;for(let u=0;u<s.length;u++){if(r=s.start(u)-this.bufferPadding,o=s.end(u)+this.bufferPadding,t>=r&&i<=o)return!0;if(i<=r)return!1}return!1}onFragLoaded(t,i){const{frag:s,part:r}=i;if(s.sn==="initSegment"||s.bitrateTest)return;const o=r?null:i,u=Os(s);this.fragments[u]={body:s,appendedPTS:null,loaded:o,buffered:!1,range:Object.create(null)}}onBufferAppended(t,i){const{frag:s,part:r,timeRanges:o}=i;if(s.sn==="initSegment")return;const u=s.type;if(r){let f=this.activePartLists[u];f||(this.activePartLists[u]=f=[]),f.push(r)}this.timeRanges=o,Object.keys(o).forEach(f=>{const h=o[f];this.detectEvictedFragments(f,h,u,r)})}onFragBuffered(t,i){this.detectPartialFragments(i)}hasFragment(t){const i=Os(t);return!!this.fragments[i]}hasParts(t){var i;return!!((i=this.activePartLists[t])!=null&&i.length)}removeFragmentsInRange(t,i,s,r,o){r&&!this.hasGaps||Object.keys(this.fragments).forEach(u=>{const f=this.fragments[u];if(!f)return;const h=f.body;h.type!==s||r&&!h.gap||h.start<i&&h.end>t&&(f.buffered||o)&&this.removeFragment(h)})}removeFragment(t){const i=Os(t);t.stats.loaded=0,t.clearElementaryStreamInfo();const s=this.activePartLists[t.type];if(s){const r=t.sn;this.activePartLists[t.type]=s.filter(o=>o.fragment.sn!==r)}delete this.fragments[i],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function yl(l){var t,i,s;return l.buffered&&(l.body.gap||((t=l.range.video)==null?void 0:t.partial)||((i=l.range.audio)==null?void 0:i.partial)||((s=l.range.audiovideo)==null?void 0:s.partial))}function Os(l){return`${l.type}_${l.level}_${l.sn}`}const Ux={length:0,start:()=>0,end:()=>0};class Ht{static isBuffered(t,i){try{if(t){const s=Ht.getBuffered(t);for(let r=0;r<s.length;r++)if(i>=s.start(r)&&i<=s.end(r))return!0}}catch{}return!1}static bufferInfo(t,i,s){try{if(t){const r=Ht.getBuffered(t),o=[];let u;for(u=0;u<r.length;u++)o.push({start:r.start(u),end:r.end(u)});return this.bufferedInfo(o,i,s)}}catch{}return{len:0,start:i,end:i,nextStart:void 0}}static bufferedInfo(t,i,s){i=Math.max(0,i),t.sort(function(d,g){const y=d.start-g.start;return y||g.end-d.end});let r=[];if(s)for(let d=0;d<t.length;d++){const g=r.length;if(g){const y=r[g-1].end;t[d].start-y<s?t[d].end>y&&(r[g-1].end=t[d].end):r.push(t[d])}else r.push(t[d])}else r=t;let o=0,u,f=i,h=i;for(let d=0;d<r.length;d++){const g=r[d].start,y=r[d].end;if(i+s>=g&&i<y)f=g,h=y,o=h-i;else if(i+s<g){u=g;break}}return{len:o,start:f||0,end:h||0,nextStart:u}}static getBuffered(t){try{return t.buffered}catch(i){return N.log("failed to get media.buffered",i),Ux}}}class pf{constructor(t,i,s,r=0,o=-1,u=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=vl(),this.buffering={audio:vl(),video:vl(),audiovideo:vl()},this.level=t,this.sn=i,this.id=s,this.size=r,this.part=o,this.partial=u}}function vl(){return{start:0,executeStart:0,executeEnd:0,end:0}}function _l(l,t){for(let s=0,r=l.length;s<r;s++){var i;if(((i=l[s])==null?void 0:i.cc)===t)return l[s]}return null}function Fx(l,t,i){return!!(t&&(i.endCC>i.startCC||l&&l.cc<i.startCC))}function Bx(l,t){const i=l.fragments,s=t.fragments;if(!s.length||!i.length){N.log("No fragments to align");return}const r=_l(i,s[0].cc);if(!r||r&&!r.startPTS){N.log("No frag in previous level to align on");return}return r}function Jm(l,t){if(l){const i=l.start+t;l.start=l.startPTS=i,l.endPTS=i+l.duration}}function hp(l,t){const i=t.fragments;for(let s=0,r=i.length;s<r;s++)Jm(i[s],l);t.fragmentHint&&Jm(t.fragmentHint,l),t.alignedSliding=!0}function Px(l,t,i){t&&(Gx(l,i,t),!i.alignedSliding&&t&&Vl(i,t),!i.alignedSliding&&t&&!i.skippedSegments&&lp(t,i))}function Gx(l,t,i){if(Fx(l,i,t)){const s=Bx(i,t);s&&ot(s.start)&&(N.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),hp(s.start,t))}}function Vl(l,t){if(!l.hasProgramDateTime||!t.hasProgramDateTime)return;const i=l.fragments,s=t.fragments;if(!i.length||!s.length)return;let r,o;const u=Math.min(t.endCC,l.endCC);t.startCC<u&&l.startCC<u&&(r=_l(s,u),o=_l(i,u)),(!r||!o)&&(r=s[Math.floor(s.length/2)],o=_l(i,r.cc)||i[Math.floor(i.length/2)]);const f=r.programDateTime,h=o.programDateTime;if(!f||!h)return;const d=(h-f)/1e3-(o.start-r.start);hp(d,l)}const tg=Math.pow(2,17);class $x{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,i){const s=t.url;if(!s)return Promise.reject(new Pi({type:Tt.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${s?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,o=r.fLoader,u=r.loader;return new Promise((f,h)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(T=>T[0]==="GAP")){h(ig(t));return}else t.gap=!1;const d=this.loader=t.loader=o?new o(r):new u(r),g=eg(t),y=Wm(r.fragLoadPolicy.default),v={loadPolicy:y,timeout:y.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:tg};t.stats=d.stats,d.load(g,v,{onSuccess:(T,E,x,A)=>{this.resetLoader(t,d);let R=T.data;x.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(R.slice(0,16)),R=R.slice(16)),f({frag:t,part:null,payload:R,networkDetails:A})},onError:(T,E,x,A)=>{this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:he({url:s,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:x,stats:A}))},onAbort:(T,E,x)=>{this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:x,stats:T}))},onTimeout:(T,E,x)=>{this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:x,stats:T}))},onProgress:(T,E,x,A)=>{i&&i({frag:t,part:null,payload:x,networkDetails:A})}})})}loadPart(t,i,s){this.abort();const r=this.config,o=r.fLoader,u=r.loader;return new Promise((f,h)=>{if(this.loader&&this.loader.destroy(),t.gap||i.gap){h(ig(t,i));return}const d=this.loader=t.loader=o?new o(r):new u(r),g=eg(t,i),y=Wm(r.fragLoadPolicy.default),v={loadPolicy:y,timeout:y.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:tg};i.stats=d.stats,d.load(g,v,{onSuccess:(T,E,x,A)=>{this.resetLoader(t,d),this.updateStatsFromPart(t,i);const R={frag:t,part:i,payload:T.data,networkDetails:A};s(R),f(R)},onError:(T,E,x,A)=>{this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:i,response:he({url:g.url,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:x,stats:A}))},onAbort:(T,E,x)=>{t.stats.aborted=i.stats.aborted,this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:t,part:i,error:new Error("Aborted"),networkDetails:x,stats:T}))},onTimeout:(T,E,x)=>{this.resetLoader(t,d),h(new Pi({type:Tt.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:i,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:x,stats:T}))}})})}updateStatsFromPart(t,i){const s=t.stats,r=i.stats,o=r.total;if(s.loaded+=r.loaded,o){const h=Math.round(t.duration/i.duration),d=Math.min(Math.round(s.loaded/o),h),y=(h-d)*Math.round(s.loaded/d);s.total=s.loaded+y}else s.total=Math.max(s.loaded,s.total);const u=s.loading,f=r.loading;u.start?u.first+=f.first-f.start:(u.start=f.start,u.first=f.first),u.end=f.end}resetLoader(t,i){t.loader=null,this.loader===i&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),i.destroy()}}function eg(l,t=null){const i=t||l,s={frag:l,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},r=i.byteRangeStartOffset,o=i.byteRangeEndOffset;if(ot(r)&&ot(o)){var u;let f=r,h=o;if(l.sn==="initSegment"&&((u=l.decryptdata)==null?void 0:u.method)==="AES-128"){const d=o-r;d%16&&(h=o+(16-d%16)),r!==0&&(s.resetIV=!0,f=r-16)}s.rangeStart=f,s.rangeEnd=h}return s}function ig(l,t){const i=new Error(`GAP ${l.gap?"tag":"attribute"} found`),s={type:Tt.MEDIA_ERROR,details:H.FRAG_GAP,fatal:!1,frag:l,error:i,networkDetails:null};return t&&(s.part=t),(t||l).stats.aborted=!0,new Pi(s)}class Pi extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class Hx{constructor(t,i){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=i}decrypt(t,i){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},i,t)}}class zx{constructor(t,i){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=i}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Vx(l){const t=l.byteLength,i=t&&new DataView(l.buffer).getUint8(t-1);return i?Vn(l,0,t-i):l}class Kx{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const i=new DataView(t),s=new Uint32Array(4);for(let r=0;r<4;r++)s[r]=i.getUint32(r*4);return s}initTable(){const t=this.sBox,i=this.invSBox,s=this.subMix,r=s[0],o=s[1],u=s[2],f=s[3],h=this.invSubMix,d=h[0],g=h[1],y=h[2],v=h[3],T=new Uint32Array(256);let E=0,x=0,A=0;for(A=0;A<256;A++)A<128?T[A]=A<<1:T[A]=A<<1^283;for(A=0;A<256;A++){let R=x^x<<1^x<<2^x<<3^x<<4;R=R>>>8^R&255^99,t[E]=R,i[R]=E;const O=T[E],_=T[O],F=T[_];let I=T[R]*257^R*16843008;r[E]=I<<24|I>>>8,o[E]=I<<16|I>>>16,u[E]=I<<8|I>>>24,f[E]=I,I=F*16843009^_*65537^O*257^E*16843008,d[R]=I<<24|I>>>8,g[R]=I<<16|I>>>16,y[R]=I<<8|I>>>24,v[R]=I,E?(E=O^T[T[T[F^O]]],x^=T[T[x]]):E=x=1}}expandKey(t){const i=this.uint8ArrayToUint32Array_(t);let s=!0,r=0;for(;r<i.length&&s;)s=i[r]===this.key[r],r++;if(s)return;this.key=i;const o=this.keySize=i.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const u=this.ksRows=(o+6+1)*4;let f,h;const d=this.keySchedule=new Uint32Array(u),g=this.invKeySchedule=new Uint32Array(u),y=this.sBox,v=this.rcon,T=this.invSubMix,E=T[0],x=T[1],A=T[2],R=T[3];let O,_;for(f=0;f<u;f++){if(f<o){O=d[f]=i[f];continue}_=O,f%o===0?(_=_<<8|_>>>24,_=y[_>>>24]<<24|y[_>>>16&255]<<16|y[_>>>8&255]<<8|y[_&255],_^=v[f/o|0]<<24):o>6&&f%o===4&&(_=y[_>>>24]<<24|y[_>>>16&255]<<16|y[_>>>8&255]<<8|y[_&255]),d[f]=O=(d[f-o]^_)>>>0}for(h=0;h<u;h++)f=u-h,h&3?_=d[f]:_=d[f-4],h<4||f<=4?g[h]=_:g[h]=E[y[_>>>24]]^x[y[_>>>16&255]]^A[y[_>>>8&255]]^R[y[_&255]],g[h]=g[h]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,i,s){const r=this.keySize+6,o=this.invKeySchedule,u=this.invSBox,f=this.invSubMix,h=f[0],d=f[1],g=f[2],y=f[3],v=this.uint8ArrayToUint32Array_(s);let T=v[0],E=v[1],x=v[2],A=v[3];const R=new Int32Array(t),O=new Int32Array(R.length);let _,F,I,V,G,Q,z,P,J,gt,rt,mt,ct,q;const lt=this.networkToHostOrderSwap;for(;i<R.length;){for(J=lt(R[i]),gt=lt(R[i+1]),rt=lt(R[i+2]),mt=lt(R[i+3]),G=J^o[0],Q=mt^o[1],z=rt^o[2],P=gt^o[3],ct=4,q=1;q<r;q++)_=h[G>>>24]^d[Q>>16&255]^g[z>>8&255]^y[P&255]^o[ct],F=h[Q>>>24]^d[z>>16&255]^g[P>>8&255]^y[G&255]^o[ct+1],I=h[z>>>24]^d[P>>16&255]^g[G>>8&255]^y[Q&255]^o[ct+2],V=h[P>>>24]^d[G>>16&255]^g[Q>>8&255]^y[z&255]^o[ct+3],G=_,Q=F,z=I,P=V,ct=ct+4;_=u[G>>>24]<<24^u[Q>>16&255]<<16^u[z>>8&255]<<8^u[P&255]^o[ct],F=u[Q>>>24]<<24^u[z>>16&255]<<16^u[P>>8&255]<<8^u[G&255]^o[ct+1],I=u[z>>>24]<<24^u[P>>16&255]<<16^u[G>>8&255]<<8^u[Q&255]^o[ct+2],V=u[P>>>24]<<24^u[G>>16&255]<<16^u[Q>>8&255]<<8^u[z&255]^o[ct+3],O[i]=lt(_^T),O[i+1]=lt(V^E),O[i+2]=lt(I^x),O[i+3]=lt(F^A),T=J,E=gt,x=rt,A=mt,i=i+4}return O.buffer}}const Yx=16;class yf{constructor(t,{removePKCS7Padding:i=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=i,i)try{const s=self.crypto;s&&(this.subtle=s.subtle||s.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:i}=this;if(!t||i)return this.reset(),null;const s=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?Vx(s):s}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,i,s){return this.useSoftware?new Promise((r,o)=>{this.softwareDecrypt(new Uint8Array(t),i,s);const u=this.flush();u?r(u.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),i,s)}softwareDecrypt(t,i,s){const{currentIV:r,currentResult:o,remainderData:u}=this;this.logOnce("JS AES decrypt"),u&&(t=Xe(u,t),this.remainderData=null);const f=this.getValidChunk(t);if(!f.length)return null;r&&(s=r);let h=this.softwareDecrypter;h||(h=this.softwareDecrypter=new Kx),h.expandKey(i);const d=o;return this.currentResult=h.decrypt(f.buffer,0,s),this.currentIV=Vn(f,-16).buffer,d||null}webCryptoDecrypt(t,i,s){if(this.key!==i||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,i,s));this.key=i,this.fastAesKey=new zx(this.subtle,i)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Hx(this.subtle,new Uint8Array(s)).decrypt(t.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(N.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(t,i,s)))}onWebCryptoError(t,i,s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,i,s);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let i=t;const s=t.length-t.length%Yx;return s!==t.length&&(i=Vn(t,0,s),this.remainderData=Vn(t,s)),i}logOnce(t){this.logEnabled&&(N.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const qx={toString:function(l){let t="";const i=l.length;for(let s=0;s<i;s++)t+=`[${l.start(s).toFixed(3)}-${l.end(s).toFixed(3)}]`;return t}},Z={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class vf extends kx{constructor(t,i,s,r,o){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Z.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=o,this.logPrefix=r,this.log=N.log.bind(N,`${r}:`),this.warn=N.warn.bind(N,`${r}:`),this.hls=t,this.fragmentLoader=new $x(t.config),this.keyLoader=s,this.fragmentTracker=i,this.config=t.config,this.decrypter=new yf(t.config),t.on(b.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Z.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(t,i){if(i.live||t.nextStart||!t.end||!this.media)return!1;const s=i.partList;if(s!=null&&s.length){const o=s[s.length-1];return Ht.isBuffered(this.media,o.start+o.duration/2)}const r=i.fragments[i.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var t;return(t=this.levelLastLoaded)==null?void 0:t.details}}onMediaAttached(t,i){const s=this.media=this.mediaBuffer=i.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),s.addEventListener("seeking",this.onvseeking),s.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===Z.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const t=this.media;t!=null&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:i,media:s,mediaBuffer:r,state:o}=this,u=s?s.currentTime:0,f=Ht.bufferInfo(r||s,u,t.maxBufferHole);if(this.log(`media seeking to ${ot(u)?u.toFixed(3):u}, state: ${o}`),this.state===Z.ENDED)this.resetLoadingState();else if(i){const h=t.maxFragLookUpTolerance,d=i.start-h,g=i.start+i.duration+h;if(!f.len||g<f.start||d>f.end){const y=u>g;(u<d||y)&&(y&&i.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),i.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}s&&(this.fragmentTracker.removeFragmentsInRange(u,1/0,this.playlistType,!0),this.lastCurrentTime=u),!this.loadedmetadata&&!f.len&&(this.nextLoadPosition=this.startPosition=u),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,i){this.startTimeOffset=i.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Z.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,i,s){this._loadFragForPlayback(t,i,s)}_loadFragForPlayback(t,i,s){const r=o=>{if(this.fragContextChanged(t)){this.warn(`Fragment ${t.sn}${o.part?" p: "+o.part.index:""} of level ${t.level} was dropped during download.`),this.fragmentTracker.removeFragment(t);return}t.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(t,i,s,r).then(o=>{if(!o)return;const u=this.state;if(this.fragContextChanged(t)){(u===Z.FRAG_LOADING||!this.fragCurrent&&u===Z.PARSING)&&(this.fragmentTracker.removeFragment(t),this.state=Z.IDLE);return}"payload"in o&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(b.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===Z.STOPPED||this.state===Z.ERROR||(this.warn(`Frag error: ${(o==null?void 0:o.message)||o}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var i;const{fragmentTracker:s}=this;if(s.getState(t)===fe.APPENDING){const o=t.type,u=this.getFwdBufferInfo(this.mediaBuffer,o),f=Math.max(t.duration,u?u.len:this.config.maxBufferLength),h=this.backtrackFragment;((h?t.sn-h.sn:0)===1||this.reduceMaxBufferLength(f,t.duration))&&s.removeFragment(t)}else((i=this.mediaBuffer)==null?void 0:i.buffered.length)===0?s.removeAllFragments():s.hasParts(t.type)&&(s.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),s.getState(t)===fe.PARTIAL&&s.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const i=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:i,part:null,stats:i.stats,id:i.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,i,s=null){if(!(t-i))return;const r={startOffset:t,endOffset:i,type:s};this.hls.trigger(b.BUFFER_FLUSHING,r)}_loadInitSegment(t,i){this._doFragLoad(t,i).then(s=>{if(!s||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return s}).then(s=>{const{hls:r}=this,{payload:o}=s,u=t.decryptdata;if(o&&o.byteLength>0&&u!=null&&u.key&&u.iv&&u.method==="AES-128"){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),u.key.buffer,u.iv.buffer).catch(h=>{throw r.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:t}),h}).then(h=>{const d=self.performance.now();return r.trigger(b.FRAG_DECRYPTED,{frag:t,payload:h,stats:{tstart:f,tdecrypt:d}}),s.payload=h,this.completeInitSegmentLoad(s)})}return this.completeInitSegmentLoad(s)}).catch(s=>{this.state===Z.STOPPED||this.state===Z.ERROR||(this.warn(s),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:i}=this;if(!i)throw new Error("init load aborted, missing levels");const s=t.frag.stats;this.state=Z.IDLE,t.frag.data=new Uint8Array(t.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){const{fragCurrent:i}=this;return!t||!i||t.sn!==i.sn||t.level!==i.level}fragBufferedComplete(t,i){var s,r,o,u;const f=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${i?" part: "+i.index:""} of ${this.playlistType===vt.MAIN?"level":"track"} ${t.level} (frag:[${((s=t.startPTS)!=null?s:NaN).toFixed(3)}-${((r=t.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${f?qx.toString(Ht.getBuffered(f)):"(detached)"})`),t.sn!=="initSegment"){var h;if(t.type!==vt.SUBTITLE){const g=t.elementaryStreams;if(!Object.keys(g).some(y=>!!g[y])){this.state=Z.IDLE;return}}const d=(h=this.levels)==null?void 0:h[t.level];d!=null&&d.fragmentError&&(this.log(`Resetting level fragment error count of ${d.fragmentError} on frag buffered`),d.fragmentError=0)}this.state=Z.IDLE,f&&(!this.loadedmetadata&&t.type==vt.MAIN&&f.buffered.length&&((o=this.fragCurrent)==null?void 0:o.sn)===((u=this.fragPrevious)==null?void 0:u.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){const{transmuxer:i}=this;if(!i)return;const{frag:s,part:r,partsLoaded:o}=t,u=!o||o.length===0||o.some(h=>!h),f=new pf(s.level,s.sn,s.stats.chunkCount+1,0,r?r.index:-1,!u);i.flush(f)}_handleFragmentLoadProgress(t){}_doFragLoad(t,i,s=null,r){var o;const u=i==null?void 0:i.details;if(!this.levels||!u)throw new Error(`frag load aborted, missing level${u?"":" detail"}s`);let f=null;if(t.encrypted&&!((o=t.decryptdata)!=null&&o.key)?(this.log(`Loading key for ${t.sn} of [${u.startSN}-${u.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${t.level}`),this.state=Z.KEY_LOADING,this.fragCurrent=t,f=this.keyLoader.load(t).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(b.KEY_LOADED,g),this.state===Z.KEY_LOADING&&(this.state=Z.IDLE),g}),this.hls.trigger(b.KEY_LOADING,{frag:t}),this.fragCurrent===null&&(f=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!t.encrypted&&u.encryptedFragments.length&&this.keyLoader.loadClear(t,u.encryptedFragments),s=Math.max(t.start,s||0),this.config.lowLatencyMode&&t.sn!=="initSegment"){const g=u.partList;if(g&&r){s>t.end&&u.fragmentHint&&(t=u.fragmentHint);const y=this.getNextPart(g,t,s);if(y>-1){const v=g[y];this.log(`Loading part sn: ${t.sn} p: ${v.index} cc: ${t.cc} of playlist [${u.startSN}-${u.endSN}] parts [0-${y}-${g.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(s.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=Z.FRAG_LOADING;let T;return f?T=f.then(E=>!E||this.fragContextChanged(E.frag)?null:this.doFragPartsLoad(t,v,i,r)).catch(E=>this.handleFragLoadError(E)):T=this.doFragPartsLoad(t,v,i,r).catch(E=>this.handleFragLoadError(E)),this.hls.trigger(b.FRAG_LOADING,{frag:t,part:v,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):T}else if(!t.url||this.loadedEndOfParts(g,s))return Promise.resolve(null)}}this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${u?"of ["+u.startSN+"-"+u.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(s.toFixed(3))}`),ot(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=Z.FRAG_LOADING;const h=this.config.progressive;let d;return h&&f?d=f.then(g=>!g||this.fragContextChanged(g==null?void 0:g.frag)?null:this.fragmentLoader.load(t,r)).catch(g=>this.handleFragLoadError(g)):d=Promise.all([this.fragmentLoader.load(t,h?r:void 0),f]).then(([g])=>(!h&&g&&r&&r(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(b.FRAG_LOADING,{frag:t,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(t,i,s,r){return new Promise((o,u)=>{var f;const h=[],d=(f=s.details)==null?void 0:f.partList,g=y=>{this.fragmentLoader.loadPart(t,y,r).then(v=>{h[y.index]=v;const T=v.part;this.hls.trigger(b.FRAG_LOADED,v);const E=jm(s,t.sn,y.index+1)||op(d,t.sn,y.index+1);if(E)g(E);else return o({frag:t,part:T,partsLoaded:h})}).catch(u)};g(i)})}handleFragLoadError(t){if("data"in t){const i=t.data;t.data&&i.details===H.INTERNAL_ABORTED?this.handleFragLoadAborted(i.frag,i.part):this.hls.trigger(b.ERROR,i)}else this.hls.trigger(b.ERROR,{type:Tt.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const i=this.getCurrentContext(t);if(!i||this.state!==Z.PARSING){!this.fragCurrent&&this.state!==Z.STOPPED&&this.state!==Z.ERROR&&(this.state=Z.IDLE);return}const{frag:s,part:r,level:o}=i,u=self.performance.now();s.stats.parsing.end=u,r&&(r.stats.parsing.end=u),this.updateLevelTiming(s,r,o,t.partial)}getCurrentContext(t){const{levels:i,fragCurrent:s}=this,{level:r,sn:o,part:u}=t;if(!(i!=null&&i[r]))return this.warn(`Levels object was unset while buffering fragment ${o} of level ${r}. The current chunk will not be buffered.`),null;const f=i[r],h=u>-1?jm(f,o,u):null,d=h?h.fragment:gx(f,o,s);return d?(s&&s!==d&&(d.stats=s.stats),{frag:d,part:h,level:f}):null}bufferFragmentData(t,i,s,r,o){var u;if(!t||this.state!==Z.PARSING)return;const{data1:f,data2:h}=t;let d=f;if(f&&h&&(d=Xe(f,h)),!((u=d)!=null&&u.length))return;const g={type:t.type,frag:i,part:s,chunkMeta:r,parent:i.type,data:d};if(this.hls.trigger(b.BUFFER_APPENDING,g),t.dropped&&t.independent&&!s){if(o)return;this.flushBufferGap(i)}}flushBufferGap(t){const i=this.media;if(!i)return;if(!Ht.isBuffered(i,i.currentTime)){this.flushMainBuffer(0,t.start);return}const s=i.currentTime,r=Ht.bufferInfo(i,s,0),o=t.duration,u=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),f=Math.max(Math.min(t.start-u,r.end-u),s+u);t.start-f>u&&this.flushMainBuffer(f,t.start)}getFwdBufferInfo(t,i){const s=this.getLoadPosition();return ot(s)?this.getFwdBufferInfoAtPos(t,s,i):null}getFwdBufferInfoAtPos(t,i,s){const{config:{maxBufferHole:r}}=this,o=Ht.bufferInfo(t,i,r);if(o.len===0&&o.nextStart!==void 0){const u=this.fragmentTracker.getBufferedFrag(i,s);if(u&&o.nextStart<u.end)return Ht.bufferInfo(t,i,Math.max(o.nextStart,r))}return o}getMaxBufferLength(t){const{config:i}=this;let s;return t?s=Math.max(8*i.maxBufferSize/t,i.maxBufferLength):s=i.maxBufferLength,Math.min(s,i.maxMaxBufferLength)}reduceMaxBufferLength(t,i){const s=this.config,r=Math.max(Math.min(t-i,s.maxBufferLength),i),o=Math.max(t-i*3,s.maxMaxBufferLength/2,r);return o>=r?(s.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(t,i=vt.MAIN){const s=this.fragmentTracker.getAppendedFrag(t,vt.MAIN);return s&&"fragment"in s?s.fragment:s}getNextFragment(t,i){const s=i.fragments,r=s.length;if(!r)return null;const{config:o}=this,u=s[0].start;let f;if(i.live){const h=o.initialLiveManifestSize;if(r<h)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${h})`),null;(!i.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<u)&&(f=this.getInitialLiveFragment(i,s),this.startPosition=this.nextLoadPosition=f?this.hls.liveSyncPosition||f.start:t)}else t<=u&&(f=s[0]);if(!f){const h=o.lowLatencyMode?i.partEnd:i.fragmentEnd;f=this.getFragmentAtPosition(t,h,i)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(t,i){const s=this.fragmentTracker.getState(t);return(s===fe.OK||s===fe.PARTIAL&&!!t.gap)&&this.nextLoadPosition>i}getNextFragmentLoopLoading(t,i,s,r,o){const u=t.gap,f=this.getNextFragment(this.nextLoadPosition,i);if(f===null)return f;if(t=f,u&&t&&!t.gap&&s.nextStart){const h=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,s.nextStart,r);if(h!==null&&s.len+h.len>=o)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${t.sn}`),null}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!(t!=null&&t.initSegment.data)&&!this.bitrateTest?t.initSegment:t}getNextPart(t,i,s){let r=-1,o=!1,u=!0;for(let f=0,h=t.length;f<h;f++){const d=t[f];if(u=u&&!d.independent,r>-1&&s<d.start)break;const g=d.loaded;g?r=-1:(o||d.independent||u)&&d.fragment===i&&(r=f),o=g}return r}loadedEndOfParts(t,i){const s=t[t.length-1];return s&&i>s.start&&s.loaded}getInitialLiveFragment(t,i){const s=this.fragPrevious;let r=null;if(s){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${s.programDateTime}`),r=yx(i,s.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const o=s.sn+1;if(o>=t.startSN&&o<=t.endSN){const u=i[o-t.startSN];s.cc===u.cc&&(r=u,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=Tx(i,s.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(r=this.getFragmentAtPosition(o,this.bitrateTest?t.fragmentEnd:t.edge,t))}return r}getFragmentAtPosition(t,i,s){const{config:r}=this;let{fragPrevious:o}=this,{fragments:u,endSN:f}=s;const{fragmentHint:h}=s,{maxFragLookUpTolerance:d}=r,g=s.partList,y=!!(r.lowLatencyMode&&g!=null&&g.length&&h);y&&h&&!this.bitrateTest&&(u=u.concat(h),f=h.sn);let v;if(t<i){const T=t>i-d?0:d;v=zl(o,u,t,T)}else v=u[u.length-1];if(v){const T=v.sn-s.startSN,E=this.fragmentTracker.getState(v);if((E===fe.OK||E===fe.PARTIAL&&v.gap)&&(o=v),o&&v.sn===o.sn&&(!y||g[0].fragment.sn>v.sn)&&o&&v.level===o.level){const A=u[T+1];v.sn<f&&this.fragmentTracker.getState(A)!==fe.OK?v=A:v=null}}return v}synchronizeToLiveEdge(t){const{config:i,media:s}=this;if(!s)return;const r=this.hls.liveSyncPosition,o=s.currentTime,u=t.fragments[0].start,f=t.edge,h=o>=u-i.maxFragLookUpTolerance&&o<=f;if(r!==null&&s.duration>r&&(o<r||!h)){const d=i.liveMaxLatencyDuration!==void 0?i.liveMaxLatencyDuration:i.liveMaxLatencyDurationCount*t.targetduration;(!h&&s.readyState<4||o<f-d)&&(this.loadedmetadata||(this.nextLoadPosition=r),s.readyState&&(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${f}, reset currentTime to : ${r.toFixed(3)}`),s.currentTime=r))}}alignPlaylists(t,i,s){const r=t.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const o=t.fragments[0].start,u=!i,f=t.alignedSliding&&ot(o);if(u||!f&&!o){const{fragPrevious:h}=this;Px(h,s,t);const d=t.fragments[0].start;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${i?i.startSN:"na"}->${t.startSN} prev-sn: ${h?h.sn:"na"} fragments: ${r}`),d}return o}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*3)}setStartPosition(t,i){let s=this.startPosition;if(s<i&&(s=-1),s===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,o=r?this.startTimeOffset:t.startTimeOffset;o!==null&&ot(o)?(s=i+o,o<0&&(s+=t.totalduration),s=Math.min(Math.max(i,s),i+t.totalduration),this.log(`Start time offset ${o} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${s}`),this.startPosition=s):t.live?s=this.hls.liveSyncPosition||i:this.startPosition=s=0,this.lastCurrentTime=s}this.nextLoadPosition=s}getLoadPosition(){const{media:t}=this;let i=0;return this.loadedmetadata&&t?i=t.currentTime:this.nextLoadPosition&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,i){this.transmuxer&&t.sn!=="initSegment"&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${i?" part "+i.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==Z.FRAG_LOADING_WAITING_RETRY)&&(this.state=Z.IDLE)}onFragmentOrKeyLoadError(t,i){if(i.chunkMeta&&!i.frag){const g=this.getCurrentContext(i.chunkMeta);g&&(i.frag=g.frag)}const s=i.frag;if(!s||s.type!==t||!this.levels)return;if(this.fragContextChanged(s)){var r;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const o=i.details===H.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(s,!0);const u=i.errorAction,{action:f,retryCount:h=0,retryConfig:d}=u||{};if(u&&f===pe.RetryRequest&&d){this.resetStartWhenNotLoaded(this.levelLastLoaded);const g=mf(d,h);this.warn(`Fragment ${s.sn} of ${t} ${s.level} errored with ${i.details}, retrying loading ${h+1}/${d.maxNumRetry} in ${g}ms`),u.resolved=!0,this.retryDate=self.performance.now()+g,this.state=Z.FRAG_LOADING_WAITING_RETRY}else if(d&&u)if(this.resetFragmentErrors(t),h<d.maxNumRetry)!o&&f!==pe.RemoveAlternatePermanently&&(u.resolved=!0);else{N.warn(`${i.details} reached or exceeded max retry (${h})`);return}else(u==null?void 0:u.action)===pe.SendAlternateToPenaltyBox?this.state=Z.WAITING_LEVEL:this.state=Z.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===Z.PARSING||this.state===Z.PARSED){const i=t.frag,s=t.parent,r=this.getFwdBufferInfo(this.mediaBuffer,s),o=r&&r.len>.5;o&&this.reduceMaxBufferLength(r.len,(i==null?void 0:i.duration)||10);const u=!o;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${s} buffer`),i&&(this.fragmentTracker.removeFragment(i),this.nextLoadPosition=i.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(t){t===vt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Z.STOPPED&&(this.state=Z.IDLE)}afterBufferFlushed(t,i,s){if(!t)return;const r=Ht.getBuffered(t);this.fragmentTracker.detectEvictedFragments(i,r,s),this.state===Z.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Z.IDLE}resetStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const i=t?t.details:null;i!=null&&i.live?(this.startPosition=-1,this.setStartPosition(i,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,i,s,r){var o;const u=s.details;if(!u){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((h,d)=>{const g=t.elementaryStreams[d];if(g){const y=g.endPTS-g.startPTS;if(y<=0)return this.warn(`Could not parse fragment ${t.sn} ${d} duration reliably (${y})`),h||!1;const v=r?0:ap(u,t,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(b.LEVEL_PTS_UPDATED,{details:u,level:s,drift:v,type:d,frag:t,start:g.startPTS,end:g.endPTS}),!0}return h},!1)&&((o=this.transmuxer)==null?void 0:o.error)===null){const h=new Error(`Found no media in fragment ${t.sn} of level ${t.level} resetting transmuxer to fallback to playlist timing`);if(s.fragmentError===0&&(s.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)),this.warn(h.message),this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:h,frag:t,reason:`Found no media in msn ${t.sn} of level "${s.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Z.PARSED,this.hls.trigger(b.FRAG_PARSED,{frag:t,part:i})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){const i=this._state;i!==t&&(this._state=t,this.log(`${i}->${t}`))}get state(){return this._state}}class dp{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:i}=this;let s;if(t.length)t.length===1?s=t[0]:s=jx(t,i);else return new Uint8Array(0);return this.reset(),s}reset(){this.chunks.length=0,this.dataLength=0}}function jx(l,t){const i=new Uint8Array(t);let s=0;for(let r=0;r<l.length;r++){const o=l[r];i.set(o,s),s+=o.length}return i}function Xx(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Wx(){const l=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(l);return{worker:new self.Worker(t),objectURL:t}}function Qx(l){const t=new self.URL(l,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}function hi(l="",t=9e4){return{type:l,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Ef{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,i,s,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,i){return!1}appendFrame(t,i,s){}demux(t,i){this.cachedData&&(t=Xe(this.cachedData,t),this.cachedData=null);let s=Vr(t,0),r=s?s.length:0,o;const u=this._audioTrack,f=this._id3Track,h=s?df(s):void 0,d=t.length;for((this.basePTS===null||this.frameIndex===0&&ot(h))&&(this.basePTS=Zx(h,i,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),s&&s.length>0&&f.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ii.audioId3,duration:Number.POSITIVE_INFINITY});r<d;){if(this.canParse(t,r)){const g=this.appendFrame(u,t,r);g?(this.frameIndex++,this.lastPTS=g.sample.pts,r+=g.length,o=r):r=d}else ES(t,r)?(s=Vr(t,r),f.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ii.audioId3,duration:Number.POSITIVE_INFINITY}),r+=s.length,o=r):r++;if(r===d&&o!==d){const g=Vn(t,o);this.cachedData?this.cachedData=Xe(this.cachedData,g):this.cachedData=g}}return{audioTrack:u,videoTrack:hi(),id3Track:f,textTrack:hi()}}demuxSampleAes(t,i,s){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const i=this.cachedData;return i&&(this.cachedData=null,this.demux(i,0)),{audioTrack:this._audioTrack,videoTrack:hi(),id3Track:this._id3Track,textTrack:hi()}}destroy(){}}const Zx=(l,t,i)=>{if(ot(l))return l*90;const s=i?i.baseTime*9e4/i.timescale:0;return t*9e4+s};function Jx(l,t,i,s){let r,o,u,f;const h=navigator.userAgent.toLowerCase(),d=s,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((t[i+2]&192)>>>6)+1;const y=(t[i+2]&60)>>>2;if(y>g.length-1){const v=new Error(`invalid ADTS sampling index:${y}`);l.emit(b.ERROR,b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}return u=(t[i+2]&1)<<2,u|=(t[i+3]&192)>>>6,N.log(`manifest codec:${s}, ADTS type:${r}, samplingIndex:${y}`),/firefox/i.test(h)?y>=6?(r=5,f=new Array(4),o=y-3):(r=2,f=new Array(2),o=y):h.indexOf("android")!==-1?(r=2,f=new Array(2),o=y):(r=5,f=new Array(4),s&&(s.indexOf("mp4a.40.29")!==-1||s.indexOf("mp4a.40.5")!==-1)||!s&&y>=6?o=y-3:((s&&s.indexOf("mp4a.40.2")!==-1&&(y>=6&&u===1||/vivaldi/i.test(h))||!s&&u===1)&&(r=2,f=new Array(2)),o=y)),f[0]=r<<3,f[0]|=(y&14)>>1,f[1]|=(y&1)<<7,f[1]|=u<<3,r===5&&(f[1]|=(o&14)>>1,f[2]=(o&1)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:g[y],channelCount:u,codec:"mp4a.40."+r,manifestCodec:d}}function mp(l,t){return l[t]===255&&(l[t+1]&246)===240}function gp(l,t){return l[t+1]&1?7:9}function Tf(l,t){return(l[t+3]&3)<<11|l[t+4]<<3|(l[t+5]&224)>>>5}function tA(l,t){return t+5<l.length}function Kl(l,t){return t+1<l.length&&mp(l,t)}function eA(l,t){return tA(l,t)&&mp(l,t)&&Tf(l,t)<=l.length-t}function iA(l,t){if(Kl(l,t)){const i=gp(l,t);if(t+i>=l.length)return!1;const s=Tf(l,t);if(s<=i)return!1;const r=t+s;return r===l.length||Kl(l,r)}return!1}function pp(l,t,i,s,r){if(!l.samplerate){const o=Jx(t,i,s,r);if(!o)return;l.config=o.config,l.samplerate=o.samplerate,l.channelCount=o.channelCount,l.codec=o.codec,l.manifestCodec=o.manifestCodec,N.log(`parsed codec:${l.codec}, rate:${o.samplerate}, channels:${o.channelCount}`)}}function yp(l){return 1024*9e4/l}function nA(l,t){const i=gp(l,t);if(t+i<=l.length){const s=Tf(l,t)-i;if(s>0)return{headerLength:i,frameLength:s}}}function vp(l,t,i,s,r){const o=yp(l.samplerate),u=s+r*o,f=nA(t,i);let h;if(f){const{frameLength:y,headerLength:v}=f,T=v+y,E=Math.max(0,i+T-t.length);E?(h=new Uint8Array(T-v),h.set(t.subarray(i+v,t.length),0)):h=t.subarray(i+v,i+T);const x={unit:h,pts:u};return E||l.samples.push(x),{sample:x,length:T,missing:E}}const d=t.length-i;return h=new Uint8Array(d),h.set(t.subarray(i,t.length),0),{sample:{unit:h,pts:u},length:d,missing:-1}}let El=null;const sA=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],rA=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],aA=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],lA=[0,1,1,4];function Ep(l,t,i,s,r){if(i+24>t.length)return;const o=Tp(t,i);if(o&&i+o.frameLength<=t.length){const u=o.samplesPerFrame*9e4/o.sampleRate,f=s+r*u,h={unit:t.subarray(i,i+o.frameLength),pts:f,dts:f};return l.config=[],l.channelCount=o.channelCount,l.samplerate=o.sampleRate,l.samples.push(h),{sample:h,length:o.frameLength,missing:0}}}function Tp(l,t){const i=l[t+1]>>3&3,s=l[t+1]>>1&3,r=l[t+2]>>4&15,o=l[t+2]>>2&3;if(i!==1&&r!==0&&r!==15&&o!==3){const u=l[t+2]>>1&1,f=l[t+3]>>6,h=i===3?3-s:s===3?3:4,d=sA[h*14+r-1]*1e3,y=rA[(i===3?0:i===2?1:2)*3+o],v=f===3?1:2,T=aA[i][s],E=lA[s],x=T*8*E,A=Math.floor(T*d/y+u)*E;if(El===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);El=_?parseInt(_[1]):0}return!!El&&El<=87&&s===2&&d>=224e3&&f===0&&(l[t+3]=l[t+3]|128),{sampleRate:y,channelCount:v,frameLength:A,samplesPerFrame:x}}}function Sf(l,t){return l[t]===255&&(l[t+1]&224)===224&&(l[t+1]&6)!==0}function Sp(l,t){return t+1<l.length&&Sf(l,t)}function oA(l,t){return Sf(l,t)&&4<=l.length-t}function xp(l,t){if(t+1<l.length&&Sf(l,t)){const s=Tp(l,t);let r=4;s!=null&&s.frameLength&&(r=s.frameLength);const o=t+r;return o===l.length||Sp(l,o)}return!1}class uA extends Ef{constructor(t,i){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=i}resetInitSegment(t,i,s,r){super.resetInitSegment(t,i,s,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:i,duration:r,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const i=Vr(t,0);let s=(i==null?void 0:i.length)||0;if(xp(t,s))return!1;for(let r=t.length;s<r;s++)if(iA(t,s))return N.log("ADTS sync word found !"),!0;return!1}canParse(t,i){return eA(t,i)}appendFrame(t,i,s){pp(t,this.observer,i,s,t.manifestCodec);const r=vp(t,i,s,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const cA=/\/emsg[-/]ID3/i;class fA{constructor(t,i){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=i}resetTimeStamp(){}resetInitSegment(t,i,s,r){const o=this.videoTrack=hi("video",1),u=this.audioTrack=hi("audio",1),f=this.txtTrack=hi("text",1);if(this.id3Track=hi("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const h=Zg(t);if(h.video){const{id:d,timescale:g,codec:y}=h.video;o.id=d,o.timescale=f.timescale=g,o.codec=y}if(h.audio){const{id:d,timescale:g,codec:y}=h.audio;u.id=d,u.timescale=g,u.codec=y}f.id=Xg.text,o.sampleDuration=0,o.duration=u.duration=r}resetContiguity(){this.remainderData=null}static probe(t){return CS(t)}demux(t,i){this.timeOffset=i;let s=t;const r=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(s=Xe(this.remainderData,t));const f=US(s);this.remainderData=f.remainder,r.samples=f.valid||new Uint8Array}else r.samples=s;const u=this.extractID3Track(r,i);return o.samples=_m(i,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:u,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,i=this.videoTrack,s=this.txtTrack;i.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(i,this.timeOffset);return s.samples=_m(t,i),{videoTrack:i,audioTrack:hi(),id3Track:r,textTrack:hi()}}extractID3Track(t,i){const s=this.id3Track;if(t.samples.length){const r=xt(t.samples,["emsg"]);r&&r.forEach(o=>{const u=PS(o);if(cA.test(u.schemeIdUri)){const f=ot(u.presentationTime)?u.presentationTime/u.timeScale:i+u.presentationTimeDelta/u.timeScale;let h=u.eventDuration===4294967295?Number.POSITIVE_INFINITY:u.eventDuration/u.timeScale;h<=.001&&(h=Number.POSITIVE_INFINITY);const d=u.payload;s.samples.push({data:d,len:d.byteLength,dts:f,pts:f,type:ii.emsg,duration:h})}})}return s}demuxSampleAes(t,i,s){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Ap=(l,t)=>{let i=0,s=5;t+=s;const r=new Uint32Array(1),o=new Uint32Array(1),u=new Uint8Array(1);for(;s>0;){u[0]=l[t];const f=Math.min(s,8),h=8-f;o[0]=4278190080>>>24+h<<h,r[0]=(u[0]&o[0])>>h,i=i?i<<f|r[0]:r[0],t+=1,s-=f}return i};class hA extends Ef{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,i,s,r){super.resetInitSegment(t,i,s,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:i,duration:r,inputTimeScale:9e4,dropped:0}}canParse(t,i){return i+64<t.length}appendFrame(t,i,s){const r=bp(t,i,s,this.basePTS,this.frameIndex);if(r!==-1)return{sample:t.samples[t.samples.length-1],length:r,missing:0}}static probe(t){if(!t)return!1;const i=Vr(t,0);if(!i)return!1;const s=i.length;return t[s]===11&&t[s+1]===119&&df(i)!==void 0&&Ap(t,s)<16}}function bp(l,t,i,s,r){if(i+8>t.length||t[i]!==11||t[i+1]!==119)return-1;const o=t[i+4]>>6;if(o>=3)return-1;const f=[48e3,44100,32e3][o],h=t[i+4]&63,g=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][h*3+o]*2;if(i+g>t.length)return-1;const y=t[i+6]>>5;let v=0;y===2?v+=2:(y&1&&y!==1&&(v+=2),y&4&&(v+=2));const T=(t[i+6]<<8|t[i+7])>>12-v&1,x=[2,1,2,3,3,4,4,5][y]+T,A=t[i+5]>>3,R=t[i+5]&7,O=new Uint8Array([o<<6|A<<1|R>>2,(R&3)<<6|y<<3|T<<2|h>>4,h<<4&224]),_=1536/f*9e4,F=s+r*_,I=t.subarray(i,i+g);return l.config=O,l.channelCount=x,l.samplerate=f,l.samples.push({unit:I,pts:F}),g}class dA{constructor(){this.VideoSample=null}createVideoSample(t,i,s,r){return{key:t,frame:!1,pts:i,dts:s,units:[],debug:r,length:0}}getLastNalUnit(t){var i;let s=this.VideoSample,r;if((!s||s.units.length===0)&&(s=t[t.length-1]),(i=s)!=null&&i.units){const o=s.units;r=o[o.length-1]}return r}pushAccessUnit(t,i){if(t.units.length&&t.frame){if(t.pts===void 0){const s=i.samples,r=s.length;if(r){const o=s[r-1];t.pts=o.pts,t.dts=o.dts}else{i.dropped++;return}}i.samples.push(t)}t.debug.length&&N.log(t.pts+"/"+t.dts+":"+t.debug)}}class ng{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,i=this.bytesAvailable,s=t.byteLength-i,r=new Uint8Array(4),o=Math.min(4,i);if(o===0)throw new Error("no bytes available");r.set(t.subarray(s,s+o)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(t){let i;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,i=t>>3,t-=i<<3,this.bytesAvailable-=i,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let i=Math.min(this.bitsAvailable,t);const s=this.word>>>32-i;if(t>32&&N.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=i,this.bitsAvailable>0)this.word<<=i;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return i=t-i,i>0&&this.bitsAvailable?s<<i|this.readBits(i):s}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(this.word&2147483648>>>t)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let i=8,s=8,r;for(let o=0;o<t;o++)s!==0&&(r=this.readEG(),s=(i+r+256)%256),i=s===0?i:s}readSPS(){let t=0,i=0,s=0,r=0,o,u,f;const h=this.readUByte.bind(this),d=this.readBits.bind(this),g=this.readUEG.bind(this),y=this.readBoolean.bind(this),v=this.skipBits.bind(this),T=this.skipEG.bind(this),E=this.skipUEG.bind(this),x=this.skipScalingList.bind(this);h();const A=h();if(d(5),v(3),h(),E(),A===100||A===110||A===122||A===244||A===44||A===83||A===86||A===118||A===128){const V=g();if(V===3&&v(1),E(),E(),v(1),y())for(u=V!==3?8:12,f=0;f<u;f++)y()&&(f<6?x(16):x(64))}E();const R=g();if(R===0)g();else if(R===1)for(v(1),T(),T(),o=g(),f=0;f<o;f++)T();E(),v(1);const O=g(),_=g(),F=d(1);F===0&&v(1),v(1),y()&&(t=g(),i=g(),s=g(),r=g());let I=[1,1];if(y()&&y())switch(h()){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:{I=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((O+1)*16-t*2-i*2),height:(2-F)*(_+1)*16-(F?2:4)*(s+r),pixelRatio:I}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class mA extends dA{parseAVCPES(t,i,s,r,o){const u=this.parseAVCNALu(t,s.data);let f=this.VideoSample,h,d=!1;s.data=null,f&&u.length&&!t.audFound&&(this.pushAccessUnit(f,t),f=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts,"")),u.forEach(g=>{var y;switch(g.type){case 1:{let x=!1;h=!0;const A=g.data;if(d&&A.length>4){const R=new ng(A).readSliceType();(R===2||R===4||R===7||R===9)&&(x=!0)}if(x){var v;(v=f)!=null&&v.frame&&!f.key&&(this.pushAccessUnit(f,t),f=this.VideoSample=null)}f||(f=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts,"")),f.frame=!0,f.key=x;break}case 5:h=!0,(y=f)!=null&&y.frame&&!f.key&&(this.pushAccessUnit(f,t),f=this.VideoSample=null),f||(f=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts,"")),f.key=!0,f.frame=!0;break;case 6:{h=!0,tp(g.data,1,s.pts,i.samples);break}case 7:{var T,E;h=!0,d=!0;const x=g.data,R=new ng(x).readSPS();if(!t.sps||t.width!==R.width||t.height!==R.height||((T=t.pixelRatio)==null?void 0:T[0])!==R.pixelRatio[0]||((E=t.pixelRatio)==null?void 0:E[1])!==R.pixelRatio[1]){t.width=R.width,t.height=R.height,t.pixelRatio=R.pixelRatio,t.sps=[x],t.duration=o;const O=x.subarray(1,4);let _="avc1.";for(let F=0;F<3;F++){let I=O[F].toString(16);I.length<2&&(I="0"+I),_+=I}t.codec=_}break}case 8:h=!0,t.pps=[g.data];break;case 9:h=!0,t.audFound=!0,f&&this.pushAccessUnit(f,t),f=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts,"");break;case 12:h=!0;break;default:h=!1,f&&(f.debug+="unknown NAL "+g.type+" ");break}f&&h&&f.units.push(g)}),r&&f&&(this.pushAccessUnit(f,t),this.VideoSample=null)}parseAVCNALu(t,i){const s=i.byteLength;let r=t.naluState||0;const o=r,u=[];let f=0,h,d,g,y=-1,v=0;for(r===-1&&(y=0,v=i[0]&31,r=0,f=1);f<s;){if(h=i[f++],!r){r=h?0:1;continue}if(r===1){r=h?0:2;continue}if(!h)r=3;else if(h===1){if(d=f-r-1,y>=0){const T={data:i.subarray(y,d),type:v};u.push(T)}else{const T=this.getLastNalUnit(t.samples);T&&(o&&f<=4-o&&T.state&&(T.data=T.data.subarray(0,T.data.byteLength-o)),d>0&&(T.data=Xe(T.data,i.subarray(0,d)),T.state=0))}f<s?(g=i[f]&31,y=f,v=g,r=0):r=-1}else r=0}if(y>=0&&r>=0){const T={data:i.subarray(y,s),type:v,state:r};u.push(T)}if(u.length===0){const T=this.getLastNalUnit(t.samples);T&&(T.data=Xe(T.data,i))}return t.naluState=r,u}}class gA{constructor(t,i,s){this.keyData=void 0,this.decrypter=void 0,this.keyData=s,this.decrypter=new yf(i,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(t,i,s){const r=t[i].unit;if(r.length<=16)return;const o=r.subarray(16,r.length-r.length%16),u=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(u).then(f=>{const h=new Uint8Array(f);r.set(h,16),this.decrypter.isSync()||this.decryptAacSamples(t,i+1,s)})}decryptAacSamples(t,i,s){for(;;i++){if(i>=t.length){s();return}if(!(t[i].unit.length<32)&&(this.decryptAacSample(t,i,s),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const i=Math.floor((t.length-48)/160)*16+16,s=new Int8Array(i);let r=0;for(let o=32;o<t.length-16;o+=160,r+=16)s.set(t.subarray(o,o+16),r);return s}getAvcDecryptedUnit(t,i){const s=new Uint8Array(i);let r=0;for(let o=32;o<t.length-16;o+=160,r+=16)t.set(s.subarray(r,r+16),o);return t}decryptAvcSample(t,i,s,r,o){const u=ep(o.data),f=this.getAvcEncryptedData(u);this.decryptBuffer(f.buffer).then(h=>{o.data=this.getAvcDecryptedUnit(u,h),this.decrypter.isSync()||this.decryptAvcSamples(t,i,s+1,r)})}decryptAvcSamples(t,i,s,r){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;i++,s=0){if(i>=t.length){r();return}const o=t[i].units;for(;!(s>=o.length);s++){const u=o[s];if(!(u.data.length<=48||u.type!==1&&u.type!==5)&&(this.decryptAvcSample(t,i,s,r,u),!this.decrypter.isSync()))return}}}}const ce=188;class gn{constructor(t,i,s){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=i,this.typeSupported=s,this.videoParser=new mA}static probe(t){const i=gn.syncOffset(t);return i>0&&N.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(t){const i=t.length;let s=Math.min(ce*5,i-ce)+1,r=0;for(;r<s;){let o=!1,u=-1,f=0;for(let h=r;h<i;h+=ce)if(t[h]===71&&(i-h===ce||t[h+ce]===71)){if(f++,u===-1&&(u=h,u!==0&&(s=Math.min(u+ce*99,t.length-ce)+1)),o||(o=Xc(t,h)===0),o&&f>1&&(u===0&&f>2||h+ce>s))return u}else{if(f)return-1;break}r++}return-1}static createTrack(t,i){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:Xg[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?i:void 0}}resetInitSegment(t,i,s,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=gn.createTrack("video"),this._audioTrack=gn.createTrack("audio",r),this._id3Track=gn.createTrack("id3"),this._txtTrack=gn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=i,this.videoCodec=s,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:i,_id3Track:s}=this;t&&(t.pesData=null),i&&(i.pesData=null),s&&(s.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,i,s=!1,r=!1){s||(this.sampleAes=null);let o;const u=this._videoTrack,f=this._audioTrack,h=this._id3Track,d=this._txtTrack;let g=u.pid,y=u.pesData,v=f.pid,T=h.pid,E=f.pesData,x=h.pesData,A=null,R=this.pmtParsed,O=this._pmtId,_=t.length;if(this.remainderData&&(t=Xe(this.remainderData,t),_=t.length,this.remainderData=null),_<ce&&!r)return this.remainderData=t,{audioTrack:f,videoTrack:u,id3Track:h,textTrack:d};const F=Math.max(0,gn.syncOffset(t));_-=(_-F)%ce,_<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,_,t.buffer.byteLength-_));let I=0;for(let G=F;G<_;G+=ce)if(t[G]===71){const Q=!!(t[G+1]&64),z=Xc(t,G),P=(t[G+3]&48)>>4;let J;if(P>1){if(J=G+5+t[G+4],J===G+ce)continue}else J=G+4;switch(z){case g:Q&&(y&&(o=Is(y))&&this.videoParser.parseAVCPES(u,d,o,!1,this._duration),y={data:[],size:0}),y&&(y.data.push(t.subarray(J,G+ce)),y.size+=G+ce-J);break;case v:if(Q){if(E&&(o=Is(E)))switch(f.segmentCodec){case"aac":this.parseAACPES(f,o);break;case"mp3":this.parseMPEGPES(f,o);break;case"ac3":this.parseAC3PES(f,o);break}E={data:[],size:0}}E&&(E.data.push(t.subarray(J,G+ce)),E.size+=G+ce-J);break;case T:Q&&(x&&(o=Is(x))&&this.parseID3PES(h,o),x={data:[],size:0}),x&&(x.data.push(t.subarray(J,G+ce)),x.size+=G+ce-J);break;case 0:Q&&(J+=t[J]+1),O=this._pmtId=pA(t,J);break;case O:{Q&&(J+=t[J]+1);const gt=yA(t,J,this.typeSupported,s,this.observer);g=gt.videoPid,g>0&&(u.pid=g,u.segmentCodec=gt.segmentVideoCodec),v=gt.audioPid,v>0&&(f.pid=v,f.segmentCodec=gt.segmentAudioCodec),T=gt.id3Pid,T>0&&(h.pid=T),A!==null&&!R&&(N.warn(`MPEG-TS PMT found at ${G} after unknown PID '${A}'. Backtracking to sync byte @${F} to parse all TS packets.`),A=null,G=F-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:A=z;break}}else I++;I>0&&Yl(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`)),u.pesData=y,f.pesData=E,h.pesData=x;const V={audioTrack:f,videoTrack:u,id3Track:h,textTrack:d};return r&&this.extractRemainingSamples(V),V}flush(){const{remainderData:t}=this;this.remainderData=null;let i;return t?i=this.demux(t,-1,!1,!0):i={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(i),this.sampleAes?this.decrypt(i,this.sampleAes):i}extractRemainingSamples(t){const{audioTrack:i,videoTrack:s,id3Track:r,textTrack:o}=t,u=s.pesData,f=i.pesData,h=r.pesData;let d;if(u&&(d=Is(u))?(this.videoParser.parseAVCPES(s,o,d,!0,this._duration),s.pesData=null):s.pesData=u,f&&(d=Is(f))){switch(i.segmentCodec){case"aac":this.parseAACPES(i,d);break;case"mp3":this.parseMPEGPES(i,d);break;case"ac3":this.parseAC3PES(i,d);break}i.pesData=null}else f!=null&&f.size&&N.log("last AAC PES packet truncated,might overlap between fragments"),i.pesData=f;h&&(d=Is(h))?(this.parseID3PES(r,d),r.pesData=null):r.pesData=h}demuxSampleAes(t,i,s){const r=this.demux(t,s,!0,!this.config.progressive),o=this.sampleAes=new gA(this.observer,this.config,i);return this.decrypt(r,o)}decrypt(t,i){return new Promise(s=>{const{audioTrack:r,videoTrack:o}=t;r.samples&&r.segmentCodec==="aac"?i.decryptAacSamples(r.samples,0,()=>{o.samples?i.decryptAvcSamples(o.samples,0,0,()=>{s(t)}):s(t)}):o.samples&&i.decryptAvcSamples(o.samples,0,0,()=>{s(t)})})}destroy(){this._duration=0}parseAACPES(t,i){let s=0;const r=this.aacOverFlow;let o=i.data;if(r){this.aacOverFlow=null;const y=r.missing,v=r.sample.unit.byteLength;if(y===-1)o=Xe(r.sample.unit,o);else{const T=v-y;r.sample.unit.set(o.subarray(0,y),T),t.samples.push(r.sample),s=r.missing}}let u,f;for(u=s,f=o.length;u<f-1&&!Kl(o,u);u++);if(u!==s){let y;const v=u<f-1;if(v?y=`AAC PES did not start with ADTS header,offset:${u}`:y="No ADTS header found in AAC PES",Yl(this.observer,new Error(y),v),!v)return}pp(t,this.observer,o,u,this.audioCodec);let h;if(i.pts!==void 0)h=i.pts;else if(r){const y=yp(t.samplerate);h=r.sample.pts+y}else{N.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,g;for(;u<f;)if(g=vp(t,o,u,h,d),u+=g.length,g.missing){this.aacOverFlow=g;break}else for(d++;u<f-1&&!Kl(o,u);u++);}parseMPEGPES(t,i){const s=i.data,r=s.length;let o=0,u=0;const f=i.pts;if(f===void 0){N.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;u<r;)if(Sp(s,u)){const h=Ep(t,s,u,f,o);if(h)u+=h.length,o++;else break}else u++}parseAC3PES(t,i){{const s=i.data,r=i.pts;if(r===void 0){N.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=s.length;let u=0,f=0,h;for(;f<o&&(h=bp(t,s,f,r,u++))>0;)f+=h}}parseID3PES(t,i){if(i.pts===void 0){N.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const s=ie({},i,{type:this._videoTrack?ii.emsg:ii.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(s)}}function Xc(l,t){return((l[t+1]&31)<<8)+l[t+2]}function pA(l,t){return(l[t+10]&31)<<8|l[t+11]}function yA(l,t,i,s,r){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(l[t+1]&15)<<8|l[t+2],f=t+3+u-4,h=(l[t+10]&15)<<8|l[t+11];for(t+=12+h;t<f;){const d=Xc(l,t),g=(l[t+3]&15)<<8|l[t+4];switch(l[t]){case 207:if(!s){Dc("ADTS AAC");break}case 15:o.audioPid===-1&&(o.audioPid=d);break;case 21:o.id3Pid===-1&&(o.id3Pid=d);break;case 219:if(!s){Dc("H.264");break}case 27:o.videoPid===-1&&(o.videoPid=d,o.segmentVideoCodec="avc");break;case 3:case 4:!i.mpeg&&!i.mp3?N.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="mp3");break;case 193:if(!s){Dc("AC-3");break}case 129:i.ac3?o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="ac3"):N.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&g>0){let y=t+5,v=g;for(;v>2;){switch(l[y]){case 106:i.ac3!==!0?N.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=d,o.segmentAudioCodec="ac3");break}const E=l[y+1]+2;y+=E,v-=E}}break;case 194:case 135:return Yl(r,new Error("Unsupported EC-3 in M2TS found")),o;case 36:return Yl(r,new Error("Unsupported HEVC in M2TS found")),o}t+=g+5}return o}function Yl(l,t,i){N.warn(`parsing error: ${t.message}`),l.emit(b.ERROR,b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,levelRetry:i,error:t,reason:t.message})}function Dc(l){N.log(`${l} with AES-128-CBC encryption found in unencrypted stream`)}function Is(l){let t=0,i,s,r,o,u;const f=l.data;if(!l||l.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=Xe(f[0],f[1]),f.splice(1,1);if(i=f[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(s=(i[4]<<8)+i[5],s&&s>l.size-6)return null;const d=i[7];d&192&&(o=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,d&64?(u=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,o-u>60*9e4&&(N.warn(`${Math.round((o-u)/9e4)}s delta between PTS and DTS, align them`),o=u)):u=o),r=i[8];let g=r+9;if(l.size<=g)return null;l.size-=g;const y=new Uint8Array(l.size);for(let v=0,T=f.length;v<T;v++){i=f[v];let E=i.byteLength;if(g)if(g>E){g-=E;continue}else i=i.subarray(g),E-=g,g=0;y.set(i,t),t+=E}return s&&(s-=r+3),{data:y,pts:o,dts:u,len:s}}return null}class vA extends Ef{resetInitSegment(t,i,s,r){super.resetInitSegment(t,i,s,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:i,duration:r,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const i=Vr(t,0);let s=(i==null?void 0:i.length)||0;if(i&&t[s]===11&&t[s+1]===119&&df(i)!==void 0&&Ap(t,s)<=16)return!1;for(let r=t.length;s<r;s++)if(xp(t,s))return N.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,i){return oA(t,i)}appendFrame(t,i,s){if(this.basePTS!==null)return Ep(t,i,s,this.basePTS,this.frameIndex)}}class sg{static getSilentFrame(t,i){switch(t){case"mp4a.40.2":if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const mn=Math.pow(2,32)-1;class B{static init(){B.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in B.types)B.types.hasOwnProperty(t)&&(B.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);B.HDLR_TYPES={video:i,audio:s};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);B.STTS=B.STSC=B.STCO=o,B.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),B.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),B.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),B.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const u=new Uint8Array([105,115,111,109]),f=new Uint8Array([97,118,99,49]),h=new Uint8Array([0,0,0,1]);B.FTYP=B.box(B.types.ftyp,u,h,u,f),B.DINF=B.box(B.types.dinf,B.box(B.types.dref,r))}static box(t,...i){let s=8,r=i.length;const o=r;for(;r--;)s+=i[r].byteLength;const u=new Uint8Array(s);for(u[0]=s>>24&255,u[1]=s>>16&255,u[2]=s>>8&255,u[3]=s&255,u.set(t,4),r=0,s=8;r<o;r++)u.set(i[r],s),s+=i[r].byteLength;return u}static hdlr(t){return B.box(B.types.hdlr,B.HDLR_TYPES[t])}static mdat(t){return B.box(B.types.mdat,t)}static mdhd(t,i){i*=t;const s=Math.floor(i/(mn+1)),r=Math.floor(i%(mn+1));return B.box(B.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,s>>24,s>>16&255,s>>8&255,s&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(t){return B.box(B.types.mdia,B.mdhd(t.timescale,t.duration),B.hdlr(t.type),B.minf(t))}static mfhd(t){return B.box(B.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?B.box(B.types.minf,B.box(B.types.smhd,B.SMHD),B.DINF,B.stbl(t)):B.box(B.types.minf,B.box(B.types.vmhd,B.VMHD),B.DINF,B.stbl(t))}static moof(t,i,s){return B.box(B.types.moof,B.mfhd(t),B.traf(s,i))}static moov(t){let i=t.length;const s=[];for(;i--;)s[i]=B.trak(t[i]);return B.box.apply(null,[B.types.moov,B.mvhd(t[0].timescale,t[0].duration)].concat(s).concat(B.mvex(t)))}static mvex(t){let i=t.length;const s=[];for(;i--;)s[i]=B.trex(t[i]);return B.box.apply(null,[B.types.mvex,...s])}static mvhd(t,i){i*=t;const s=Math.floor(i/(mn+1)),r=Math.floor(i%(mn+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,s>>24,s>>16&255,s>>8&255,s&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return B.box(B.types.mvhd,o)}static sdtp(t){const i=t.samples||[],s=new Uint8Array(4+i.length);let r,o;for(r=0;r<i.length;r++)o=i[r].flags,s[r+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return B.box(B.types.sdtp,s)}static stbl(t){return B.box(B.types.stbl,B.stsd(t),B.box(B.types.stts,B.STTS),B.box(B.types.stsc,B.STSC),B.box(B.types.stsz,B.STSZ),B.box(B.types.stco,B.STCO))}static avc1(t){let i=[],s=[],r,o,u;for(r=0;r<t.sps.length;r++)o=t.sps[r],u=o.byteLength,i.push(u>>>8&255),i.push(u&255),i=i.concat(Array.prototype.slice.call(o));for(r=0;r<t.pps.length;r++)o=t.pps[r],u=o.byteLength,s.push(u>>>8&255),s.push(u&255),s=s.concat(Array.prototype.slice.call(o));const f=B.box(B.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(s))),h=t.width,d=t.height,g=t.pixelRatio[0],y=t.pixelRatio[1];return B.box(B.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,B.box(B.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),B.box(B.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,y>>24,y>>16&255,y>>8&255,y&255])))}static esds(t){const i=t.config.length;return new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(t.config).concat([6,1,2]))}static audioStsd(t){const i=t.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,i&255,0,0])}static mp4a(t){return B.box(B.types.mp4a,B.audioStsd(t),B.box(B.types.esds,B.esds(t)))}static mp3(t){return B.box(B.types[".mp3"],B.audioStsd(t))}static ac3(t){return B.box(B.types["ac-3"],B.audioStsd(t),B.box(B.types.dac3,t.config))}static stsd(t){return t.type==="audio"?t.segmentCodec==="mp3"&&t.codec==="mp3"?B.box(B.types.stsd,B.STSD,B.mp3(t)):t.segmentCodec==="ac3"?B.box(B.types.stsd,B.STSD,B.ac3(t)):B.box(B.types.stsd,B.STSD,B.mp4a(t)):B.box(B.types.stsd,B.STSD,B.avc1(t))}static tkhd(t){const i=t.id,s=t.duration*t.timescale,r=t.width,o=t.height,u=Math.floor(s/(mn+1)),f=Math.floor(s%(mn+1));return B.box(B.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,f>>24,f>>16&255,f>>8&255,f&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,o>>8&255,o&255,0,0]))}static traf(t,i){const s=B.sdtp(t),r=t.id,o=Math.floor(i/(mn+1)),u=Math.floor(i%(mn+1));return B.box(B.types.traf,B.box(B.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),B.box(B.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255])),B.trun(t,s.length+16+20+8+16+8+8),s)}static trak(t){return t.duration=t.duration||4294967295,B.box(B.types.trak,B.tkhd(t),B.mdia(t))}static trex(t){const i=t.id;return B.box(B.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,i){const s=t.samples||[],r=s.length,o=12+16*r,u=new Uint8Array(o);let f,h,d,g,y,v;for(i+=8+o,u.set([t.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255],0),f=0;f<r;f++)h=s[f],d=h.duration,g=h.size,y=h.flags,v=h.cts,u.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,y.isLeading<<2|y.dependsOn,y.isDependedOn<<6|y.hasRedundancy<<4|y.paddingValue<<1|y.isNonSync,y.degradPrio&61440,y.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*f);return B.box(B.types.trun,u)}static initSegment(t){B.types||B.init();const i=B.moov(t);return Xe(B.FTYP,i)}}B.types=void 0;B.HDLR_TYPES=void 0;B.STTS=void 0;B.STSC=void 0;B.STCO=void 0;B.STSZ=void 0;B.VMHD=void 0;B.SMHD=void 0;B.STSD=void 0;B.FTYP=void 0;B.DINF=void 0;const Rp=9e4;function xf(l,t,i=1,s=!1){const r=l*t*i;return s?Math.round(r):r}function EA(l,t,i=1,s=!1){return xf(l,t,1/i,s)}function $r(l,t=!1){return xf(l,1e3,1/Rp,t)}function TA(l,t=1){return xf(l,Rp,1/t)}const SA=10*1e3,rg=1024,xA=1152,AA=1536;let ws=null,Cc=null;class Ol{constructor(t,i,s,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=i,this.typeSupported=s,this.ISGenerated=!1,ws===null){const u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ws=u?parseInt(u[1]):0}if(Cc===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Cc=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){N.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){N.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){N.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let i=!1;const s=t[0].pts,r=t.reduce((o,u)=>{let f=u.pts,h=f-o;return h<-4294967296&&(i=!0,f=je(f,s),h=f-o),h>0?o:f},s);return i&&N.debug("PTS rollover detected"),r}remux(t,i,s,r,o,u,f,h){let d,g,y,v,T,E,x=o,A=o;const R=t.pid>-1,O=i.pid>-1,_=i.samples.length,F=t.samples.length>0,I=f&&_>0||_>1;if((!R||F)&&(!O||I)||this.ISGenerated||f){if(this.ISGenerated){var G,Q,z,P;const mt=this.videoTrackConfig;mt&&(i.width!==mt.width||i.height!==mt.height||((G=i.pixelRatio)==null?void 0:G[0])!==((Q=mt.pixelRatio)==null?void 0:Q[0])||((z=i.pixelRatio)==null?void 0:z[1])!==((P=mt.pixelRatio)==null?void 0:P[1]))&&this.resetInitSegment()}else y=this.generateIS(t,i,o,u);const J=this.isVideoContiguous;let gt=-1,rt;if(I&&(gt=bA(i.samples),!J&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,gt>0){N.warn(`[mp4-remuxer]: Dropped ${gt} out of ${_} video samples due to a missing keyframe`);const mt=this.getVideoStartPts(i.samples);i.samples=i.samples.slice(gt),i.dropped+=gt,A+=(i.samples[0].pts-mt)/i.inputTimeScale,rt=A}else gt===-1&&(N.warn(`[mp4-remuxer]: No keyframe found out of ${_} video samples`),E=!1);if(this.ISGenerated){if(F&&I){const mt=this.getVideoStartPts(i.samples),q=(je(t.samples[0].pts,mt)-mt)/i.inputTimeScale;x+=Math.max(0,q),A+=Math.max(0,-q)}if(F){if(t.samplerate||(N.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),y=this.generateIS(t,i,o,u)),g=this.remuxAudio(t,x,this.isAudioContiguous,u,O||I||h===vt.AUDIO?A:void 0),I){const mt=g?g.endPTS-g.startPTS:0;i.inputTimeScale||(N.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),y=this.generateIS(t,i,o,u)),d=this.remuxVideo(i,A,J,mt)}}else I&&(d=this.remuxVideo(i,A,J,0));d&&(d.firstKeyFrame=gt,d.independent=gt!==-1,d.firstKeyFramePTS=rt)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(s.samples.length&&(T=Lp(s,o,this._initPTS,this._initDTS)),r.samples.length&&(v=Dp(r,o,this._initPTS))),{audio:g,video:d,initSegment:y,independent:E,text:v,id3:T}}generateIS(t,i,s,r){const o=t.samples,u=i.samples,f=this.typeSupported,h={},d=this._initPTS;let g=!d||r,y="audio/mp4",v,T,E;if(g&&(v=T=1/0),t.config&&o.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":f.mpeg?(y="audio/mpeg",t.codec=""):f.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}h.audio={id:"audio",container:y,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&f.mpeg?new Uint8Array(0):B.initSegment([t]),metadata:{channelCount:t.channelCount}},g&&(E=t.inputTimeScale,!d||E!==d.timescale?v=T=o[0].pts-Math.round(E*s):g=!1)}if(i.sps&&i.pps&&u.length){if(i.timescale=i.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:i.codec,initSegment:B.initSegment([i]),metadata:{width:i.width,height:i.height}},g)if(E=i.inputTimeScale,!d||E!==d.timescale){const x=this.getVideoStartPts(u),A=Math.round(E*s);T=Math.min(T,je(u[0].dts,x)-A),v=Math.min(v,x-A)}else g=!1;this.videoTrackConfig={width:i.width,height:i.height,pixelRatio:i.pixelRatio}}if(Object.keys(h).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:v,timescale:E},this._initDTS={baseTime:T,timescale:E}):v=E=void 0,{tracks:h,initPTS:v,timescale:E}}remuxVideo(t,i,s,r){const o=t.inputTimeScale,u=t.samples,f=[],h=u.length,d=this._initPTS;let g=this.nextAvcDts,y=8,v=this.videoSampleDuration,T,E,x=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,R=!1;if(!s||g===null){const et=i*o,D=u[0].pts-je(u[0].dts,u[0].pts);ws&&g!==null&&Math.abs(et-D-g)<15e3?s=!0:g=et-D}const O=d.baseTime*o/d.timescale;for(let et=0;et<h;et++){const D=u[et];D.pts=je(D.pts-O,g),D.dts=je(D.dts-O,g),D.dts<u[et>0?et-1:et].dts&&(R=!0)}R&&u.sort(function(et,D){const K=et.dts-D.dts,it=et.pts-D.pts;return K||it}),T=u[0].dts,E=u[u.length-1].dts;const _=E-T,F=_?Math.round(_/(h-1)):v||t.inputTimeScale/30;if(s){const et=T-g,D=et>F,K=et<-1;if((D||K)&&(D?N.warn(`AVC: ${$r(et,!0)} ms (${et}dts) hole between fragments detected at ${i.toFixed(3)}`):N.warn(`AVC: ${$r(-et,!0)} ms (${et}dts) overlapping between fragments detected at ${i.toFixed(3)}`),!K||g>=u[0].pts||ws)){T=g;const it=u[0].pts-et;if(D)u[0].dts=T,u[0].pts=it;else for(let st=0;st<u.length&&!(u[st].dts>it);st++)u[st].dts-=et,u[st].pts-=et;N.log(`Video: Initial PTS/DTS adjusted: ${$r(it,!0)}/${$r(T,!0)}, delta: ${$r(et,!0)} ms`)}}T=Math.max(0,T);let I=0,V=0,G=T;for(let et=0;et<h;et++){const D=u[et],K=D.units,it=K.length;let st=0;for(let nt=0;nt<it;nt++)st+=K[nt].data.length;V+=st,I+=it,D.length=st,D.dts<G?(D.dts=G,G+=F/4|0||1):G=D.dts,x=Math.min(D.pts,x),A=Math.max(D.pts,A)}E=u[h-1].dts;const Q=V+4*I+8;let z;try{z=new Uint8Array(Q)}catch(et){this.observer.emit(b.ERROR,b.ERROR,{type:Tt.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:et,bytes:Q,reason:`fail allocating video mdat ${Q}`});return}const P=new DataView(z.buffer);P.setUint32(0,Q),z.set(B.types.mdat,4);let J=!1,gt=Number.POSITIVE_INFINITY,rt=Number.POSITIVE_INFINITY,mt=Number.NEGATIVE_INFINITY,ct=Number.NEGATIVE_INFINITY;for(let et=0;et<h;et++){const D=u[et],K=D.units;let it=0;for(let pt=0,ht=K.length;pt<ht;pt++){const Ut=K[pt],Dt=Ut.data,zt=Ut.data.byteLength;P.setUint32(y,zt),y+=4,z.set(Dt,y),y+=zt,it+=4+zt}let st;if(et<h-1)v=u[et+1].dts-D.dts,st=u[et+1].pts-D.pts;else{const pt=this.config,ht=et>0?D.dts-u[et-1].dts:F;if(st=et>0?D.pts-u[et-1].pts:F,pt.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ut=Math.floor(pt.maxBufferHole*o),Dt=(r?x+r*o:this.nextAudioPts)-D.pts;Dt>Ut?(v=Dt-ht,v<0?v=ht:J=!0,N.log(`[mp4-remuxer]: It is approximately ${Dt/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=ht}else v=ht}const nt=Math.round(D.pts-D.dts);gt=Math.min(gt,v),mt=Math.max(mt,v),rt=Math.min(rt,st),ct=Math.max(ct,st),f.push(new ag(D.key,v,it,nt))}if(f.length){if(ws){if(ws<70){const et=f[0].flags;et.dependsOn=2,et.isNonSync=0}}else if(Cc&&ct-rt<mt-gt&&F/mt<.025&&f[0].cts===0){N.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let et=T;for(let D=0,K=f.length;D<K;D++){const it=et+f[D].duration,st=et+f[D].cts;if(D<K-1){const nt=it+f[D+1].cts;f[D].duration=nt-st}else f[D].duration=D?f[D-1].duration:F;f[D].cts=0,et=it}}}v=J||!v?F:v,this.nextAvcDts=g=E+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const at={data1:B.moof(t.sequenceNumber++,T,ie({},t,{samples:f})),data2:z,startPTS:x/o,endPTS:(A+v)/o,startDTS:T/o,endDTS:g/o,type:"video",hasAudio:!1,hasVideo:!0,nb:f.length,dropped:t.dropped};return t.samples=[],t.dropped=0,at}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return xA;case"ac3":return AA;default:return rg}}remuxAudio(t,i,s,r,o){const u=t.inputTimeScale,f=t.samplerate?t.samplerate:u,h=u/f,d=this.getSamplesPerFrame(t),g=d*h,y=this._initPTS,v=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,T=[],E=o!==void 0;let x=t.samples,A=v?0:8,R=this.nextAudioPts||-1;const O=i*u,_=y.baseTime*u/y.timescale;if(this.isAudioContiguous=s=s||x.length&&R>0&&(r&&Math.abs(O-R)<9e3||Math.abs(je(x[0].pts-_,O)-R)<20*g),x.forEach(function(q){q.pts=je(q.pts-_,O)}),!s||R<0){if(x=x.filter(q=>q.pts>=0),!x.length)return;o===0?R=0:r&&!E?R=Math.max(0,O):R=x[0].pts}if(t.segmentCodec==="aac"){const q=this.config.maxAudioFramesDrift;for(let lt=0,at=R;lt<x.length;lt++){const et=x[lt],D=et.pts,K=D-at,it=Math.abs(1e3*K/u);if(K<=-q*g&&E)lt===0&&(N.warn(`Audio frame @ ${(D/u).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*K/u)} ms.`),this.nextAudioPts=R=at=D);else if(K>=q*g&&it<SA&&E){let st=Math.round(K/g);at=D-st*g,at<0&&(st--,at+=g),lt===0&&(this.nextAudioPts=R=at),N.warn(`[mp4-remuxer]: Injecting ${st} audio frame @ ${(at/u).toFixed(3)}s due to ${Math.round(1e3*K/u)} ms gap.`);for(let nt=0;nt<st;nt++){const pt=Math.max(at,0);let ht=sg.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);ht||(N.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ht=et.unit.subarray()),x.splice(lt,0,{unit:ht,pts:pt}),at+=g,lt++}}et.pts=at,at+=g}}let F=null,I=null,V,G=0,Q=x.length;for(;Q--;)G+=x[Q].unit.byteLength;for(let q=0,lt=x.length;q<lt;q++){const at=x[q],et=at.unit;let D=at.pts;if(I!==null){const it=T[q-1];it.duration=Math.round((D-I)/h)}else if(s&&t.segmentCodec==="aac"&&(D=R),F=D,G>0){G+=A;try{V=new Uint8Array(G)}catch(it){this.observer.emit(b.ERROR,b.ERROR,{type:Tt.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:it,bytes:G,reason:`fail allocating audio mdat ${G}`});return}v||(new DataView(V.buffer).setUint32(0,G),V.set(B.types.mdat,4))}else return;V.set(et,A);const K=et.byteLength;A+=K,T.push(new ag(!0,d,K,0)),I=D}const z=T.length;if(!z)return;const P=T[T.length-1];this.nextAudioPts=R=I+h*P.duration;const J=v?new Uint8Array(0):B.moof(t.sequenceNumber++,F/h,ie({},t,{samples:T}));t.samples=[];const gt=F/u,rt=R/u,ct={data1:J,data2:V,startPTS:gt,endPTS:rt,startDTS:gt,endDTS:rt,type:"audio",hasAudio:!0,hasVideo:!1,nb:z};return this.isAudioContiguous=!0,ct}remuxEmptyAudio(t,i,s,r){const o=t.inputTimeScale,u=t.samplerate?t.samplerate:o,f=o/u,h=this.nextAudioPts,d=this._initDTS,g=d.baseTime*9e4/d.timescale,y=(h!==null?h:r.startDTS*o)+g,v=r.endDTS*o+g,T=f*rg,E=Math.ceil((v-y)/T),x=sg.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(N.warn("[mp4-remuxer]: remux empty Audio"),!x){N.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const A=[];for(let R=0;R<E;R++){const O=y+R*T;A.push({unit:x,pts:O,dts:O})}return t.samples=A,this.remuxAudio(t,i,s,!1)}}function je(l,t){let i;if(t===null)return l;for(t<l?i=-8589934592:i=8589934592;Math.abs(l-t)>4294967296;)l+=i;return l}function bA(l){for(let t=0;t<l.length;t++)if(l[t].key)return t;return-1}function Lp(l,t,i,s){const r=l.samples.length;if(!r)return;const o=l.inputTimeScale;for(let f=0;f<r;f++){const h=l.samples[f];h.pts=je(h.pts-i.baseTime*o/i.timescale,t*o)/o,h.dts=je(h.dts-s.baseTime*o/s.timescale,t*o)/o}const u=l.samples;return l.samples=[],{samples:u}}function Dp(l,t,i){const s=l.samples.length;if(!s)return;const r=l.inputTimeScale;for(let u=0;u<s;u++){const f=l.samples[u];f.pts=je(f.pts-i.baseTime*r/i.timescale,t*r)/r}l.samples.sort((u,f)=>u.pts-f.pts);const o=l.samples;return l.samples=[],{samples:o}}class ag{constructor(t,i,s,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=i,this.size=s,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class RA{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,i,s,r){this.audioCodec=i,this.videoCodec=s,this.generateInitSegment(IS(t,r)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:i,videoCodec:s}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=Zg(t);r.audio&&(i=lg(r.audio,Nt.AUDIO)),r.video&&(s=lg(r.video,Nt.VIDEO));const o={};r.audio&&r.video?o.audiovideo={container:"video/mp4",codec:i+","+s,initSegment:t,id:"main"}:r.audio?o.audio={container:"audio/mp4",codec:i,initSegment:t,id:"audio"}:r.video?o.video={container:"video/mp4",codec:s,initSegment:t,id:"main"}:N.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o}remux(t,i,s,r,o,u){var f,h;let{initPTS:d,lastEndTime:g}=this;const y={audio:void 0,video:void 0,text:r,id3:s,initSegment:void 0};ot(g)||(g=this.lastEndTime=o||0);const v=i.samples;if(!(v!=null&&v.length))return y;const T={initPTS:void 0,timescale:1};let E=this.initData;if((f=E)!=null&&f.length||(this.generateInitSegment(v),E=this.initData),!((h=E)!=null&&h.length))return N.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),y;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1);const x=MS(v,E),A=wS(E,v),R=A===null?o:A;(LA(d,R,o,x)||T.timescale!==d.timescale&&u)&&(T.initPTS=R-o,d&&d.timescale===1&&N.warn(`Adjusting initPTS by ${T.initPTS-d.baseTime}`),this.initPTS=d={baseTime:T.initPTS,timescale:1});const O=t?R-d.baseTime/d.timescale:g,_=O+x;NS(E,v,d.baseTime/d.timescale),x>0?this.lastEndTime=_:(N.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const F=!!E.audio,I=!!E.video;let V="";F&&(V+="audio"),I&&(V+="video");const G={data1:v,startPTS:O,startDTS:O,endPTS:_,endDTS:_,type:V,hasAudio:F,hasVideo:I,nb:1,dropped:0};return y.audio=G.type==="audio"?G:void 0,y.video=G.type!=="audio"?G:void 0,y.initSegment=T,y.id3=Lp(s,o,d,d),r.samples.length&&(y.text=Dp(r,o,d)),y}}function LA(l,t,i,s){if(l===null)return!0;const r=Math.max(s,1),o=t-l.baseTime/l.timescale;return Math.abs(o-i)>r}function lg(l,t){const i=l==null?void 0:l.codec;if(i&&i.length>4)return i;if(t===Nt.AUDIO){if(i==="ec-3"||i==="ac-3"||i==="alac")return i;if(i==="fLaC"||i==="Opus")return Pl(i,!1);const s="mp4a.40.5";return N.info(`Parsed audio codec "${i}" or audio object type not handled. Using "${s}"`),s}return N.warn(`Unhandled video codec "${i}"`),i==="hvc1"||i==="hev1"?"hvc1.1.6.L120.90":i==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Gi;try{Gi=self.performance.now.bind(self.performance)}catch{N.debug("Unable to use Performance API on this environment"),Gi=Ns==null?void 0:Ns.Date.now}const Il=[{demux:fA,remux:RA},{demux:gn,remux:Ol},{demux:uA,remux:Ol},{demux:vA,remux:Ol}];Il.splice(2,0,{demux:hA,remux:Ol});class og{constructor(t,i,s,r,o){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=i,this.config=s,this.vendor=r,this.id=o}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,i,s,r){const o=s.transmuxing;o.executeStart=Gi();let u=new Uint8Array(t);const{currentTransmuxState:f,transmuxConfig:h}=this;r&&(this.currentTransmuxState=r);const{contiguous:d,discontinuity:g,trackSwitch:y,accurateTimeOffset:v,timeOffset:T,initSegmentChange:E}=r||f,{audioCodec:x,videoCodec:A,defaultInitPts:R,duration:O,initSegmentData:_}=h,F=DA(u,i);if(F&&F.method==="AES-128"){const Q=this.getDecrypter();if(Q.isSync()){let z=Q.softwareDecrypt(u,F.key.buffer,F.iv.buffer);if(s.part>-1&&(z=Q.flush()),!z)return o.executeEnd=Gi(),_c(s);u=new Uint8Array(z)}else return this.decryptionPromise=Q.webCryptoDecrypt(u,F.key.buffer,F.iv.buffer).then(z=>{const P=this.push(z,null,s);return this.decryptionPromise=null,P}),this.decryptionPromise}const I=this.needsProbing(g,y);if(I){const Q=this.configureTransmuxer(u);if(Q)return N.warn(`[transmuxer] ${Q.message}`),this.observer.emit(b.ERROR,b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:Q,reason:Q.message}),o.executeEnd=Gi(),_c(s)}(g||y||E||I)&&this.resetInitSegment(_,x,A,O,i),(g||E||I)&&this.resetInitialTimestamp(R),d||this.resetContiguity();const V=this.transmux(u,F,T,v,s),G=this.currentTransmuxState;return G.contiguous=!0,G.discontinuity=!1,G.trackSwitch=!1,o.executeEnd=Gi(),V}flush(t){const i=t.transmuxing;i.executeStart=Gi();const{decrypter:s,currentTransmuxState:r,decryptionPromise:o}=this;if(o)return o.then(()=>this.flush(t));const u=[],{timeOffset:f}=r;if(s){const y=s.flush();y&&u.push(this.push(y,null,t))}const{demuxer:h,remuxer:d}=this;if(!h||!d)return i.executeEnd=Gi(),[_c(t)];const g=h.flush(f);return wl(g)?g.then(y=>(this.flushRemux(u,y,t),u)):(this.flushRemux(u,g,t),u)}flushRemux(t,i,s){const{audioTrack:r,videoTrack:o,id3Track:u,textTrack:f}=i,{accurateTimeOffset:h,timeOffset:d}=this.currentTransmuxState;N.log(`[transmuxer.ts]: Flushed fragment ${s.sn}${s.part>-1?" p: "+s.part:""} of level ${s.level}`);const g=this.remuxer.remux(r,o,u,f,d,h,!0,this.id);t.push({remuxResult:g,chunkMeta:s}),s.transmuxing.executeEnd=Gi()}resetInitialTimestamp(t){const{demuxer:i,remuxer:s}=this;!i||!s||(i.resetTimeStamp(t),s.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetContiguity(),i.resetNextTimestamp())}resetInitSegment(t,i,s,r,o){const{demuxer:u,remuxer:f}=this;!u||!f||(u.resetInitSegment(t,i,s,r),f.resetInitSegment(t,i,s,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,i,s,r,o){let u;return i&&i.method==="SAMPLE-AES"?u=this.transmuxSampleAes(t,i,s,r,o):u=this.transmuxUnencrypted(t,s,r,o),u}transmuxUnencrypted(t,i,s,r){const{audioTrack:o,videoTrack:u,id3Track:f,textTrack:h}=this.demuxer.demux(t,i,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,u,f,h,i,s,!1,this.id),chunkMeta:r}}transmuxSampleAes(t,i,s,r,o){return this.demuxer.demuxSampleAes(t,i,s).then(u=>({remuxResult:this.remuxer.remux(u.audioTrack,u.videoTrack,u.id3Track,u.textTrack,s,r,!1,this.id),chunkMeta:o}))}configureTransmuxer(t){const{config:i,observer:s,typeSupported:r,vendor:o}=this;let u;for(let v=0,T=Il.length;v<T;v++){var f;if((f=Il[v].demux)!=null&&f.probe(t)){u=Il[v];break}}if(!u)return new Error("Failed to find demuxer by probing fragment data");const h=this.demuxer,d=this.remuxer,g=u.remux,y=u.demux;(!d||!(d instanceof g))&&(this.remuxer=new g(s,i,r,o)),(!h||!(h instanceof y))&&(this.demuxer=new y(s,i,r),this.probe=y.probe)}needsProbing(t,i){return!this.demuxer||!this.remuxer||t||i}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new yf(this.config)),t}}function DA(l,t){let i=null;return l.byteLength>0&&(t==null?void 0:t.key)!=null&&t.iv!==null&&t.method!=null&&(i=t),i}const _c=l=>({remuxResult:{},chunkMeta:l});function wl(l){return"then"in l&&l.then instanceof Function}class CA{constructor(t,i,s,r,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=i,this.initSegmentData=s,this.duration=r,this.defaultInitPts=o||null}}class _A{constructor(t,i,s,r,o,u){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=i,this.accurateTimeOffset=s,this.trackSwitch=r,this.timeOffset=o,this.initSegmentChange=u}}var Cp={exports:{}};(function(l){var t=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function r(h,d,g){this.fn=h,this.context=d,this.once=g||!1}function o(h,d,g,y,v){if(typeof g!="function")throw new TypeError("The listener must be a function");var T=new r(g,y||h,v),E=i?i+d:d;return h._events[E]?h._events[E].fn?h._events[E]=[h._events[E],T]:h._events[E].push(T):(h._events[E]=T,h._eventsCount++),h}function u(h,d){--h._eventsCount===0?h._events=new s:delete h._events[d]}function f(){this._events=new s,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],g,y;if(this._eventsCount===0)return d;for(y in g=this._events)t.call(g,y)&&d.push(i?y.slice(1):y);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(g)):d},f.prototype.listeners=function(d){var g=i?i+d:d,y=this._events[g];if(!y)return[];if(y.fn)return[y.fn];for(var v=0,T=y.length,E=new Array(T);v<T;v++)E[v]=y[v].fn;return E},f.prototype.listenerCount=function(d){var g=i?i+d:d,y=this._events[g];return y?y.fn?1:y.length:0},f.prototype.emit=function(d,g,y,v,T,E){var x=i?i+d:d;if(!this._events[x])return!1;var A=this._events[x],R=arguments.length,O,_;if(A.fn){switch(A.once&&this.removeListener(d,A.fn,void 0,!0),R){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,g),!0;case 3:return A.fn.call(A.context,g,y),!0;case 4:return A.fn.call(A.context,g,y,v),!0;case 5:return A.fn.call(A.context,g,y,v,T),!0;case 6:return A.fn.call(A.context,g,y,v,T,E),!0}for(_=1,O=new Array(R-1);_<R;_++)O[_-1]=arguments[_];A.fn.apply(A.context,O)}else{var F=A.length,I;for(_=0;_<F;_++)switch(A[_].once&&this.removeListener(d,A[_].fn,void 0,!0),R){case 1:A[_].fn.call(A[_].context);break;case 2:A[_].fn.call(A[_].context,g);break;case 3:A[_].fn.call(A[_].context,g,y);break;case 4:A[_].fn.call(A[_].context,g,y,v);break;default:if(!O)for(I=1,O=new Array(R-1);I<R;I++)O[I-1]=arguments[I];A[_].fn.apply(A[_].context,O)}}return!0},f.prototype.on=function(d,g,y){return o(this,d,g,y,!1)},f.prototype.once=function(d,g,y){return o(this,d,g,y,!0)},f.prototype.removeListener=function(d,g,y,v){var T=i?i+d:d;if(!this._events[T])return this;if(!g)return u(this,T),this;var E=this._events[T];if(E.fn)E.fn===g&&(!v||E.once)&&(!y||E.context===y)&&u(this,T);else{for(var x=0,A=[],R=E.length;x<R;x++)(E[x].fn!==g||v&&!E[x].once||y&&E[x].context!==y)&&A.push(E[x]);A.length?this._events[T]=A.length===1?A[0]:A:u(this,T)}return this},f.prototype.removeAllListeners=function(d){var g;return d?(g=i?i+d:d,this._events[g]&&u(this,g)):(this._events=new s,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=i,f.EventEmitter=f,l.exports=f})(Cp);var OA=Cp.exports,Af=JT(OA);class _p{constructor(t,i,s,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const o=t.config;this.hls=t,this.id=i,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=s,this.onFlush=r;const u=(d,g)=>{g=g||{},g.frag=this.frag,g.id=this.id,d===b.ERROR&&(this.error=g.error),this.hls.trigger(d,g)};this.observer=new Af,this.observer.on(b.FRAG_DECRYPTED,u),this.observer.on(b.ERROR,u);const f=Yn(o.preferManagedMediaSource)||{isTypeSupported:()=>!1},h={mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:f.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(o.workerPath||Xx())){try{o.workerPath?(N.log(`loading Web Worker ${o.workerPath} for "${i}"`),this.workerContext=Qx(o.workerPath)):(N.log(`injecting Web Worker for "${i}"`),this.workerContext=Wx()),this.onwmsg=y=>this.onWorkerMessage(y);const{worker:g}=this.workerContext;g.addEventListener("message",this.onwmsg),g.onerror=y=>{const v=new Error(`${y.message}  (${y.filename}:${y.lineno})`);o.enableWorker=!1,N.warn(`Error in "${i}" Web Worker, fallback to inline`),this.hls.trigger(b.ERROR,{type:Tt.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:v})},g.postMessage({cmd:"init",typeSupported:h,vendor:"",id:i,config:JSON.stringify(o)})}catch(g){N.warn(`Error setting up "${i}" Web Worker, fallback to inline`,g),this.resetWorker(),this.error=null,this.transmuxer=new og(this.observer,h,o,"",i)}return}this.transmuxer=new og(this.observer,h,o,"",i)}resetWorker(){if(this.workerContext){const{worker:t,objectURL:i}=this.workerContext;i&&self.URL.revokeObjectURL(i),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const i=this.transmuxer;i&&(i.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,i,s,r,o,u,f,h,d,g){var y,v;d.transmuxing.start=self.performance.now();const{transmuxer:T}=this,E=u?u.start:o.start,x=o.decryptdata,A=this.frag,R=!(A&&o.cc===A.cc),O=!(A&&d.level===A.level),_=A?d.sn-A.sn:-1,F=this.part?d.part-this.part.index:-1,I=_===0&&d.id>1&&d.id===(A==null?void 0:A.stats.chunkCount),V=!O&&(_===1||_===0&&(F===1||I&&F<=0)),G=self.performance.now();(O||_||o.stats.parsing.start===0)&&(o.stats.parsing.start=G),u&&(F||!V)&&(u.stats.parsing.start=G);const Q=!(A&&((y=o.initSegment)==null?void 0:y.url)===((v=A.initSegment)==null?void 0:v.url)),z=new _A(R,V,h,O,E,Q);if(!V||R||Q){N.log(`[transmuxer-interface, ${o.type}]: Starting new transmux session for sn: ${d.sn} p: ${d.part} level: ${d.level} id: ${d.id}
        discontinuity: ${R}
        trackSwitch: ${O}
        contiguous: ${V}
        accurateTimeOffset: ${h}
        timeOffset: ${E}
        initSegmentChange: ${Q}`);const P=new CA(s,r,i,f,g);this.configureTransmuxer(P)}if(this.frag=o,this.part=u,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:x,chunkMeta:d,state:z},t instanceof ArrayBuffer?[t]:[]);else if(T){const P=T.push(t,x,d,z);wl(P)?(T.async=!0,P.then(J=>{this.handleTransmuxComplete(J)}).catch(J=>{this.transmuxerError(J,d,"transmuxer-interface push error")})):(T.async=!1,this.handleTransmuxComplete(P))}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:t});else if(i){let s=i.flush(t);wl(s)||i.async?(wl(s)||(s=Promise.resolve(s)),s.then(o=>{this.handleFlushResult(o,t)}).catch(o=>{this.transmuxerError(o,t,"transmuxer-interface flush error")})):this.handleFlushResult(s,t)}}transmuxerError(t,i,s){this.hls&&(this.error=t,this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,chunkMeta:i,frag:this.frag||void 0,fatal:!1,error:t,err:t,reason:s}))}handleFlushResult(t,i){t.forEach(s=>{this.handleTransmuxComplete(s)}),this.onFlush(i)}onWorkerMessage(t){const i=t.data;if(!(i!=null&&i.event)){N.warn(`worker message received with no ${i?"event name":"data"}`);return}const s=this.hls;if(this.hls)switch(i.event){case"init":{var r;const o=(r=this.workerContext)==null?void 0:r.objectURL;o&&self.URL.revokeObjectURL(o);break}case"transmuxComplete":{this.handleTransmuxComplete(i.data);break}case"flush":{this.onFlush(i.data);break}case"workerLog":N[i.data.logType]&&N[i.data.logType](i.data.message);break;default:{i.data=i.data||{},i.data.frag=this.frag,i.data.id=this.id,s.trigger(i.event,i.data);break}}}configureTransmuxer(t){const{transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}const ug=100;class IA extends vf{constructor(t,i,s){super(t,i,s,"[audio-stream-controller]",vt.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(b.ERROR,this.onError,this),t.on(b.BUFFER_RESET,this.onBufferReset,this),t.on(b.BUFFER_CREATED,this.onBufferCreated,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(b.ERROR,this.onError,this),t.off(b.BUFFER_RESET,this.onBufferReset,this),t.off(b.BUFFER_CREATED,this.onBufferCreated,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:i,id:s,initPTS:r,timescale:o}){if(s==="main"){const u=i.cc;this.initPTS[i.cc]={baseTime:r,timescale:o},this.log(`InitPTS for cc: ${u} found from main: ${r}`),this.videoTrackCC=u,this.state===Z.WAITING_INIT_PTS&&this.tick()}}startLoad(t){if(!this.levels){this.startPosition=t,this.state=Z.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(ug),i>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=Z.IDLE):(this.loadedmetadata=!1,this.state=Z.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}doTick(){switch(this.state){case Z.IDLE:this.doTickIdle();break;case Z.WAITING_TRACK:{var t;const{levels:s,trackId:r}=this,o=s==null||(t=s[r])==null?void 0:t.details;if(o){if(this.waitForCdnTuneIn(o))break;this.state=Z.WAITING_INIT_PTS}break}case Z.FRAG_LOADING_WAITING_RETRY:{var i;const s=performance.now(),r=this.retryDate;if(!r||s>=r||(i=this.media)!=null&&i.seeking){const{levels:o,trackId:u}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((o==null?void 0:o[u])||null),this.state=Z.IDLE}break}case Z.WAITING_INIT_PTS:{const s=this.waitingData;if(s){const{frag:r,part:o,cache:u,complete:f}=s;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Z.FRAG_LOADING;const h=u.flush(),d={frag:r,part:o,payload:h,networkDetails:null};this._handleFragmentLoadProgress(d),f&&super._handleFragmentLoadComplete(d)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const h=this.getLoadPosition(),d=Ht.bufferInfo(this.mediaBuffer,h,this.config.maxBufferHole);jc(d.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${d.end} is needed`),this.clearWaitingFragment())}}else this.state=Z.IDLE}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Z.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;t!=null&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){const{hls:t,levels:i,media:s,trackId:r}=this,o=t.config;if(!this.buffering||!s&&(this.startFragRequested||!o.startFragPrefetch)||!(i!=null&&i[r]))return;const u=i[r],f=u.details;if(!f||f.live&&this.levelLastLoaded!==u||this.waitForCdnTuneIn(f)){this.state=Z.WAITING_TRACK;return}const h=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&h&&(this.bufferFlushed=!1,this.afterBufferFlushed(h,Nt.AUDIO,vt.AUDIO));const d=this.getFwdBufferInfo(h,vt.AUDIO);if(d===null)return;if(!this.switchingTrack&&this._streamEnded(d,f)){t.trigger(b.BUFFER_EOS,{type:"audio"}),this.state=Z.ENDED;return}const g=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,vt.MAIN),y=d.len,v=this.getMaxBufferLength(g==null?void 0:g.len),T=f.fragments,E=T[0].start,x=this.getLoadPosition(),A=this.flushing?x:d.end;if(this.switchingTrack&&s){const F=x;f.PTSKnown&&F<E&&(d.end>E||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=E+.05)}if(y>=v&&!this.switchingTrack&&A<T[T.length-1].start)return;let R=this.getNextFragment(A,f),O=!1;if(R&&this.isLoopLoading(R,A)&&(O=!!R.gap,R=this.getNextFragmentLoopLoading(R,f,d,vt.MAIN,v)),!R){this.bufferFlushed=!0;return}const _=g&&R.start>g.end+f.targetduration;if(_||!(g!=null&&g.len)&&d.len){const F=this.getAppendedFrag(R.start,vt.MAIN);if(F===null||(O||(O=!!F.gap||!!_&&g.len===0),_&&!O||O&&d.nextStart&&d.nextStart<F.end))return}this.loadFragment(R,u,A)}getMaxBufferLength(t){const i=super.getMaxBufferLength();return t?Math.min(Math.max(i,t),this.config.maxMaxBufferLength):i}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:i}){this.resetTransmuxer(),this.levels=i.map(s=>new Us(s))}onAudioTrackSwitching(t,i){const s=!!i.url;this.trackId=i.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),s?this.setInterval(ug):this.resetTransmuxer(),s?(this.switchingTrack=i,this.state=Z.IDLE,this.flushAudioIfNeeded(i)):(this.switchingTrack=null,this.bufferedTrack=i,this.state=Z.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,i){this.mainDetails=i.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(b.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,i){var s;if(this.mainDetails==null){this.cachedTrackLoadedData=i;return}const{levels:r}=this,{details:o,id:u}=i;if(!r){this.warn(`Audio tracks were reset while loading level ${u}`);return}this.log(`Audio track ${u} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const f=r[u];let h=0;if(o.live||(s=f.details)!=null&&s.live){this.checkLiveUpdate(o);const g=this.mainDetails;if(o.deltaUpdateFailed||!g)return;if(!f.details&&o.hasProgramDateTime&&g.hasProgramDateTime)Vl(o,g),h=o.fragments[0].start;else{var d;h=this.alignPlaylists(o,f.details,(d=this.levelLastLoaded)==null?void 0:d.details)}}f.details=o,this.levelLastLoaded=f,!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,h),this.state===Z.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=Z.IDLE),this.tick()}_handleFragmentLoadProgress(t){var i;const{frag:s,part:r,payload:o}=t,{config:u,trackId:f,levels:h}=this;if(!h){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const d=h[f];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const g=d.details;if(!g){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(s.start);return}const y=u.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new _p(this.hls,vt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const T=this.initPTS[s.cc],E=(i=s.initSegment)==null?void 0:i.data;if(T!==void 0){const A=r?r.index:-1,R=A!==-1,O=new pf(s.level,s.sn,s.stats.chunkCount,o.byteLength,A,R);v.push(o,E,y,"",s,r,g.totalduration,!1,O,T)}else{this.log(`Unknown video PTS for cc ${s.cc}, waiting for video PTS before demuxing audio frag ${s.sn} of [${g.startSN} ,${g.endSN}],track ${f}`);const{cache:x}=this.waitingData=this.waitingData||{frag:s,part:r,cache:new dp,complete:!1};x.push(new Uint8Array(o)),this.waitingVideoCC=this.videoTrackCC,this.state=Z.WAITING_INIT_PTS}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,i){const s=i.tracks.audio;s&&(this.mediaBuffer=s.buffer||null),i.tracks.video&&(this.videoBuffer=i.tracks.video.buffer||null)}onFragBuffered(t,i){const{frag:s,part:r}=i;if(s.type!==vt.AUDIO){if(!this.loadedmetadata&&s.type===vt.MAIN){const o=this.videoBuffer||this.media;o&&Ht.getBuffered(o).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${r?" p: "+r.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(s.sn!=="initSegment"){this.fragPrevious=s;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,he({},o)))}this.fragBufferedComplete(s,r)}onError(t,i){var s;if(i.fatal){this.state=Z.ERROR;return}switch(i.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(vt.AUDIO,i);break;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!i.levelRetry&&this.state===Z.WAITING_TRACK&&((s=i.context)==null?void 0:s.type)===Ot.AUDIO_TRACK&&(this.state=Z.IDLE);break;case H.BUFFER_APPEND_ERROR:case H.BUFFER_FULL_ERROR:if(!i.parent||i.parent!=="audio")return;if(i.details===H.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(i)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(i);break}}onBufferFlushing(t,{type:i}){i!==Nt.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:i}){if(i!==Nt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Z.ENDED&&(this.state=Z.IDLE);const s=this.mediaBuffer||this.media;s&&(this.afterBufferFlushed(s,i,vt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var i;const s="audio",{hls:r}=this,{remuxResult:o,chunkMeta:u}=t,f=this.getCurrentContext(u);if(!f){this.resetWhenMissingContext(u);return}const{frag:h,part:d,level:g}=f,{details:y}=g,{audio:v,text:T,id3:E,initSegment:x}=o;if(this.fragContextChanged(h)||!y){this.fragmentTracker.removeFragment(h);return}if(this.state=Z.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const A=h.initSegment||h;this._bufferInitSegment(g,x.tracks,A,u),r.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:s,tracks:x.tracks})}if(v){const{startPTS:A,endPTS:R,startDTS:O,endDTS:_}=v;d&&(d.elementaryStreams[Nt.AUDIO]={startPTS:A,endPTS:R,startDTS:O,endDTS:_}),h.setElementaryStreamInfo(Nt.AUDIO,A,R,O,_),this.bufferFragmentData(v,h,d,u)}if(E!=null&&(i=E.samples)!=null&&i.length){const A=ie({id:s,frag:h,details:y},E);r.trigger(b.FRAG_PARSING_METADATA,A)}if(T){const A=ie({id:s,frag:h,details:y},T);r.trigger(b.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(t,i,s,r){if(this.state!==Z.PARSING)return;i.video&&delete i.video;const o=i.audio;if(!o)return;o.id="audio";const u=t.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${u}/${o.codec}]`),u&&u.split(",").length===1&&(o.levelCodec=u),this.hls.trigger(b.BUFFER_CODECS,i);const f=o.initSegment;if(f!=null&&f.byteLength){const h={type:"audio",frag:s,part:null,chunkMeta:r,parent:s.type,data:f};this.hls.trigger(b.BUFFER_APPENDING,h)}this.tickImmediate()}loadFragment(t,i,s){const r=this.fragmentTracker.getState(t);if(this.fragCurrent=t,this.switchingTrack||r===fe.NOT_LOADED||r===fe.PARTIAL){var o;if(t.sn==="initSegment")this._loadInitSegment(t,i);else if((o=i.details)!=null&&o.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=Z.WAITING_INIT_PTS;const u=this.mainDetails;u&&u.fragments[0].start!==i.details.fragments[0].start&&Vl(i.details,u)}else this.startFragRequested=!0,super.loadFragment(t,i,s)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:i,lang:s,assocLang:r,characteristics:o,audioCodec:u,channels:f}=this.bufferedTrack;Kn({name:i,lang:s,assocLang:r,characteristics:o,audioCodec:u,channels:f},t,Hn)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(t){const{hls:i}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,i.trigger(b.AUDIO_TRACK_SWITCHED,he({},t))}}function Op(l,t){if(l.length!==t.length)return!1;for(let i=0;i<l.length;i++)if(!qr(l[i].attrs,t[i].attrs))return!1;return!0}function qr(l,t,i){const s=l["STABLE-RENDITION-ID"];return s&&!i?s===t["STABLE-RENDITION-ID"]:!(i||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>l[r]!==t[r])}function Wc(l,t){return t.label.toLowerCase()===l.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(l.lang||"").toLowerCase())}class wA extends gf{constructor(t){super(t,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.LEVEL_LOADING,this.onLevelLoading,this),t.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.LEVEL_LOADING,this.onLevelLoading,this),t.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(b.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,i){this.tracks=i.audioTracks||[]}onAudioTrackLoaded(t,i){const{id:s,groupId:r,details:o}=i,u=this.tracksInGroup[s];if(!u||u.groupId!==r){this.warn(`Audio track with id:${s} and group:${r} not found in active group ${u==null?void 0:u.groupId}`);return}const f=u.details;u.details=i.details,this.log(`Audio track ${s} "${u.name}" lang:${u.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),s===this.trackId&&this.playlistLoaded(s,i,f)}onLevelLoading(t,i){this.switchLevel(i.level)}onLevelSwitching(t,i){this.switchLevel(i.level)}switchLevel(t){const i=this.hls.levels[t];if(!i)return;const s=i.audioGroups||null,r=this.groupIds;let o=this.currentTrack;if(!s||(r==null?void 0:r.length)!==(s==null?void 0:s.length)||s!=null&&s.some(f=>(r==null?void 0:r.indexOf(f))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const f=this.tracks.filter(v=>!s||s.indexOf(v.groupId)!==-1);if(f.length)this.selectDefaultTrack&&!f.some(v=>v.default)&&(this.selectDefaultTrack=!1),f.forEach((v,T)=>{v.id=T});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=f;const h=this.hls.config.audioPreference;if(!o&&h){const v=mi(h,f,Hn);if(v>-1)o=f[v];else{const T=mi(h,this.tracks);o=this.tracks[T]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const g={audioTracks:f};this.log(`Updating audio tracks, ${f.length} track(s) found in group(s): ${s==null?void 0:s.join(",")}`),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,g);const y=this.trackId;if(d!==-1&&y===-1)this.setAudioTrack(d);else if(f.length&&y===-1){var u;const v=new Error(`No audio track selected for current audio group-ID(s): ${(u=this.groupIds)==null?void 0:u.join(",")} track count: ${f.length}`);this.warn(v.message),this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:v})}}else this.shouldReloadPlaylist(o)&&this.setAudioTrack(this.trackId)}onError(t,i){i.fatal||!i.context||i.context.type===Ot.AUDIO_TRACK&&i.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(i.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(i))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const i=this.hls;if(i.config.audioPreference=t,t){const s=this.allAudioTracks;if(this.selectDefaultTrack=!1,s.length){const r=this.currentTrack;if(r&&Kn(t,r,Hn))return r;const o=mi(t,this.tracksInGroup,Hn);if(o>-1){const u=this.tracksInGroup[o];return this.setAudioTrack(o),u}else if(r){let u=i.loadLevel;u===-1&&(u=i.firstAutoLevel);const f=wx(t,i.levels,s,u,Hn);if(f===-1)return null;i.nextLoadLevel=f}if(t.channels||t.audioCodec){const u=mi(t,s);if(u>-1)return s[u]}}}return null}setAudioTrack(t){const i=this.tracksInGroup;if(t<0||t>=i.length){this.warn(`Invalid audio track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const s=this.currentTrack,r=i[t],o=r.details&&!r.details.live;if(t===this.trackId&&r===s&&o||(this.log(`Switching to audio-track ${t} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=t,this.currentTrack=r,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,he({},r)),o))return;const u=this.switchParams(r.url,s==null?void 0:s.details,r.details);this.loadPlaylist(u)}findTrackId(t){const i=this.tracksInGroup;for(let s=0;s<i.length;s++){const r=i[s];if(!(this.selectDefaultTrack&&!r.default)&&(!t||Kn(t,r,Hn)))return s}if(t){const{name:s,lang:r,assocLang:o,characteristics:u,audioCodec:f,channels:h}=t;for(let d=0;d<i.length;d++){const g=i[d];if(Kn({name:s,lang:r,assocLang:o,characteristics:u,audioCodec:f,channels:h},g,Hn))return d}for(let d=0;d<i.length;d++){const g=i[d];if(qr(t.attrs,g.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<i.length;d++){const g=i[d];if(qr(t.attrs,g.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(t){const i=this.currentTrack;if(this.shouldLoadPlaylist(i)&&i){super.loadPlaylist();const s=i.id,r=i.groupId;let o=i.url;if(t)try{o=t.addDirectives(o)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`loading audio-track playlist ${s} "${i.name}" lang:${i.lang} group:${r}`),this.clearTimer(),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:o,id:s,groupId:r,deliveryDirectives:t||null})}}}const cg=500;class MA extends vf{constructor(t,i,s){super(t,i,s,"[subtitle-stream-controller]",vt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.ERROR,this.onError,this),t.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.ERROR,this.onError,this),t.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=Z.IDLE,this.setInterval(cg),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,i){this.mainDetails=i.details}onSubtitleFragProcessed(t,i){const{frag:s,success:r}=i;if(this.fragPrevious=s,this.state=Z.IDLE,!r)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let u;const f=s.start;for(let d=0;d<o.length;d++)if(f>=o[d].start&&f<=o[d].end){u=o[d];break}const h=s.start+s.duration;u?u.end=h:(u={start:f,end:h},o.push(u)),this.fragmentTracker.fragBuffered(s),this.fragBufferedComplete(s,null)}onBufferFlushing(t,i){const{startOffset:s,endOffset:r}=i;if(s===0&&r!==Number.POSITIVE_INFINITY){const o=r-1;if(o<=0)return;i.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(u=>{for(let f=0;f<u.length;){if(u[f].end<=o){u.shift();continue}else if(u[f].start<o)u[f].start=o;else break;f++}}),this.fragmentTracker.removeFragmentsInRange(s,o,vt.SUBTITLE)}}onFragBuffered(t,i){if(!this.loadedmetadata&&i.frag.type===vt.MAIN){var s;(s=this.media)!=null&&s.buffered.length&&(this.loadedmetadata=!0)}}onError(t,i){const s=i.frag;(s==null?void 0:s.type)===vt.SUBTITLE&&(i.details===H.FRAG_GAP&&this.fragmentTracker.fragBuffered(s,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Z.STOPPED&&(this.state=Z.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:i}){if(this.levels&&Op(this.levels,i)){this.levels=i.map(s=>new Us(s));return}this.tracksBuffered=[],this.levels=i.map(s=>{const r=new Us(s);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,vt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,i){var s;if(this.currentTrackId=i.id,!((s=this.levels)!=null&&s.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(cg)}onSubtitleTrackLoaded(t,i){var s;const{currentTrackId:r,levels:o}=this,{details:u,id:f}=i;if(!o){this.warn(`Subtitle tracks were reset while loading level ${f}`);return}const h=o[f];if(f>=o.length||!h)return;this.log(`Subtitle track ${f} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(u.live||(s=h.details)!=null&&s.live){const y=this.mainDetails;if(u.deltaUpdateFailed||!y)return;const v=y.fragments[0];if(!h.details)u.hasProgramDateTime&&y.hasProgramDateTime?(Vl(u,y),d=u.fragments[0].start):v&&(d=v.start,qc(u,d));else{var g;d=this.alignPlaylists(u,h.details,(g=this.levelLastLoaded)==null?void 0:g.details),d===0&&v&&(d=v.start,qc(u,d))}}h.details=u,this.levelLastLoaded=h,f===r&&(!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(this.mainDetails||u,d),this.tick(),u.live&&!this.fragCurrent&&this.media&&this.state===Z.IDLE&&(zl(null,u.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),h.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:i,payload:s}=t,r=i.decryptdata,o=this.hls;if(!this.fragContextChanged(i)&&s&&s.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){const u=performance.now();this.decrypter.decrypt(new Uint8Array(s),r.key.buffer,r.iv.buffer).catch(f=>{throw o.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:i}),f}).then(f=>{const h=performance.now();o.trigger(b.FRAG_DECRYPTED,{frag:i,payload:f,stats:{tstart:u,tdecrypt:h}})}).catch(f=>{this.warn(`${f.name}: ${f.message}`),this.state=Z.IDLE})}}doTick(){if(!this.media){this.state=Z.IDLE;return}if(this.state===Z.IDLE){const{currentTrackId:t,levels:i}=this,s=i==null?void 0:i[t];if(!s||!i.length||!s.details)return;const{config:r}=this,o=this.getLoadPosition(),u=Ht.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,r.maxBufferHole),{end:f,len:h}=u,d=this.getFwdBufferInfo(this.media,vt.MAIN),g=s.details,y=this.getMaxBufferLength(d==null?void 0:d.len)+g.levelTargetDuration;if(h>y)return;const v=g.fragments,T=v.length,E=g.edge;let x=null;const A=this.fragPrevious;if(f<E){const R=r.maxFragLookUpTolerance,O=f>E-R?0:R;x=zl(A,v,Math.max(v[0].start,f),O),!x&&A&&A.start<v[0].start&&(x=v[0])}else x=v[T-1];if(!x)return;if(x=this.mapToInitFragWhenRequired(x),x.sn!=="initSegment"){const R=x.sn-g.startSN,O=v[R-1];O&&O.cc===x.cc&&this.fragmentTracker.getState(O)===fe.NOT_LOADED&&(x=O)}this.fragmentTracker.getState(x)===fe.NOT_LOADED&&this.loadFragment(x,s,f)}}getMaxBufferLength(t){const i=super.getMaxBufferLength();return t?Math.max(i,t):i}loadFragment(t,i,s){this.fragCurrent=t,t.sn==="initSegment"?this._loadInitSegment(t,i):(this.startFragRequested=!0,super.loadFragment(t,i,s))}get mediaBufferTimeRanges(){return new kA(this.tracksBuffered[this.currentTrackId]||[])}}class kA{constructor(t){this.buffered=void 0;const i=(s,r,o)=>{if(r=r>>>0,r>o-1)throw new DOMException(`Failed to execute '${s}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${o})`);return t[r][s]};this.buffered={get length(){return t.length},end(s){return i("end",s,t.length)},start(s){return i("start",s,t.length)}}}}class NA extends gf{constructor(t){super(t,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let i=null;const s=Dl(this.media.textTracks);for(let o=0;o<s.length;o++)if(s[o].mode==="hidden")i=s[o];else if(s[o].mode==="showing"){i=s[o];break}const r=this.findTrackForTextTrack(i);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.LEVEL_LOADING,this.onLevelLoading,this),t.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.LEVEL_LOADING,this.onLevelLoading,this),t.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(b.ERROR,this.onError,this)}onMediaAttached(t,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Dl(this.media.textTracks).forEach(i=>{Ms(i)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,i){this.tracks=i.subtitleTracks}onSubtitleTrackLoaded(t,i){const{id:s,groupId:r,details:o}=i,u=this.tracksInGroup[s];if(!u||u.groupId!==r){this.warn(`Subtitle track with id:${s} and group:${r} not found in active group ${u==null?void 0:u.groupId}`);return}const f=u.details;u.details=i.details,this.log(`Subtitle track ${s} "${u.name}" lang:${u.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),s===this.trackId&&this.playlistLoaded(s,i,f)}onLevelLoading(t,i){this.switchLevel(i.level)}onLevelSwitching(t,i){this.switchLevel(i.level)}switchLevel(t){const i=this.hls.levels[t];if(!i)return;const s=i.subtitleGroups||null,r=this.groupIds;let o=this.currentTrack;if(!s||(r==null?void 0:r.length)!==(s==null?void 0:s.length)||s!=null&&s.some(u=>(r==null?void 0:r.indexOf(u))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(g=>!s||s.indexOf(g.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(g=>g.default)&&(this.selectDefaultTrack=!1),u.forEach((g,y)=>{g.id=y});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const f=this.hls.config.subtitlePreference;if(!o&&f){this.selectDefaultTrack=!1;const g=mi(f,u);if(g>-1)o=u[g];else{const y=mi(f,this.tracks);o=this.tracks[y]}}let h=this.findTrackId(o);h===-1&&o&&(h=this.findTrackId(null));const d={subtitleTracks:u};this.log(`Updating subtitle tracks, ${u.length} track(s) found in "${s==null?void 0:s.join(",")}" group-id`),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,d),h!==-1&&this.trackId===-1&&this.setSubtitleTrack(h)}else this.shouldReloadPlaylist(o)&&this.setSubtitleTrack(this.trackId)}findTrackId(t){const i=this.tracksInGroup,s=this.selectDefaultTrack;for(let r=0;r<i.length;r++){const o=i[r];if(!(s&&!o.default||!s&&!t)&&(!t||Kn(o,t)))return r}if(t){for(let r=0;r<i.length;r++){const o=i[r];if(qr(t.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<i.length;r++){const o=i[r];if(qr(t.attrs,o.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(t){if(t){const i=this.tracksInGroup;for(let s=0;s<i.length;s++){const r=i[s];if(Wc(r,t))return s}}return-1}onError(t,i){i.fatal||!i.context||i.context.type===Ot.SUBTITLE_TRACK&&i.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(i.context.groupId)!==-1)&&this.checkRetry(i)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){const i=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&Kn(t,s))return s;const r=mi(t,this.tracksInGroup);if(r>-1){const o=this.tracksInGroup[r];return this.setSubtitleTrack(r),o}else{if(s)return null;{const o=mi(t,i);if(o>-1)return i[o]}}}}return null}loadPlaylist(t){super.loadPlaylist();const i=this.currentTrack;if(this.shouldLoadPlaylist(i)&&i){const s=i.id,r=i.groupId;let o=i.url;if(t)try{o=t.addDirectives(o)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`Loading subtitle playlist for id ${s}`),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:o,id:s,groupId:r,deliveryDirectives:t||null})}}toggleTrackModes(){const{media:t}=this;if(!t)return;const i=Dl(t.textTracks),s=this.currentTrack;let r;if(s&&(r=i.filter(o=>Wc(s,o))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${s.name}" and language "${s.lang}"`)),[].slice.call(i).forEach(o=>{o.mode!=="disabled"&&o!==r&&(o.mode="disabled")}),r){const o=this.subtitleDisplay?"showing":"hidden";r.mode!==o&&(r.mode=o)}}setSubtitleTrack(t){const i=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=i.length||!ot(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const s=this.currentTrack,r=i[t]||null;if(this.trackId=t,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:t});return}const o=!!r.details&&!r.details.live;if(t===this.trackId&&r===s&&o)return;this.log(`Switching to subtitle-track ${t}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:u,groupId:f="",name:h,type:d,url:g}=r;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:u,groupId:f,name:h,type:d,url:g});const y=this.switchParams(r.url,s==null?void 0:s.details,r.details);this.loadPlaylist(y)}}class UA{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,i,s){const r=this.queues[i];r.push(t),r.length===1&&!s&&this.executeNext(i)}insertAbort(t,i){this.queues[i].unshift(t),this.executeNext(i)}appendBlocker(t){let i;const s=new Promise(o=>{i=o}),r={execute:i,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,t),s}executeNext(t){const i=this.queues[t];if(i.length){const s=i[0];try{s.execute()}catch(r){N.warn(`[buffer-operation-queue]: Exception executing "${t}" SourceBuffer operation: ${r}`),s.onError(r);const o=this.buffers[t];o!=null&&o.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const fg=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class FA{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=s=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=s=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:s,mediaSource:r}=this;this.log("Media source opened"),s&&(s.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(b.MEDIA_ATTACHED,{media:s,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:s,_objectUrl:r}=this;s!==r&&N.error(`Media element src was set while attaching MediaSource (${r} > ${s})`)},this.hls=t;const i="[buffer-controller]";this.appendSource=YS(Yn(t.config.preferManagedMediaSource)),this.log=N.log.bind(N,i),this.warn=N.warn.bind(N,i),this.error=N.error.bind(N,i),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.BUFFER_RESET,this.onBufferReset,this),t.on(b.BUFFER_APPENDING,this.onBufferAppending,this),t.on(b.BUFFER_CODECS,this.onBufferCodecs,this),t.on(b.BUFFER_EOS,this.onBufferEos,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(b.FRAG_PARSED,this.onFragParsed,this),t.on(b.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.BUFFER_RESET,this.onBufferReset,this),t.off(b.BUFFER_APPENDING,this.onBufferAppending,this),t.off(b.BUFFER_CODECS,this.onBufferCodecs,this),t.off(b.BUFFER_EOS,this.onBufferEos,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(b.FRAG_PARSED,this.onFragParsed,this),t.off(b.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new UA(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,i){let s=2;(i.audio&&!i.video||!i.altAudio)&&(s=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=s,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,i){const s=this.media=i.media,r=Yn(this.appendSource);if(s&&r){var o;const u=this.mediaSource=new r;this.log(`created media source: ${(o=u.constructor)==null?void 0:o.name}`),u.addEventListener("sourceopen",this._onMediaSourceOpen),u.addEventListener("sourceended",this._onMediaSourceEnded),u.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(u.addEventListener("startstreaming",this._onStartStreaming),u.addEventListener("endstreaming",this._onEndStreaming));const f=this._objectUrl=self.URL.createObjectURL(u);if(this.appendSource)try{s.removeAttribute("src");const h=self.ManagedMediaSource;s.disableRemotePlayback=s.disableRemotePlayback||h&&u instanceof h,hg(s),BA(s,f),s.load()}catch{s.src=f}else s.src=f;s.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:t,mediaSource:i,_objectUrl:s}=this;if(i){if(this.log("media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),t&&(t.removeEventListener("emptied",this._onMediaEmptied),s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(t.removeAttribute("src"),this.appendSource&&hg(t),t.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(b.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(t=>{this.resetBuffer(t)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(t){const i=this.sourceBuffer[t];try{if(i){var s;this.removeBufferListeners(t),this.sourceBuffer[t]=void 0,(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}}catch(r){this.warn(`onBufferReset ${t}`,r)}}onBufferCodecs(t,i){const s=this.getSourceBufferTypes().length,r=Object.keys(i);if(r.forEach(u=>{if(s){const h=this.tracks[u];if(h&&typeof h.buffer.changeType=="function"){var f;const{id:d,codec:g,levelCodec:y,container:v,metadata:T}=i[u],E=Mm(h.codec,h.levelCodec),x=E==null?void 0:E.replace(fg,"$1");let A=Mm(g,y);const R=(f=A)==null?void 0:f.replace(fg,"$1");if(A&&x!==R){u.slice(0,5)==="audio"&&(A=Pl(A,this.appendSource));const O=`${v};codecs=${A}`;this.appendChangeType(u,O),this.log(`switching codec ${E} to ${A}`),this.tracks[u]={buffer:h.buffer,codec:g,container:v,levelCodec:y,metadata:T,id:d}}}}else this.pendingTracks[u]=i[u]}),s)return;const o=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==o&&(this.log(`${o} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=o),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(t,i){const{operationQueue:s}=this,r={execute:()=>{const o=this.sourceBuffer[t];o&&(this.log(`changing ${t} sourceBuffer type to ${i}`),o.changeType(i)),s.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${t} SourceBuffer type`,o)}};s.append(r,t,!!this.pendingTracks[t])}onBufferAppending(t,i){const{hls:s,operationQueue:r,tracks:o}=this,{data:u,type:f,frag:h,part:d,chunkMeta:g}=i,y=g.buffering[f],v=self.performance.now();y.start=v;const T=h.stats.buffering,E=d?d.stats.buffering:null;T.start===0&&(T.start=v),E&&E.start===0&&(E.start=v);const x=o.audio;let A=!1;f==="audio"&&(x==null?void 0:x.container)==="audio/mpeg"&&(A=!this.lastMpegAudioChunk||g.id===1||this.lastMpegAudioChunk.sn!==g.sn,this.lastMpegAudioChunk=g);const R=h.start,O={execute:()=>{if(y.executeStart=self.performance.now(),A){const _=this.sourceBuffer[f];if(_){const F=R-_.timestampOffset;Math.abs(F)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${F}) sn: ${h.sn})`),_.timestampOffset=R)}}this.appendExecutor(u,f)},onStart:()=>{},onComplete:()=>{const _=self.performance.now();y.executeEnd=y.end=_,T.first===0&&(T.first=_),E&&E.first===0&&(E.first=_);const{sourceBuffer:F}=this,I={};for(const V in F)I[V]=Ht.getBuffered(F[V]);this.appendErrors[f]=0,f==="audio"||f==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(b.BUFFER_APPENDED,{type:f,frag:h,part:d,chunkMeta:g,parent:h.type,timeRanges:I})},onError:_=>{const F={type:Tt.MEDIA_ERROR,parent:h.type,details:H.BUFFER_APPEND_ERROR,sourceBufferName:f,frag:h,part:d,chunkMeta:g,error:_,err:_,fatal:!1};if(_.code===DOMException.QUOTA_EXCEEDED_ERR)F.details=H.BUFFER_FULL_ERROR;else{const I=++this.appendErrors[f];F.details=H.BUFFER_APPEND_ERROR,this.warn(`Failed ${I}/${s.config.appendErrorMaxRetry} times to append segment in "${f}" sourceBuffer`),I>=s.config.appendErrorMaxRetry&&(F.fatal=!0)}s.trigger(b.ERROR,F)}};r.append(O,f,!!this.pendingTracks[f])}onBufferFlushing(t,i){const{operationQueue:s}=this,r=o=>({execute:this.removeExecutor.bind(this,o,i.startOffset,i.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(b.BUFFER_FLUSHED,{type:o})},onError:u=>{this.warn(`Failed to remove from ${o} SourceBuffer`,u)}});i.type?s.append(r(i.type),i.type):this.getSourceBufferTypes().forEach(o=>{s.append(r(o),o)})}onFragParsed(t,i){const{frag:s,part:r}=i,o=[],u=r?r.elementaryStreams:s.elementaryStreams;u[Nt.AUDIOVIDEO]?o.push("audiovideo"):(u[Nt.AUDIO]&&o.push("audio"),u[Nt.VIDEO]&&o.push("video"));const f=()=>{const h=self.performance.now();s.stats.buffering.end=h,r&&(r.stats.buffering.end=h);const d=r?r.stats:s.stats;this.hls.trigger(b.FRAG_BUFFERED,{frag:s,part:r,stats:d,id:s.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${s.type} level: ${s.level} sn: ${s.sn}`),this.blockBuffers(f,o)}onFragChanged(t,i){this.trimBuffers()}onBufferEos(t,i){this.getSourceBufferTypes().reduce((r,o)=>{const u=this.sourceBuffer[o];return u&&(!i.type||i.type===o)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${o} sourceBuffer now EOS`))),r&&!!(!u||u.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(o=>{const u=this.sourceBuffer[o];u&&(u.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(t,{details:i}){i.fragments.length&&(this.details=i,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:t,details:i,media:s}=this;if(!s||i===null||!this.getSourceBufferTypes().length)return;const o=t.config,u=s.currentTime,f=i.levelTargetDuration,h=i.live&&o.liveBackBufferLength!==null?o.liveBackBufferLength:o.backBufferLength;if(ot(h)&&h>0){const d=Math.max(h,f),g=Math.floor(u/f)*f-d;this.flushBackBuffer(u,f,g)}if(ot(o.frontBufferFlushThreshold)&&o.frontBufferFlushThreshold>0){const d=Math.max(o.maxBufferLength,o.frontBufferFlushThreshold),g=Math.max(d,f),y=Math.floor(u/f)*f+g;this.flushFrontBuffer(u,f,y)}}flushBackBuffer(t,i,s){const{details:r,sourceBuffer:o}=this;this.getSourceBufferTypes().forEach(f=>{const h=o[f];if(h){const d=Ht.getBuffered(h);if(d.length>0&&s>d.start(0)){if(this.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:s}),r!=null&&r.live)this.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:s});else if(h.ended&&d.end(d.length-1)-t<i*2){this.log(`Cannot flush ${f} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:s,type:f})}}})}flushFrontBuffer(t,i,s){const{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(u=>{const f=r[u];if(f){const h=Ht.getBuffered(f),d=h.length;if(d<2)return;const g=h.start(d-1),y=h.end(d-1);if(s>g||t>=g&&t<=y)return;if(f.ended&&t-y<2*i){this.log(`Cannot flush ${u} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:g,endOffset:1/0,type:u})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:t,hls:i,media:s,mediaSource:r}=this,o=t.fragments[0].start+t.totalduration,u=s.duration,f=ot(r.duration)?r.duration:0;t.live&&i.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(t)):(o>f&&o>u||!ot(u))&&(this.log(`Updating Media Source duration to ${o.toFixed(3)}`),r.duration=o)}updateSeekableRange(t){const i=this.mediaSource,s=t.fragments;if(s.length&&t.live&&i!=null&&i.setLiveSeekableRange){const o=Math.max(0,s[0].start),u=Math.max(o,o+t.totalduration);this.log(`Media Source duration is set to ${i.duration}. Setting seekable range to ${o}-${u}.`),i.setLiveSeekableRange(o,u)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:i,pendingTracks:s}=this,r=Object.keys(s).length;if(r&&(!t||r===2||"audiovideo"in s)){this.createSourceBuffers(s),this.pendingTracks={};const o=this.getSourceBufferTypes();if(o.length)this.hls.trigger(b.BUFFER_CREATED,{tracks:this.tracks}),o.forEach(u=>{i.executeNext(u)});else{const u=new Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:u,reason:u.message})}}}createSourceBuffers(t){const{sourceBuffer:i,mediaSource:s}=this;if(!s)throw Error("createSourceBuffers called when mediaSource was null");for(const o in t)if(!i[o]){var r;const u=t[o];if(!u)throw Error(`source buffer exists for track ${o}, however track does not`);let f=((r=u.levelCodec)==null?void 0:r.indexOf(","))===-1?u.levelCodec:u.codec;f&&o.slice(0,5)==="audio"&&(f=Pl(f,this.appendSource));const h=`${u.container};codecs=${f}`;this.log(`creating sourceBuffer(${h})`);try{const d=i[o]=s.addSourceBuffer(h),g=o;this.addBufferListener(g,"updatestart",this._onSBUpdateStart),this.addBufferListener(g,"updateend",this._onSBUpdateEnd),this.addBufferListener(g,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(g,"bufferedchange",(y,v)=>{const T=v.removedRanges;T!=null&&T.length&&this.hls.trigger(b.BUFFER_FLUSHED,{type:o})}),this.tracks[o]={buffer:d,codec:f,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(d){this.error(`error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:o,mimeType:h})}}}get mediaSrc(){var t,i;const s=((t=this.media)==null||(i=t.querySelector)==null?void 0:i.call(t,"source"))||this.media;return s==null?void 0:s.src}_onSBUpdateStart(t){const{operationQueue:i}=this;i.current(t).onStart()}_onSBUpdateEnd(t){var i;if(((i=this.mediaSource)==null?void 0:i.readyState)==="closed"){this.resetBuffer(t);return}const{operationQueue:s}=this;s.current(t).onComplete(),s.shiftAndExecuteNext(t)}_onSBUpdateError(t,i){var s;const r=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(s=this.mediaSource)==null?void 0:s.readyState}`);this.error(`${r}`,i),this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:r,fatal:!1});const o=this.operationQueue.current(t);o&&o.onError(r)}removeExecutor(t,i,s){const{media:r,mediaSource:o,operationQueue:u,sourceBuffer:f}=this,h=f[t];if(!r||!o||!h){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),u.shiftAndExecuteNext(t);return}const d=ot(r.duration)?r.duration:1/0,g=ot(o.duration)?o.duration:1/0,y=Math.max(0,i),v=Math.min(s,d,g);v>y&&(!h.ending||h.ended)?(h.ended=!1,this.log(`Removing [${y},${v}] from the ${t} SourceBuffer`),h.remove(y,v)):u.shiftAndExecuteNext(t)}appendExecutor(t,i){const s=this.sourceBuffer[i];if(!s){if(!this.pendingTracks[i])throw new Error(`Attempting to append to the ${i} SourceBuffer, but it does not exist`);return}s.ended=!1,s.appendBuffer(t)}blockBuffers(t,i=this.getSourceBufferTypes()){if(!i.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);return}const{operationQueue:s}=this,r=i.map(o=>s.appendBlocker(o));Promise.all(r).then(()=>{t(),i.forEach(o=>{const u=this.sourceBuffer[o];u!=null&&u.updating||s.shiftAndExecuteNext(o)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,i,s){const r=this.sourceBuffer[t];if(!r)return;const o=s.bind(this,t);this.listeners[t].push({event:i,listener:o}),r.addEventListener(i,o)}removeBufferListeners(t){const i=this.sourceBuffer[t];i&&this.listeners[t].forEach(s=>{i.removeEventListener(s.event,s.listener)})}}function hg(l){const t=l.querySelectorAll("source");[].slice.call(t).forEach(i=>{l.removeChild(i)})}function BA(l,t){const i=self.document.createElement("source");i.type="video/mp4",i.src=t,l.appendChild(i)}const PA={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ip=l=>String.fromCharCode(PA[l]||l),ei=15,Bi=100,GA={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$A={17:2,18:4,21:6,22:8,23:10,19:13,20:15},HA={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},zA={25:2,26:4,29:6,30:8,31:10,27:13,28:15},VA=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class KA{constructor(){this.time=null,this.verboseLevel=0}log(t,i){if(this.verboseLevel>=t){const s=typeof i=="function"?i():i;N.log(`${this.time} [${t}] ${s}`)}}}const Gn=function(t){const i=[];for(let s=0;s<t.length;s++)i.push(t[s].toString(16));return i};class wp{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const i=["foreground","underline","italics","background","flash"];for(let s=0;s<i.length;s++){const r=i[s];t.hasOwnProperty(r)&&(this[r]=t[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class YA{constructor(){this.uchar=" ",this.penState=new wp}reset(){this.uchar=" ",this.penState.reset()}setChar(t,i){this.uchar=t,this.penState.copy(i)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class qA{constructor(t){this.chars=[],this.pos=0,this.currPenState=new wp,this.cueStartTime=null,this.logger=void 0;for(let i=0;i<Bi;i++)this.chars.push(new YA);this.logger=t}equals(t){for(let i=0;i<Bi;i++)if(!this.chars[i].equals(t.chars[i]))return!1;return!0}copy(t){for(let i=0;i<Bi;i++)this.chars[i].copy(t.chars[i])}isEmpty(){let t=!0;for(let i=0;i<Bi;i++)if(!this.chars[i].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Bi&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Bi)}moveCursor(t){const i=this.pos+t;if(t>1)for(let s=this.pos+1;s<i+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(i)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const i=Ip(t);if(this.pos>=Bi){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+i+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(i,this.currPenState),this.moveCursor(1)}clearFromPos(t){let i;for(i=t;i<Bi;i++)this.chars[i].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let i=!0;for(let s=0;s<Bi;s++){const r=this.chars[s].uchar;r!==" "&&(i=!1),t.push(r)}return i?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class Oc{constructor(t){this.rows=[],this.currRow=ei-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let i=0;i<ei;i++)this.rows.push(new qA(t));this.logger=t}reset(){for(let t=0;t<ei;t++)this.rows[t].clear();this.currRow=ei-1}equals(t){let i=!0;for(let s=0;s<ei;s++)if(!this.rows[s].equals(t.rows[s])){i=!1;break}return i}copy(t){for(let i=0;i<ei;i++)this.rows[i].copy(t.rows[i])}isEmpty(){let t=!0;for(let i=0;i<ei;i++)if(!this.rows[i].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+JSON.stringify(t));let i=t.row-1;if(this.nrRollUpRows&&i<this.nrRollUpRows-1&&(i=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==i){for(let f=0;f<ei;f++)this.rows[f].clear();const o=this.currRow+1-this.nrRollUpRows,u=this.lastOutputScreen;if(u){const f=u.rows[o].cueStartTime,h=this.logger.time;if(f!==null&&h!==null&&f<h)for(let d=0;d<this.nrRollUpRows;d++)this.rows[i-this.nrRollUpRows+d+1].copy(u.rows[o+d])}}this.currRow=i;const s=this.rows[this.currRow];if(t.indent!==null){const o=t.indent,u=Math.max(o-1,0);s.setCursor(t.indent),t.color=s.chars[u].penState.foreground}const r={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,i=this.rows.splice(t,1)[0];i.clear(),this.rows.splice(this.currRow,0,i),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const i=[];let s="",r=-1;for(let o=0;o<ei;o++){const u=this.rows[o].getTextString();u&&(r=o+1,t?i.push("Row "+r+": '"+u+"'"):i.push(u.trim()))}return i.length>0&&(t?s="["+i.join(" | ")+"]":s=i.join(`
`)),s}getTextAndFormat(){return this.rows}}class dg{constructor(t,i,s){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=i,this.mode=null,this.verbose=0,this.displayedMemory=new Oc(s),this.nonDisplayedMemory=new Oc(s),this.lastOutputScreen=new Oc(s),this.currRollUpRow=this.displayedMemory.rows[ei-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=s}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ei-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let s=0;s<t.length;s++)this.writeScreen.insertChar(t[s]);const i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>i+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const i={flash:!1};if(i.underline=t%2===1,i.italics=t>=46,i.italics)i.foreground="white";else{const s=Math.floor(t/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];i.foreground=r[s]}this.logger.log(2,"MIDROW: "+JSON.stringify(i)),this.writeScreen.setPen(i)}outputDataUpdate(t=!1){const i=this.logger.time;i!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=i:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,i,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:i),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class mg{constructor(t,i,s){this.channels=void 0,this.currentChannel=0,this.cmdHistory=XA(),this.logger=void 0;const r=this.logger=new KA;this.channels=[null,new dg(t,i,r),new dg(t+1,s,r)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,i){this.channels[t].setHandler(i)}addData(t,i){this.logger.time=t;for(let s=0;s<i.length;s+=2){const r=i[s]&127,o=i[s+1]&127;let u=!1,f=null;if(r===0&&o===0)continue;this.logger.log(3,()=>"["+Gn([i[s],i[s+1]])+"] -> ("+Gn([r,o])+")");const h=this.cmdHistory;if(r>=16&&r<=31){if(jA(r,o,h)){Tl(null,null,h),this.logger.log(3,()=>"Repeated command ("+Gn([r,o])+") is dropped");continue}Tl(r,o,this.cmdHistory),u=this.parseCmd(r,o),u||(u=this.parseMidrow(r,o)),u||(u=this.parsePAC(r,o)),u||(u=this.parseBackgroundAttributes(r,o))}else Tl(null,null,h);if(!u&&(f=this.parseChars(r,o),f)){const g=this.currentChannel;g&&g>0?this.channels[g].insertChars(f):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!u&&!f&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Gn([r,o])+" orig: "+Gn([i[s],i[s+1]]))}}parseCmd(t,i){const s=(t===20||t===28||t===21||t===29)&&i>=32&&i<=47,r=(t===23||t===31)&&i>=33&&i<=35;if(!(s||r))return!1;const o=t===20||t===21||t===23?1:2,u=this.channels[o];return t===20||t===21||t===28||t===29?i===32?u.ccRCL():i===33?u.ccBS():i===34?u.ccAOF():i===35?u.ccAON():i===36?u.ccDER():i===37?u.ccRU(2):i===38?u.ccRU(3):i===39?u.ccRU(4):i===40?u.ccFON():i===41?u.ccRDC():i===42?u.ccTR():i===43?u.ccRTD():i===44?u.ccEDM():i===45?u.ccCR():i===46?u.ccENM():i===47&&u.ccEOC():u.ccTO(i-32),this.currentChannel=o,!0}parseMidrow(t,i){let s=0;if((t===17||t===25)&&i>=32&&i<=47){if(t===17?s=1:s=2,s!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[s];return r?(r.ccMIDROW(i),this.logger.log(3,()=>"MIDROW ("+Gn([t,i])+")"),!0):!1}return!1}parsePAC(t,i){let s;const r=(t>=17&&t<=23||t>=25&&t<=31)&&i>=64&&i<=127,o=(t===16||t===24)&&i>=64&&i<=95;if(!(r||o))return!1;const u=t<=23?1:2;i>=64&&i<=95?s=u===1?GA[t]:HA[t]:s=u===1?$A[t]:zA[t];const f=this.channels[u];return f?(f.setPAC(this.interpretPAC(s,i)),this.currentChannel=u,!0):!1}interpretPAC(t,i){let s;const r={color:null,italics:!1,indent:null,underline:!1,row:t};return i>95?s=i-96:s=i-64,r.underline=(s&1)===1,s<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((s-16)/2)*4,r}parseChars(t,i){let s,r=null,o=null;if(t>=25?(s=2,o=t-8):(s=1,o=t),o>=17&&o<=19){let u;o===17?u=i+80:o===18?u=i+112:u=i+144,this.logger.log(2,()=>"Special char '"+Ip(u)+"' in channel "+s),r=[u]}else t>=32&&t<=127&&(r=i===0?[t]:[t,i]);return r&&this.logger.log(3,()=>"Char codes =  "+Gn(r).join(",")),r}parseBackgroundAttributes(t,i){const s=(t===16||t===24)&&i>=32&&i<=47,r=(t===23||t===31)&&i>=45&&i<=47;if(!(s||r))return!1;let o;const u={};t===16||t===24?(o=Math.floor((i-32)/2),u.background=VA[o],i%2===1&&(u.background=u.background+"_semi")):i===45?u.background="transparent":(u.foreground="black",i===47&&(u.underline=!0));const f=t<=23?1:2;return this.channels[f].setBkgData(u),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const i=this.channels[t];i&&i.reset()}Tl(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let i=0;i<this.channels.length;i++){const s=this.channels[i];s&&s.cueSplitAtTime(t)}}}function Tl(l,t,i){i.a=l,i.b=t}function jA(l,t,i){return i.a===l&&i.b===t}function XA(){return{a:null,b:null}}class Sl{constructor(t,i){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=i}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,i,s){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=i,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var bf=function(){if(Ns!=null&&Ns.VTTCue)return self.VTTCue;const l=["","lr","rl"],t=["start","middle","end","left","right"];function i(f,h){if(typeof h!="string"||!Array.isArray(f))return!1;const d=h.toLowerCase();return~f.indexOf(d)?d:!1}function s(f){return i(l,f)}function r(f){return i(t,f)}function o(f,...h){let d=1;for(;d<arguments.length;d++){const g=arguments[d];for(const y in g)f[y]=g[y]}return f}function u(f,h,d){const g=this,y={enumerable:!0};g.hasBeenReset=!1;let v="",T=!1,E=f,x=h,A=d,R=null,O="",_=!0,F="auto",I="start",V=50,G="middle",Q=50,z="middle";Object.defineProperty(g,"id",o({},y,{get:function(){return v},set:function(P){v=""+P}})),Object.defineProperty(g,"pauseOnExit",o({},y,{get:function(){return T},set:function(P){T=!!P}})),Object.defineProperty(g,"startTime",o({},y,{get:function(){return E},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");E=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",o({},y,{get:function(){return x},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");x=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",o({},y,{get:function(){return A},set:function(P){A=""+P,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",o({},y,{get:function(){return R},set:function(P){R=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",o({},y,{get:function(){return O},set:function(P){const J=s(P);if(J===!1)throw new SyntaxError("An invalid or illegal string was specified.");O=J,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",o({},y,{get:function(){return _},set:function(P){_=!!P,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",o({},y,{get:function(){return F},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");F=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",o({},y,{get:function(){return I},set:function(P){const J=r(P);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");I=J,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",o({},y,{get:function(){return V},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");V=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",o({},y,{get:function(){return G},set:function(P){const J=r(P);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");G=J,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",o({},y,{get:function(){return Q},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");Q=P,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",o({},y,{get:function(){return z},set:function(P){const J=r(P);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");z=J,this.hasBeenReset=!0}})),g.displayState=void 0}return u.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},u}();class WA{decode(t,i){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Mp(l){function t(s,r,o,u){return(s|0)*3600+(r|0)*60+(o|0)+parseFloat(u||0)}const i=l.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?t(i[2],i[3],0,i[4]):t(i[1],i[2],i[3],i[4]):null}class QA{constructor(){this.values=Object.create(null)}set(t,i){!this.get(t)&&i!==""&&(this.values[t]=i)}get(t,i,s){return s?this.has(t)?this.values[t]:i[s]:this.has(t)?this.values[t]:i}has(t){return t in this.values}alt(t,i,s){for(let r=0;r<s.length;++r)if(i===s[r]){this.set(t,i);break}}integer(t,i){/^-?\d+$/.test(i)&&this.set(t,parseInt(i,10))}percent(t,i){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(i)){const s=parseFloat(i);if(s>=0&&s<=100)return this.set(t,s),!0}return!1}}function kp(l,t,i,s){const r=s?l.split(s):[l];for(const o in r){if(typeof r[o]!="string")continue;const u=r[o].split(i);if(u.length!==2)continue;const f=u[0],h=u[1];t(f,h)}}const Qc=new bf(0,0,""),xl=Qc.align==="middle"?"middle":"center";function ZA(l,t,i){const s=l;function r(){const f=Mp(l);if(f===null)throw new Error("Malformed timestamp: "+s);return l=l.replace(/^[^\sa-zA-Z-]+/,""),f}function o(f,h){const d=new QA;kp(f,function(v,T){let E;switch(v){case"region":for(let x=i.length-1;x>=0;x--)if(i[x].id===T){d.set(v,i[x].region);break}break;case"vertical":d.alt(v,T,["rl","lr"]);break;case"line":E=T.split(","),d.integer(v,E[0]),d.percent(v,E[0])&&d.set("snapToLines",!1),d.alt(v,E[0],["auto"]),E.length===2&&d.alt("lineAlign",E[1],["start",xl,"end"]);break;case"position":E=T.split(","),d.percent(v,E[0]),E.length===2&&d.alt("positionAlign",E[1],["start",xl,"end","line-left","line-right","auto"]);break;case"size":d.percent(v,T);break;case"align":d.alt(v,T,["start",xl,"end","left","right"]);break}},/:/,/\s/),h.region=d.get("region",null),h.vertical=d.get("vertical","");let g=d.get("line","auto");g==="auto"&&Qc.line===-1&&(g=-1),h.line=g,h.lineAlign=d.get("lineAlign","start"),h.snapToLines=d.get("snapToLines",!0),h.size=d.get("size",100),h.align=d.get("align",xl);let y=d.get("position","auto");y==="auto"&&Qc.position===50&&(y=h.align==="start"||h.align==="left"?0:h.align==="end"||h.align==="right"?100:50),h.position=y}function u(){l=l.replace(/^\s+/,"")}if(u(),t.startTime=r(),u(),l.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+s);l=l.slice(3),u(),t.endTime=r(),u(),o(l,t)}function Np(l){return l.replace(/<br(?: \/)?>/gi,`
`)}class JA{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new WA,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const i=this;t&&(i.buffer+=i.decoder.decode(t,{stream:!0}));function s(){let o=i.buffer,u=0;for(o=Np(o);u<o.length&&o[u]!=="\r"&&o[u]!==`
`;)++u;const f=o.slice(0,u);return o[u]==="\r"&&++u,o[u]===`
`&&++u,i.buffer=o.slice(u),f}function r(o){kp(o,function(u,f){},/:/)}try{let o="";if(i.state==="INITIAL"){if(!/\r\n|\n/.test(i.buffer))return this;o=s();const f=o.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(f!=null&&f[0]))throw new Error("Malformed WebVTT signature.");i.state="HEADER"}let u=!1;for(;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(u?u=!1:o=s(),i.state){case"HEADER":/:/.test(o)?r(o):o||(i.state="ID");continue;case"NOTE":o||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){i.state="NOTE";break}if(!o)continue;if(i.cue=new bf(0,0,""),i.state="CUE",o.indexOf("-->")===-1){i.cue.id=o;continue}case"CUE":if(!i.cue){i.state="BADCUE";continue}try{ZA(o,i.cue,i.regionList)}catch{i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":{const f=o.indexOf("-->")!==-1;if(!o||f&&(u=!0)){i.oncue&&i.cue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}if(i.cue===null)continue;i.cue.text&&(i.cue.text+=`
`),i.cue.text+=o}continue;case"BADCUE":o||(i.state="ID")}}}catch{i.state==="CUETEXT"&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state=i.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(i){t.onparsingerror&&t.onparsingerror(i)}return t.onflush&&t.onflush(),this}}const tb=/\r\n|\n\r|\n|\r/g,Ic=function(t,i,s=0){return t.slice(s,s+i.length)===i},eb=function(t){let i=parseInt(t.slice(-3));const s=parseInt(t.slice(-6,-4)),r=parseInt(t.slice(-9,-7)),o=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!ot(i)||!ot(s)||!ot(r)||!ot(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return i+=1e3*s,i+=60*1e3*r,i+=60*60*1e3*o,i},wc=function(t){let i=5381,s=t.length;for(;s;)i=i*33^t.charCodeAt(--s);return(i>>>0).toString()};function Rf(l,t,i){return wc(l.toString())+wc(t.toString())+wc(i)}const ib=function(t,i,s){let r=t[i],o=t[r.prevCC];if(!o||!o.new&&r.new){t.ccOffset=t.presentationOffset=r.start,r.new=!1;return}for(;(u=o)!=null&&u.new;){var u;t.ccOffset+=r.start-o.start,r.new=!1,r=o,o=t[r.prevCC]}t.presentationOffset=s};function nb(l,t,i,s,r,o,u){const f=new JA,h=pi(new Uint8Array(l)).trim().replace(tb,`
`).split(`
`),d=[],g=t?TA(t.baseTime,t.timescale):0;let y="00:00.000",v=0,T=0,E,x=!0;f.oncue=function(A){const R=i[s];let O=i.ccOffset;const _=(v-g)/9e4;if(R!=null&&R.new&&(T!==void 0?O=i.ccOffset=R.start:ib(i,s,_)),_){if(!t){E=new Error("Missing initPTS for VTT MPEGTS");return}O=_-i.presentationOffset}const F=A.endTime-A.startTime,I=je((A.startTime+O-T)*9e4,r*9e4)/9e4;A.startTime=Math.max(I,0),A.endTime=Math.max(I+F,0);const V=A.text.trim();A.text=decodeURIComponent(encodeURIComponent(V)),A.id||(A.id=Rf(A.startTime,A.endTime,V)),A.endTime>0&&d.push(A)},f.onparsingerror=function(A){E=A},f.onflush=function(){if(E){u(E);return}o(d)},h.forEach(A=>{if(x)if(Ic(A,"X-TIMESTAMP-MAP=")){x=!1,A.slice(16).split(",").forEach(R=>{Ic(R,"LOCAL:")?y=R.slice(6):Ic(R,"MPEGTS:")&&(v=parseInt(R.slice(7)))});try{T=eb(y)/1e3}catch(R){E=R}return}else A===""&&(x=!1);f.parse(A+`
`)}),f.flush()}const Mc="stpp.ttml.im1t",Up=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Fp=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,sb={left:"start",center:"center",right:"end",start:"start",end:"end"};function gg(l,t,i,s){const r=xt(new Uint8Array(l),["mdat"]);if(r.length===0){s(new Error("Could not parse IMSC1 mdat"));return}const o=r.map(f=>pi(f)),u=EA(t.baseTime,1,t.timescale);try{o.forEach(f=>i(rb(f,u)))}catch(f){s(f)}}function rb(l,t){const r=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},u=Object.keys(o).reduce((y,v)=>(y[v]=r.getAttribute(`ttp:${v}`)||o[v],y),{}),f=r.getAttribute("xml:space")!=="preserve",h=pg(kc(r,"styling","style")),d=pg(kc(r,"layout","region")),g=kc(r,"body","[begin]");return[].map.call(g,y=>{const v=Bp(y,f);if(!v||!y.hasAttribute("begin"))return null;const T=Uc(y.getAttribute("begin"),u),E=Uc(y.getAttribute("dur"),u);let x=Uc(y.getAttribute("end"),u);if(T===null)throw yg(y);if(x===null){if(E===null)throw yg(y);x=T+E}const A=new bf(T-t,x-t,v);A.id=Rf(A.startTime,A.endTime,A.text);const R=d[y.getAttribute("region")],O=h[y.getAttribute("style")],_=ab(R,O,h),{textAlign:F}=_;if(F){const I=sb[F];I&&(A.lineAlign=I),A.align=F}return ie(A,_),A}).filter(y=>y!==null)}function kc(l,t,i){const s=l.getElementsByTagName(t)[0];return s?[].slice.call(s.querySelectorAll(i)):[]}function pg(l){return l.reduce((t,i)=>{const s=i.getAttribute("xml:id");return s&&(t[s]=i),t},{})}function Bp(l,t){return[].slice.call(l.childNodes).reduce((i,s,r)=>{var o;return s.nodeName==="br"&&r?i+`
`:(o=s.childNodes)!=null&&o.length?Bp(s,t):t?i+s.textContent.trim().replace(/\s+/g," "):i+s.textContent},"")}function ab(l,t,i){const s="http://www.w3.org/ns/ttml#styling";let r=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],u=l!=null&&l.hasAttribute("style")?l.getAttribute("style"):null;return u&&i.hasOwnProperty(u)&&(r=i[u]),o.reduce((f,h)=>{const d=Nc(t,s,h)||Nc(l,s,h)||Nc(r,s,h);return d&&(f[h]=d),f},{})}function Nc(l,t,i){return l&&l.hasAttributeNS(t,i)?l.getAttributeNS(t,i):null}function yg(l){return new Error(`Could not parse ttml timestamp ${l}`)}function Uc(l,t){if(!l)return null;let i=Mp(l);return i===null&&(Up.test(l)?i=lb(l,t):Fp.test(l)&&(i=ob(l,t))),i}function lb(l,t){const i=Up.exec(l),s=(i[4]|0)+(i[5]|0)/t.subFrameRate;return(i[1]|0)*3600+(i[2]|0)*60+(i[3]|0)+s/t.frameRate}function ob(l,t){const i=Fp.exec(l),s=Number(i[1]);switch(i[2]){case"h":return s*3600;case"m":return s*60;case"ms":return s*1e3;case"f":return s/t.frameRate;case"t":return s/t.tickRate}return s}class ub{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Eg(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(b.FRAG_LOADING,this.onFragLoading,this),t.on(b.FRAG_LOADED,this.onFragLoaded,this),t.on(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(b.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(b.FRAG_LOADING,this.onFragLoading,this),t.off(b.FRAG_LOADED,this.onFragLoaded,this),t.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const t=new Sl(this,"textTrack1"),i=new Sl(this,"textTrack2"),s=new Sl(this,"textTrack3"),r=new Sl(this,"textTrack4");this.cea608Parser1=new mg(1,t,i),this.cea608Parser2=new mg(3,s,r)}}addCues(t,i,s,r,o){let u=!1;for(let f=o.length;f--;){const h=o[f],d=cb(h[0],h[1],i,s);if(d>=0&&(h[0]=Math.min(h[0],i),h[1]=Math.max(h[1],s),u=!0,d/(s-i)>.5))return}if(u||o.push([i,s]),this.config.renderTextTracksNatively){const f=this.captionsTracks[t];this.Cues.newCue(f,i,s,r)}else{const f=this.Cues.newCue(null,i,s,r);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:f,track:t})}}onInitPtsFound(t,{frag:i,id:s,initPTS:r,timescale:o}){const{unparsedVttFrags:u}=this;s==="main"&&(this.initPTS[i.cc]={baseTime:r,timescale:o}),u.length&&(this.unparsedVttFrags=[],u.forEach(f=>{this.onFragLoaded(b.FRAG_LOADED,f)}))}getExistingTrack(t,i){const{media:s}=this;if(s)for(let r=0;r<s.textTracks.length;r++){const o=s.textTracks[r];if(vg(o,{name:t,lang:i}))return o}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:i,captionsTracks:s,media:r}=this,{label:o,languageCode:u}=i[t],f=this.getExistingTrack(o,u);if(f)s[t]=f,Ms(s[t]),sp(s[t],r);else{const h=this.createTextTrack("captions",o,u);h&&(h[t]=!0,s[t]=h)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const i=this.captionsProperties[t];if(!i)return;const s=i.label,r={_id:t,label:s,kind:"captions",default:i.media?!!i.media.default:!1,closedCaptions:i.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(t,i,s){const r=this.media;if(r)return r.addTextTrack(t,i,s)}onMediaAttaching(t,i){this.media=i.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:t}=this;Object.keys(t).forEach(i=>{Ms(t[i]),delete t[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Eg(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const i=t.textTracks;if(i)for(let s=0;s<i.length;s++)Ms(i[s])}onSubtitleTracksUpdated(t,i){const s=i.subtitleTracks||[],r=s.some(o=>o.textCodec===Mc);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(Op(this.tracks,s)){this.tracks=s;return}if(this.textTracks=[],this.tracks=s,this.config.renderTextTracksNatively){const u=this.media,f=u?Dl(u.textTracks):null;if(this.tracks.forEach((h,d)=>{let g;if(f){let y=null;for(let v=0;v<f.length;v++)if(f[v]&&vg(f[v],h)){y=f[v],f[v]=null;break}y&&(g=y)}if(g)Ms(g);else{const y=Pp(h);g=this.createTextTrack(y,h.name,h.lang),g&&(g.mode="disabled")}g&&this.textTracks.push(g)}),f!=null&&f.length){const h=f.filter(d=>d!==null).map(d=>d.label);h.length&&N.warn(`Media element contains unused subtitle tracks: ${h.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const u=this.tracks.map(f=>({label:f.name,kind:f.type.toLowerCase(),default:f.default,subtitleTrack:f}));this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:u})}}}onManifestLoaded(t,i){this.config.enableCEA708Captions&&i.captions&&i.captions.forEach(s=>{const r=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(!r)return;const o=`textTrack${r[1]}`,u=this.captionsProperties[o];u&&(u.label=s.name,s.lang&&(u.languageCode=s.lang),u.media=s)})}closedCaptionsForLevel(t){const i=this.hls.levels[t.level];return i==null?void 0:i.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,i){if(this.enabled&&i.frag.type===vt.MAIN){var s,r;const{cea608Parser1:o,cea608Parser2:u,lastSn:f}=this,{cc:h,sn:d}=i.frag,g=(s=(r=i.part)==null?void 0:r.index)!=null?s:-1;o&&u&&(d!==f+1||d===f&&g!==this.lastPartIndex+1||h!==this.lastCc)&&(o.reset(),u.reset()),this.lastCc=h,this.lastSn=d,this.lastPartIndex=g}}onFragLoaded(t,i){const{frag:s,payload:r}=i;if(s.type===vt.SUBTITLE)if(r.byteLength){const o=s.decryptdata,u="stats"in i;if(o==null||!o.encrypted||u){const f=this.tracks[s.level],h=this.vttCCs;h[s.cc]||(h[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),f&&f.textCodec===Mc?this._parseIMSC1(s,r):this._parseVTTs(i)}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,i){const s=this.hls;gg(i,this.initPTS[t.cc],r=>{this._appendCues(r,t.level),s.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},r=>{N.log(`Failed to parse IMSC1: ${r}`),s.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:r})})}_parseVTTs(t){var i;const{frag:s,payload:r}=t,{initPTS:o,unparsedVttFrags:u}=this,f=o.length-1;if(!o[s.cc]&&f===-1){u.push(t);return}const h=this.hls,d=(i=s.initSegment)!=null&&i.data?Xe(s.initSegment.data,new Uint8Array(r)):r;nb(d,this.initPTS[s.cc],this.vttCCs,s.cc,s.start,g=>{this._appendCues(g,s.level),h.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:s})},g=>{const y=g.message==="Missing initPTS for VTT MPEGTS";y?u.push(t):this._fallbackToIMSC1(s,r),N.log(`Failed to parse VTT cue: ${g}`),!(y&&f>s.cc)&&h.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:g})})}_fallbackToIMSC1(t,i){const s=this.tracks[t.level];s.textCodec||gg(i,this.initPTS[t.cc],()=>{s.textCodec=Mc,this._parseIMSC1(t,i)},()=>{s.textCodec="wvtt"})}_appendCues(t,i){const s=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[i];if(!r||r.mode==="disabled")return;t.forEach(o=>rp(r,o))}else{const r=this.tracks[i];if(!r)return;const o=r.default?"default":"subtitles"+i;s.trigger(b.CUES_PARSED,{type:"subtitles",cues:t,track:o})}}onFragDecrypted(t,i){const{frag:s}=i;s.type===vt.SUBTITLE&&this.onFragLoaded(b.FRAG_LOADED,i)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,i){this.initCea608Parsers();const{cea608Parser1:s,cea608Parser2:r}=this;if(!this.enabled||!s||!r)return;const{frag:o,samples:u}=i;if(!(o.type===vt.MAIN&&this.closedCaptionsForLevel(o)==="NONE"))for(let f=0;f<u.length;f++){const h=u[f].bytes;if(h){const d=this.extractCea608Data(h);s.addData(u[f].pts,d[0]),r.addData(u[f].pts,d[1])}}}onBufferFlushing(t,{startOffset:i,endOffset:s,endOffsetSubtitles:r,type:o}){const{media:u}=this;if(!(!u||u.currentTime<s)){if(!o||o==="video"){const{captionsTracks:f}=this;Object.keys(f).forEach(h=>Vc(f[h],i,s))}if(this.config.renderTextTracksNatively&&i===0&&r!==void 0){const{textTracks:f}=this;Object.keys(f).forEach(h=>Vc(f[h],i,r))}}}extractCea608Data(t){const i=[[],[]],s=t[0]&31;let r=2;for(let o=0;o<s;o++){const u=t[r++],f=127&t[r++],h=127&t[r++];if(f===0&&h===0)continue;if((4&u)!==0){const g=3&u;(g===0||g===1)&&(i[g].push(f),i[g].push(h))}}return i}}function Pp(l){return l.characteristics&&/transcribes-spoken-dialog/gi.test(l.characteristics)&&/describes-music-and-sound/gi.test(l.characteristics)?"captions":"subtitles"}function vg(l,t){return!!l&&l.kind===Pp(t)&&Wc(t,l)}function cb(l,t,i,s){return Math.min(t,s)-Math.max(l,i)}function Eg(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Lf{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(b.BUFFER_CODECS,this.onBufferCodecs,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(b.BUFFER_CODECS,this.onBufferCodecs,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,i){const s=this.hls.levels[i.droppedLevel];this.isLevelAllowed(s)&&this.restrictedLevels.push({bitrate:s.bitrate,height:s.height,width:s.width})}onMediaAttaching(t,i){this.media=i.media instanceof HTMLVideoElement?i.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,i){const s=this.hls;this.restrictedLevels=[],this.firstLevel=i.firstLevel,s.config.capLevelToPlayerSize&&i.video&&this.startCapping()}onLevelsUpdated(t,i){this.timer&&ot(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,i){this.hls.config.capLevelToPlayerSize&&i.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const i=this.hls,s=this.getMaxLevel(t.length-1);s!==this.autoLevelCapping&&N.log(`Setting autoLevelCapping to ${s}: ${t[s].height}p@${t[s].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),i.autoLevelCapping=s,i.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=i.autoLevelCapping}}}getMaxLevel(t){const i=this.hls.levels;if(!i.length)return-1;const s=i.filter((r,o)=>this.isLevelAllowed(r)&&o<=t);return this.clientRect=null,Lf.getMaxLevelByMediaSize(s,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,i={width:0,height:0};if(t){const s=t.getBoundingClientRect();i.width=s.width,i.height=s.height,!i.width&&!i.height&&(i.width=s.right-s.left||t.width||0,i.height=s.bottom-s.top||t.height||0)}return this.clientRect=i,i}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch{}return t}isLevelAllowed(t){return!this.restrictedLevels.some(s=>t.bitrate===s.bitrate&&t.width===s.width&&t.height===s.height)}static getMaxLevelByMediaSize(t,i,s){if(!(t!=null&&t.length))return-1;const r=(f,h)=>h?f.width!==h.width||f.height!==h.height:!0;let o=t.length-1;const u=Math.max(i,s);for(let f=0;f<t.length;f+=1){const h=t[f];if((h.width>=u||h.height>=u)&&r(h,t[f+1])){o=f;break}}return o}}class fb{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,i){const s=this.hls.config;if(s.capLevelOnFPSDrop){const r=i.media instanceof self.HTMLVideoElement?i.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}}checkFPS(t,i,s){const r=performance.now();if(i){if(this.lastTime){const o=r-this.lastTime,u=s-this.lastDroppedFrames,f=i-this.lastDecodedFrames,h=1e3*u/o,d=this.hls;if(d.trigger(b.FPS_DROP,{currentDropped:u,currentDecoded:f,totalDroppedFrames:s}),h>0&&u>d.config.fpsDroppedMonitoringThreshold*f){let g=d.currentLevel;N.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=g)&&(g=g-1,d.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:d.currentLevel}),d.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=s,this.lastDecodedFrames=i}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const i=t.getVideoPlaybackQuality();this.checkFPS(t,i.totalVideoFrames,i.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}const Al="[eme]";class ks{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=ks.CDMCleanupPromise?[ks.CDMCleanupPromise]:[],this.debug=N.debug.bind(N,Al),this.log=N.log.bind(N,Al),this.warn=N.warn.bind(N,Al),this.error=N.error.bind(N,Al),this.onMediaEncrypted=i=>{const{initDataType:s,initData:r}=i,o=`"${i.type}" event: init data type: "${s}"`;if(this.debug(o),r!==null){if(!this.keyFormatPromise){let u=Object.keys(this.keySystemAccessPromises);u.length||(u=dl(this.config));const f=u.map(vc).filter(h=>!!h);this.keyFormatPromise=this.getKeyFormatPromise(f)}this.keyFormatPromise.then(u=>{const f=pc(u);let h,d;if(s==="sinf"){if(f!==kt.FAIRPLAY){this.warn(`Ignoring unexpected "${i.type}" event with init data type: "${s}" for selected key-system ${f}`);return}const E=re(new Uint8Array(r));try{const x=ff(JSON.parse(E).sinf),A=Jg(x);if(!A)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");h=A.subarray(8,24),d=kt.FAIRPLAY}catch(x){this.warn(`${o} Failed to parse sinf: ${x}`);return}}else{if(f!==kt.WIDEVINE&&f!==kt.PLAYREADY){this.warn(`Ignoring unexpected "${i.type}" event with init data type: "${s}" for selected key-system ${f}`);return}const E=HS(r),x=E.filter(R=>!!R.systemId&&yc(R.systemId)===f);x.length>1&&this.warn(`${o} Using first of ${x.length} pssh found for selected key-system ${f}`);const A=x[0];if(!A){E.length===0||E.some(R=>!R.systemId)?this.warn(`${o} contains incomplete or invalid pssh data`):this.log(`ignoring ${o} for ${E.map(R=>yc(R.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(d=yc(A.systemId),A.version===0&&A.data)if(d===kt.WIDEVINE){const R=A.data.length-22;h=A.data.subarray(R,R+16)}else d===kt.PLAYREADY&&(h=Kg(A.data))}if(!d||!h){this.log(`Unable to handle ${o} with key-system ${f}`);return}const g=fi.hexDump(h),{keyIdToKeySessionPromise:y,mediaKeySessions:v}=this;let T=y[g];for(let E=0;E<v.length;E++){const x=v[E],A=x.decryptdata;if(!A.keyId)continue;const R=fi.hexDump(A.keyId);if(g===R||A.uri.replace(/-/g,"").indexOf(g)!==-1){if(T=y[R],A.pssh)break;delete y[R],A.pssh=new Uint8Array(r),A.keyId=h,T=y[g]=T.then(()=>this.generateRequestWithPreferredKeySession(x,s,r,"encrypted-event-key-match")),T.catch(O=>this.handleError(O));break}}if(!T){if(d!==f){this.log(`Ignoring "${o}" with ${d} init data for selected key-system ${f}`);return}T=y[g]=this.getKeySystemSelectionPromise([d]).then(({keySystem:E,mediaKeys:x})=>{var A;this.throwIfDestroyed();const R=new Kr("ISO-23001-7",g,(A=vc(E))!=null?A:"");return R.pssh=new Uint8Array(r),R.keyId=h,this.attemptSetMediaKeys(E,x).then(()=>{this.throwIfDestroyed();const O=this.createMediaKeySessionContext({decryptdata:R,keySystem:E,mediaKeys:x});return this.generateRequestWithPreferredKeySession(O,s,r,"encrypted-event-no-match")})}),T.catch(E=>this.handleError(E))}})}},this.onWaitingForKey=i=>{this.log(`"${i.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:i,widevineLicenseUrl:s}=this.config,r=i[t];if(r)return r.licenseUrl;if(t===kt.WIDEVINE&&s)return s}getLicenseServerUrlOrThrow(t){const i=this.getLicenseServerUrl(t);if(i===void 0)throw new Error(`no license server URL configured for key-system "${t}"`);return i}getServerCertificateUrl(t){const{drmSystems:i}=this.config,s=i[t];if(s)return s.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const i=this.hls.levels,s=(u,f,h)=>!!u&&h.indexOf(u)===f,r=i.map(u=>u.audioCodec).filter(s),o=i.map(u=>u.videoCodec).filter(s);return r.length+o.length===0&&o.push("avc1.42e01e"),new Promise((u,f)=>{const h=d=>{const g=d.shift();this.getMediaKeysPromise(g,r,o).then(y=>u({keySystem:g,mediaKeys:y})).catch(y=>{d.length?h(d):y instanceof qe?f(y):f(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_ACCESS,error:y,fatal:!0},y.message))})};h(t)})}requestMediaKeySystemAccess(t,i){const{requestMediaKeySystemAccessFunc:s}=this.config;if(typeof s!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${s}`;return Vg===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return s(t,i)}getMediaKeysPromise(t,i,s){const r=yS(t,i,s,this.config.drmSystemOptions),o=this.keySystemAccessPromises[t];let u=o==null?void 0:o.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(r)}`),u=this.requestMediaKeySystemAccess(t,r);const f=this.keySystemAccessPromises[t]={keySystemAccess:u};return u.catch(h=>{this.log(`Failed to obtain access to key-system "${t}": ${h}`)}),u.then(h=>{this.log(`Access for key-system "${h.keySystem}" obtained`);const d=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),f.mediaKeys=h.createMediaKeys().then(g=>(this.log(`Media-keys created for "${t}"`),d.then(y=>y?this.setMediaKeysServerCertificate(g,t,y):g))),f.mediaKeys.catch(g=>{this.error(`Failed to create media-keys for "${t}"}: ${g}`)}),f.mediaKeys})}return u.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:i,mediaKeys:s}){this.log(`Creating key-system session "${i}" keyId: ${fi.hexDump(t.keyId||[])}`);const r=s.createSession(),o={decryptdata:t,keySystem:i,mediaKeys:s,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(t){const i=t.decryptdata;if(i.pssh){const s=this.createMediaKeySessionContext(t),r=this.getKeyIdString(i),o="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(s,o,i.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return fi.hexDump(t.keyId)}updateKeySession(t,i){var s;const r=t.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${fi.hexDump(((s=t.decryptdata)==null?void 0:s.keyId)||[])}
      } (data length: ${i&&i.byteLength})`),r.update(i)}selectKeySystemFormat(t){const i=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((i,s)=>{const r=dl(this.config),o=t.map(pc).filter(u=>!!u&&r.indexOf(u)!==-1);return this.getKeySystemSelectionPromise(o).then(({keySystem:u})=>{const f=vc(u);f?i(f):s(new Error(`Unable to find format for key-system "${u}"`))}).catch(s)})}loadKey(t){const i=t.keyInfo.decryptdata,s=this.getKeyIdString(i),r=`(keyId: ${s} format: "${i.keyFormat}" method: ${i.method} uri: ${i.uri})`;this.log(`Starting session for key ${r}`);let o=this.keyIdToKeySessionPromise[s];return o||(o=this.keyIdToKeySessionPromise[s]=this.getKeySystemForKeyPromise(i).then(({keySystem:u,mediaKeys:f})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${r}`),this.attemptSetMediaKeys(u,f).then(()=>{this.throwIfDestroyed();const h=this.createMediaKeySessionContext({keySystem:u,mediaKeys:f,decryptdata:i});return this.generateRequestWithPreferredKeySession(h,"cenc",i.pssh,"playlist-key")}))),o.catch(u=>this.handleError(u))),o}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof qe?this.hls.trigger(b.ERROR,t.data):this.hls.trigger(b.ERROR,{type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const i=this.getKeyIdString(t),s=this.keyIdToKeySessionPromise[i];if(!s){const r=pc(t.keyFormat),o=r?[r]:dl(this.config);return this.attemptKeySystemAccess(o)}return s}getKeySystemSelectionPromise(t){if(t.length||(t=dl(this.config)),t.length===0)throw new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,i){const s=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const r=Promise.all(s).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(i)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${t}"`),s.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>s.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(t,i,s,r){var o,u;const f=(o=this.config.drmSystems)==null||(u=o[t.keySystem])==null?void 0:u.generateRequest;if(f)try{const E=f.call(this.hls,i,s,t);if(!E)throw new Error("Invalid response from configured generateRequest filter");i=E.initDataType,s=t.decryptdata.pssh=E.initData?new Uint8Array(E.initData):null}catch(E){var h;if(this.warn(E.message),(h=this.hls)!=null&&h.config.debug)throw E}if(s===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(t);const d=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${r}": ${d} (init data type: ${i} length: ${s?s.byteLength:null})`);const g=new Af,y=t._onmessage=E=>{const x=t.mediaKeysSession;if(!x){g.emit("error",new Error("invalid state"));return}const{messageType:A,message:R}=E;this.log(`"${A}" message event for session "${x.sessionId}" message size: ${R.byteLength}`),A==="license-request"||A==="license-renewal"?this.renewLicense(t,R).catch(O=>{this.handleError(O),g.emit("error",O)}):A==="license-release"?t.keySystem===kt.FAIRPLAY&&(this.updateKeySession(t,Hc("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${A}"`)},v=t._onkeystatuseschange=E=>{if(!t.mediaKeysSession){g.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);const A=t.keyStatus;g.emit("keyStatus",A),A==="expired"&&(this.warn(`${t.keySystem} expired for key ${d}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",y),t.mediaKeysSession.addEventListener("keystatuseschange",v);const T=new Promise((E,x)=>{g.on("error",x),g.on("keyStatus",A=>{A.startsWith("usable")?E():A==="output-restricted"?x(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):A==="internal-error"?x(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${A}"`)):A==="expired"?x(new Error("key expired while generating request")):this.warn(`unhandled key status change "${A}"`)})});return t.mediaKeysSession.generateRequest(i,s).then(()=>{var E;this.log(`Request generated for key-session "${(E=t.mediaKeysSession)==null?void 0:E.sessionId}" keyId: ${d}`)}).catch(E=>{throw new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_SESSION,error:E,fatal:!1},`Error generating key-session request: ${E}`)}).then(()=>T).catch(E=>{throw g.removeAllListeners(),this.removeSession(t),E}).then(()=>(g.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((i,s)=>{this.log(`key status change "${i}" for keyStatuses keyId: ${fi.hexDump("buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s))} session keyId: ${fi.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=i})}fetchServerCertificate(t){const i=this.config,s=i.loader,r=new s(i),o=this.getServerCertificateUrl(t);return o?(this.log(`Fetching server certificate for "${t}"`),new Promise((u,f)=>{const h={responseType:"arraybuffer",url:o},d=i.certLoadPolicy.default,g={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},y={onSuccess:(v,T,E,x)=>{u(v.data)},onError:(v,T,E,x)=>{f(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:he({url:h.url,data:void 0},v)},`"${t}" certificate request failed (${o}). Status: ${v.code} (${v.text})`))},onTimeout:(v,T,E)=>{f(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:h.url,data:void 0}},`"${t}" certificate request timed out (${o})`))},onAbort:(v,T,E)=>{f(new Error("aborted"))}};r.load(h,g,y)})):Promise.resolve()}setMediaKeysServerCertificate(t,i,s){return new Promise((r,o)=>{t.setServerCertificate(s).then(u=>{this.log(`setServerCertificate ${u?"success":"not supported by CDM"} (${s==null?void 0:s.byteLength}) on "${i}"`),r(t)}).catch(u=>{o(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:u,fatal:!0},u.message))})})}renewLicense(t,i){return this.requestLicense(t,new Uint8Array(i)).then(s=>this.updateKeySession(t,new Uint8Array(s)).catch(r=>{throw new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(t,i){const s=String.fromCharCode.apply(null,new Uint16Array(i.buffer));if(!s.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),i;const r=new DOMParser().parseFromString(s,"application/xml"),o=r.querySelectorAll("HttpHeader");if(o.length>0){let g;for(let y=0,v=o.length;y<v;y++){var u,f;g=o[y];const T=(u=g.querySelector("name"))==null?void 0:u.textContent,E=(f=g.querySelector("value"))==null?void 0:f.textContent;T&&E&&t.setRequestHeader(T,E)}}const h=r.querySelector("Challenge"),d=h==null?void 0:h.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Hc(atob(d))}setupLicenseXHR(t,i,s,r){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!s.decryptdata)throw new Error("Key removed");return o.call(this.hls,t,i,s,r)}).catch(u=>{if(!s.decryptdata)throw u;return t.open("POST",i,!0),o.call(this.hls,t,i,s,r)}).then(u=>(t.readyState||t.open("POST",i,!0),{xhr:t,licenseChallenge:u||r})):(t.open("POST",i,!0),Promise.resolve({xhr:t,licenseChallenge:r}))}requestLicense(t,i){const s=this.config.keyLoadPolicy.default;return new Promise((r,o)=>{const u=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${u}`);const f=new XMLHttpRequest;f.responseType="arraybuffer",f.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return o(new Error("invalid state"));if(f.readyState===4)if(f.status===200){this._requestLicenseFailureCount=0;let h=f.response;this.log(`License received ${h instanceof ArrayBuffer?h.byteLength:h}`);const d=this.config.licenseResponseCallback;if(d)try{h=d.call(this.hls,f,u,t)}catch(g){this.error(g)}r(h)}else{const h=s.errorRetry,d=h?h.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||f.status>=400&&f.status<500)o(new qe({type:Tt.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:f,response:{url:u,data:void 0,code:f.status,text:f.statusText}},`License Request XHR failed (${u}). Status: ${f.status} (${f.statusText})`));else{const g=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${g} attempts left`),this.requestLicense(t,i).then(r,o)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=f,this.setupLicenseXHR(f,u,t,i).then(({xhr:h,licenseChallenge:d})=>{t.keySystem==kt.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(h,d)),h.send(d)})})}onMediaAttached(t,i){if(!this.config.emeEnabled)return;const s=i.media;this.media=s,s.removeEventListener("encrypted",this.onMediaEncrypted),s.removeEventListener("waitingforkey",this.onWaitingForKey),s.addEventListener("encrypted",this.onMediaEncrypted),s.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,i=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Kr.clearKeyUriToKeyIdMap();const s=i.length;ks.CDMCleanupPromise=Promise.all(i.map(r=>this.removeSession(r)).concat(t==null?void 0:t.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}`)}))).then(()=>{s&&(this.log("finished closing key sessions and clearing media keys"),i.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:i}){if(!(!i||!this.config.emeEnabled)&&!this.keyFormatPromise){const s=i.reduce((r,o)=>(r.indexOf(o.keyFormat)===-1&&r.push(o.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${s.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(s)}}removeSession(t){const{mediaKeysSession:i,licenseXhr:s}=t;if(i){this.log(`Remove licenses and keys and close session ${i.sessionId}`),t._onmessage&&(i.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(i.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),s&&s.readyState!==XMLHttpRequest.DONE&&s.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(t);return r>-1&&this.mediaKeySessions.splice(r,1),i.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>i.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}ks.CDMCleanupPromise=void 0;class qe extends Error{constructor(t,i){super(i),this.data=void 0,t.error||(t.error=new Error(i)),this.data=t,t.err=t.error}}var Te;(function(l){l.MANIFEST="m",l.AUDIO="a",l.VIDEO="v",l.MUXED="av",l.INIT="i",l.CAPTION="c",l.TIMED_TEXT="tt",l.KEY="k",l.OTHER="o"})(Te||(Te={}));var Zc;(function(l){l.DASH="d",l.HLS="h",l.SMOOTH="s",l.OTHER="o"})(Zc||(Zc={}));var zn;(function(l){l.OBJECT="CMCD-Object",l.REQUEST="CMCD-Request",l.SESSION="CMCD-Session",l.STATUS="CMCD-Status"})(zn||(zn={}));const hb={[zn.OBJECT]:["br","d","ot","tb"],[zn.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[zn.SESSION]:["cid","pr","sf","sid","st","v"],[zn.STATUS]:["bs","rtp"]};class Fs{constructor(t,i){this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map(s=>s instanceof Fs?s:new Fs(s))),this.value=t,this.params=i}}class Gp{constructor(t){this.description=void 0,this.description=t}}const db="Dict";function mb(l){return Array.isArray(l)?JSON.stringify(l):l instanceof Map?"Map{}":l instanceof Set?"Set{}":typeof l=="object"?JSON.stringify(l):String(l)}function gb(l,t,i,s){return new Error(`failed to ${l} "${mb(t)}" as ${i}`,{cause:s})}const Tg="Bare Item",pb="Boolean",yb="Byte Sequence",vb="Decimal",Eb="Integer";function Tb(l){return l<-999999999999999||999999999999999<l}const Sb=/[\x00-\x1f\x7f]+/,xb="Token",Ab="Key";function vi(l,t,i){return gb("serialize",l,t,i)}function bb(l){if(typeof l!="boolean")throw vi(l,pb);return l?"?1":"?0"}function Rb(l){return btoa(String.fromCharCode(...l))}function Lb(l){if(ArrayBuffer.isView(l)===!1)throw vi(l,yb);return`:${Rb(l)}:`}function $p(l){if(Tb(l))throw vi(l,Eb);return l.toString()}function Db(l){return`@${$p(l.getTime()/1e3)}`}function Hp(l,t){if(l<0)return-Hp(-l,t);const i=Math.pow(10,t);if(Math.abs(l*i%1-.5)<Number.EPSILON){const r=Math.floor(l*i);return(r%2===0?r:r+1)/i}else return Math.round(l*i)/i}function Cb(l){const t=Hp(l,3);if(Math.floor(Math.abs(t)).toString().length>12)throw vi(l,vb);const i=t.toString();return i.includes(".")?i:`${i}.0`}const _b="String";function Ob(l){if(Sb.test(l))throw vi(l,_b);return`"${l.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Ib(l){return l.description||l.toString().slice(7,-1)}function Sg(l){const t=Ib(l);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw vi(t,xb);return t}function Jc(l){switch(typeof l){case"number":if(!ot(l))throw vi(l,Tg);return Number.isInteger(l)?$p(l):Cb(l);case"string":return Ob(l);case"symbol":return Sg(l);case"boolean":return bb(l);case"object":if(l instanceof Date)return Db(l);if(l instanceof Uint8Array)return Lb(l);if(l instanceof Gp)return Sg(l);default:throw vi(l,Tg)}}function tf(l){if(/^[a-z*][a-z0-9\-_.*]*$/.test(l)===!1)throw vi(l,Ab);return l}function Df(l){return l==null?"":Object.entries(l).map(([t,i])=>i===!0?`;${tf(t)}`:`;${tf(t)}=${Jc(i)}`).join("")}function zp(l){return l instanceof Fs?`${Jc(l.value)}${Df(l.params)}`:Jc(l)}function wb(l){return`(${l.value.map(zp).join(" ")})${Df(l.params)}`}function Mb(l,t={whitespace:!0}){if(typeof l!="object")throw vi(l,db);const i=l instanceof Map?l.entries():Object.entries(l),s=t!=null&&t.whitespace?" ":"";return Array.from(i).map(([r,o])=>{o instanceof Fs||(o=new Fs(o));let u=tf(r);return o.value===!0?u+=Df(o.params):(u+="=",Array.isArray(o.value)?u+=wb(o):u+=zp(o)),u}).join(`,${s}`)}function kb(l,t){return Mb(l,t)}const Nb=l=>l==="ot"||l==="sf"||l==="st",Ub=l=>typeof l=="number"?ot(l):l!=null&&l!==""&&l!==!1;function Fb(l,t){const i=new URL(l),s=new URL(t);if(i.origin!==s.origin)return l;const r=i.pathname.split("/").slice(1),o=s.pathname.split("/").slice(1,-1);for(;r[0]===o[0];)r.shift(),o.shift();for(;o.length;)o.shift(),r.unshift("..");return r.join("/")}function Bb(){try{return crypto.randomUUID()}catch{try{const t=URL.createObjectURL(new Blob),i=t.toString();return URL.revokeObjectURL(t),i.slice(i.lastIndexOf("/")+1)}catch{let i=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const o=(i+Math.random()*16)%16|0;return i=Math.floor(i/16),(r=="x"?o:o&3|8).toString(16)})}}}const Ml=l=>Math.round(l),Pb=(l,t)=>(t!=null&&t.baseUrl&&(l=Fb(l,t.baseUrl)),encodeURIComponent(l)),bl=l=>Ml(l/100)*100,Gb={br:Ml,d:Ml,bl,dl:bl,mtp:bl,nor:Pb,rtp:bl,tb:Ml};function $b(l,t){const i={};if(l==null||typeof l!="object")return i;const s=Object.keys(l).sort(),r=ie({},Gb,t==null?void 0:t.formatters),o=t==null?void 0:t.filter;return s.forEach(u=>{if(o!=null&&o(u))return;let f=l[u];const h=r[u];h&&(f=h(f,t)),!(u==="v"&&f===1)&&(u=="pr"&&f===1||Ub(f)&&(Nb(u)&&typeof f=="string"&&(f=new Gp(f)),i[u]=f))}),i}function Vp(l,t={}){return l?kb($b(l,t),ie({whitespace:!1},t)):""}function Hb(l,t={}){if(!l)return{};const i=Object.entries(l),s=Object.entries(hb).concat(Object.entries((t==null?void 0:t.customHeaderMap)||{})),r=i.reduce((o,u)=>{var f,h;const[d,g]=u,y=((f=s.find(v=>v[1].includes(d)))==null?void 0:f[0])||zn.REQUEST;return(h=o[y])!=null||(o[y]={}),o[y][d]=g,o},{});return Object.entries(r).reduce((o,[u,f])=>(o[u]=Vp(f,t),o),{})}function zb(l,t,i){return ie(l,Hb(t,i))}const Vb="CMCD";function Kb(l,t={}){if(!l)return"";const i=Vp(l,t);return`${Vb}=${encodeURIComponent(i)}`}const xg=/CMCD=[^&#]+/;function Yb(l,t,i){const s=Kb(t,i);if(!s)return l;if(xg.test(l))return l.replace(xg,s);const r=l.includes("?")?"&":"?";return`${l}${r}${s}`}class qb{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:Te.MANIFEST,su:!this.initialized})}catch(o){N.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=r=>{try{const o=r.frag,u=this.hls.levels[o.level],f=this.getObjectType(o),h={d:o.duration*1e3,ot:f};(f===Te.VIDEO||f===Te.AUDIO||f==Te.MUXED)&&(h.br=u.bitrate/1e3,h.tb=this.getTopBandwidth(f)/1e3,h.bl=this.getBufferLength(f)),this.apply(r,h)}catch(o){N.warn("Could not generate segment CMCD data.",o)}},this.hls=t;const i=this.config=t.config,{cmcd:s}=i;s!=null&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=s.sessionId||Bb(),this.cid=s.contentId,this.useHeaders=s.useHeaders===!0,this.includeKeys=s.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHED,this.onMediaDetached,this),t.on(b.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHED,this.onMediaDetached,this),t.off(b.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(t,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,i){var s,r;this.audioBuffer=(s=i.tracks.audio)==null?void 0:s.buffer,this.videoBuffer=(r=i.tracks.video)==null?void 0:r.buffer}createData(){var t;return{v:1,sf:Zc.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,i={}){ie(i,this.createData());const s=i.ot===Te.INIT||i.ot===Te.VIDEO||i.ot===Te.MUXED;this.starved&&s&&(i.bs=!0,i.su=!0,this.starved=!1),i.su==null&&(i.su=this.buffering);const{includeKeys:r}=this;r&&(i=Object.keys(i).reduce((o,u)=>(r.includes(u)&&(o[u]=i[u]),o),{})),this.useHeaders?(t.headers||(t.headers={}),zb(t.headers,i)):t.url=Yb(t.url,i)}getObjectType(t){const{type:i}=t;if(i==="subtitle")return Te.TIMED_TEXT;if(t.sn==="initSegment")return Te.INIT;if(i==="audio")return Te.AUDIO;if(i==="main")return this.hls.audioTracks.length?Te.VIDEO:Te.MUXED}getTopBandwidth(t){let i=0,s;const r=this.hls;if(t===Te.AUDIO)s=r.audioTracks;else{const o=r.maxAutoLevel,u=o>-1?o+1:r.levels.length;s=r.levels.slice(0,u)}for(const o of s)o.bitrate>i&&(i=o.bitrate);return i>0?i:NaN}getBufferLength(t){const i=this.hls.media,s=t===Te.AUDIO?this.audioBuffer:this.videoBuffer;return!s||!i?NaN:Ht.bufferInfo(s,i.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,i=this.applyPlaylistData,s=t||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new s(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,u,f){i(o),this.loader.load(o,u,f)}}}createFragmentLoader(){const{fLoader:t}=this.config,i=this.applyFragmentData,s=t||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new s(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,u,f){i(o),this.loader.load(o,u,f)}}}}const jb=3e5;class Xb{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=N.log.bind(N,"[content-steering]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const i=this.levels;i&&(this.levels=i.filter(s=>s!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,i){const{contentSteering:s}=i;s!==null&&(this.pathwayId=s.pathwayId,this.uri=s.uri,this.started&&this.startLoad())}onManifestParsed(t,i){this.audioTracks=i.audioTracks,this.subtitleTracks=i.subtitleTracks}onError(t,i){const{errorAction:s}=i;if((s==null?void 0:s.action)===pe.SendAlternateToPenaltyBox&&s.flags===ti.MoveAllAlternatesMatchingHost){const r=this.levels;let o=this.pathwayPriority,u=this.pathwayId;if(i.context){const{groupId:f,pathwayId:h,type:d}=i.context;f&&r?u=this.getPathwayForGroupId(f,d,u):h&&(u=h)}u in this.penalizedPathways||(this.penalizedPathways[u]=performance.now()),!o&&r&&(o=r.reduce((f,h)=>(f.indexOf(h.pathwayId)===-1&&f.push(h.pathwayId),f),[])),o&&o.length>1&&(this.updatePathwayPriority(o),s.resolved=this.pathwayId!==u),s.resolved||N.warn(`Could not resolve ${i.details} ("${i.error.message}") with content-steering for Pathway: ${u} levels: ${r&&r.length} priorities: ${JSON.stringify(o)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let i=this.getLevelsForPathway(this.pathwayId);if(i.length===0){const s=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${s}"`),i=this.getLevelsForPathway(s),this.pathwayId=s}return i.length!==t.length&&this.log(`Found ${i.length}/${t.length} levels in Pathway "${this.pathwayId}"`),i}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(i=>t===i.pathwayId)}updatePathwayPriority(t){this.pathwayPriority=t;let i;const s=this.penalizedPathways,r=performance.now();Object.keys(s).forEach(o=>{r-s[o]>jb&&delete s[o]});for(let o=0;o<t.length;o++){const u=t[o];if(u in s)continue;if(u===this.pathwayId)return;const f=this.hls.nextLoadLevel,h=this.hls.levels[f];if(i=this.getLevelsForPathway(u),i.length>0){this.log(`Setting Pathway to "${u}"`),this.pathwayId=u,up(i),this.hls.trigger(b.LEVELS_UPDATED,{levels:i});const d=this.hls.levels[f];h&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=f);break}}}getPathwayForGroupId(t,i,s){const r=this.getLevelsForPathway(s).concat(this.levels||[]);for(let o=0;o<r.length;o++)if(i===Ot.AUDIO_TRACK&&r[o].hasAudioGroup(t)||i===Ot.SUBTITLE_TRACK&&r[o].hasSubtitleGroup(t))return r[o].pathwayId;return s}clonePathways(t){const i=this.levels;if(!i)return;const s={},r={};t.forEach(o=>{const{ID:u,"BASE-ID":f,"URI-REPLACEMENT":h}=o;if(i.some(g=>g.pathwayId===u))return;const d=this.getLevelsForPathway(f).map(g=>{const y=new qt(g.attrs);y["PATHWAY-ID"]=u;const v=y.AUDIO&&`${y.AUDIO}_clone_${u}`,T=y.SUBTITLES&&`${y.SUBTITLES}_clone_${u}`;v&&(s[y.AUDIO]=v,y.AUDIO=v),T&&(r[y.SUBTITLES]=T,y.SUBTITLES=T);const E=Kp(g.uri,y["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",h),x=new Us({attrs:y,audioCodec:g.audioCodec,bitrate:g.bitrate,height:g.height,name:g.name,url:E,videoCodec:g.videoCodec,width:g.width});if(g.audioGroups)for(let A=1;A<g.audioGroups.length;A++)x.addGroupId("audio",`${g.audioGroups[A]}_clone_${u}`);if(g.subtitleGroups)for(let A=1;A<g.subtitleGroups.length;A++)x.addGroupId("text",`${g.subtitleGroups[A]}_clone_${u}`);return x});i.push(...d),Ag(this.audioTracks,s,h,u),Ag(this.subtitleTracks,r,h,u)})}loadSteeringManifest(t){const i=this.hls.config,s=i.loader;this.loader&&this.loader.destroy(),this.loader=new s(i);let r;try{r=new self.URL(t)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(r.protocol!=="data:"){const g=(this.hls.bandwidthEstimate||i.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+g)}const o={responseType:"json",url:r.href},u=i.steeringManifestLoadPolicy.default,f=u.errorRetry||u.timeoutRetry||{},h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:f.maxNumRetry||0,retryDelay:f.retryDelayMs||0,maxRetryDelay:f.maxRetryDelayMs||0},d={onSuccess:(g,y,v,T)=>{this.log(`Loaded steering manifest: "${r}"`);const E=g.data;if(E.VERSION!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":A,"PATHWAY-PRIORITY":R}=E;if(x)try{this.uri=new self.URL(x,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||v.url),A&&this.clonePathways(A);const O={steeringManifest:E,url:r.toString()};this.hls.trigger(b.STEERING_MANIFEST_LOADED,O),R&&this.updatePathwayPriority(R)},onError:(g,y,v,T)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${y.url})`),this.stopLoad(),g.code===410){this.enabled=!1,this.log(`Steering manifest ${y.url} no longer available`);return}let E=this.timeToLoad*1e3;if(g.code===429){const x=this.loader;if(typeof(x==null?void 0:x.getResponseHeader)=="function"){const A=x.getResponseHeader("Retry-After");A&&(E=parseFloat(A)*1e3)}this.log(`Steering manifest ${y.url} rate limited`);return}this.scheduleRefresh(this.uri||y.url,E)},onTimeout:(g,y,v)=>{this.log(`Timeout loading steering manifest (${y.url})`),this.scheduleRefresh(this.uri||y.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(o,h,d)}scheduleRefresh(t,i=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var s;const r=(s=this.hls)==null?void 0:s.media;if(r&&!r.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},i)}}function Ag(l,t,i,s){l&&Object.keys(t).forEach(r=>{const o=l.filter(u=>u.groupId===r).map(u=>{const f=ie({},u);return f.details=void 0,f.attrs=new qt(f.attrs),f.url=f.attrs.URI=Kp(u.url,u.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),f.groupId=f.attrs["GROUP-ID"]=t[r],f.attrs["PATHWAY-ID"]=s,f});l.push(...o)})}function Kp(l,t,i,s){const{HOST:r,PARAMS:o,[i]:u}=s;let f;t&&(f=u==null?void 0:u[t],f&&(l=f));const h=new self.URL(l);return r&&!f&&(h.host=r),o&&Object.keys(o).sort().forEach(d=>{d&&h.searchParams.set(d,o[d])}),h.href}const Wb=/^age:\s*[\d.]+\s*$/im;class Yp{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Xl,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,i,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=i,this.callbacks=s,this.loadInternal()}loadInternal(){const{config:t,context:i}=this;if(!t||!i)return;const s=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==s||this.stats.aborted))return o(s,i.url)}).catch(u=>{if(!(this.loader!==s||this.stats.aborted))return s.open("GET",i.url,!0),o(s,i.url)}).then(()=>{this.loader!==s||this.stats.aborted||this.openAndSendXhr(s,i,t)}).catch(u=>{this.callbacks.onError({code:s.status,text:u.message},i,s,r)}):this.openAndSendXhr(s,i,t)}openAndSendXhr(t,i,s){t.readyState||t.open("GET",i.url,!0);const r=i.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:u}=s.loadPolicy;if(r)for(const f in r)t.setRequestHeader(f,r[f]);i.rangeEnd&&t.setRequestHeader("Range","bytes="+i.rangeStart+"-"+(i.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=i.responseType,self.clearTimeout(this.requestTimeout),s.timeout=o&&ot(o)?o:u,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.timeout),t.send()}readystatechange(){const{context:t,loader:i,stats:s}=this;if(!t||!i)return;const r=i.readyState,o=this.config;if(!s.aborted&&r>=2&&(s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(s.loading.first-s.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),i.onreadystatechange=null,i.onprogress=null;const u=i.status,f=i.responseType==="text"?i.responseText:null;if(u>=200&&u<300){const y=f??i.response;if(y!=null){s.loading.end=Math.max(self.performance.now(),s.loading.first);const v=i.responseType==="arraybuffer"?y.byteLength:y.length;if(s.loaded=s.total=v,s.bwEstimate=s.total*8e3/(s.loading.end-s.loading.first),!this.callbacks)return;const T=this.callbacks.onProgress;if(T&&T(s,t,y,i),!this.callbacks)return;const E={url:i.responseURL,data:y,code:u};this.callbacks.onSuccess(E,s,t,i);return}}const h=o.loadPolicy.errorRetry,d=s.retry,g={url:t.url,data:void 0,code:u};Hl(h,d,!1,g)?this.retry(h):(N.error(`${u} while loading ${t.url}`),this.callbacks.onError({code:u,text:i.statusText},t,i,s))}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry,i=this.stats.retry;if(Hl(t,i,!0))this.retry(t);else{var s;N.warn(`timeout while loading ${(s=this.context)==null?void 0:s.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:i,stats:s}=this;this.retryDelay=mf(t,s.retry),s.retry++,N.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${i==null?void 0:i.url}, retrying ${s.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total)}getCacheAge(){let t=null;if(this.loader&&Wb.test(this.loader.getAllResponseHeaders())){const i=this.loader.getResponseHeader("age");t=i?parseFloat(i):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}function Qb(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const Zb=/(\d+)-(\d+)\/(\d+)/;class bg{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||iR,this.controller=new self.AbortController,this.stats=new Xl}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,i,s){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const o=Jb(t,this.controller.signal),u=s.onProgress,f=t.responseType==="arraybuffer",h=f?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:g}=i.loadPolicy;this.context=t,this.config=i,this.callbacks=s,this.request=this.fetchSetup(t,o),self.clearTimeout(this.requestTimeout),i.timeout=d&&ot(d)?d:g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),s.onTimeout(r,t,this.response)},i.timeout),self.fetch(this.request).then(y=>{this.response=this.loader=y;const v=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),i.timeout=g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),s.onTimeout(r,t,this.response)},g-(v-r.loading.start)),!y.ok){const{status:T,statusText:E}=y;throw new nR(E||"fetch, bad network response",T,y)}return r.loading.first=v,r.total=eR(y.headers)||r.total,u&&ot(i.highWaterMark)?this.loadProgressively(y,r,t,i.highWaterMark,u):f?y.arrayBuffer():t.responseType==="json"?y.json():y.text()}).then(y=>{const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const T=y[h];T&&(r.loaded=r.total=T);const E={url:v.url,data:y,code:v.status};u&&!ot(i.highWaterMark)&&u(r,t,y,v),s.onSuccess(E,r,t,v)}).catch(y=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const v=y&&y.code||0,T=y?y.message:null;s.onError({code:v,text:T},t,y?y.details:null,r)})}getCacheAge(){let t=null;if(this.response){const i=this.response.headers.get("age");t=i?parseFloat(i):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,i,s,r=0,o){const u=new dp,f=t.body.getReader(),h=()=>f.read().then(d=>{if(d.done)return u.dataLength&&o(i,s,u.flush(),t),Promise.resolve(new ArrayBuffer(0));const g=d.value,y=g.length;return i.loaded+=y,y<r||u.dataLength?(u.push(g),u.dataLength>=r&&o(i,s,u.flush(),t)):o(i,s,g,t),h()}).catch(()=>Promise.reject());return h()}}function Jb(l,t){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(ie({},l.headers))};return l.rangeEnd&&i.headers.set("Range","bytes="+l.rangeStart+"-"+String(l.rangeEnd-1)),i}function tR(l){const t=Zb.exec(l);if(t)return parseInt(t[2])-parseInt(t[1])+1}function eR(l){const t=l.get("Content-Range");if(t){const s=tR(t);if(ot(s))return s}const i=l.get("Content-Length");if(i)return parseInt(i)}function iR(l,t){return new self.Request(l.url,t)}class nR extends Error{constructor(t,i,s){super(t),this.code=void 0,this.details=void 0,this.code=i,this.details=s}}const sR=/\s/,rR={newCue(l,t,i,s){const r=[];let o,u,f,h,d;const g=self.VTTCue||self.TextTrackCue;for(let v=0;v<s.rows.length;v++)if(o=s.rows[v],f=!0,h=0,d="",!o.isEmpty()){var y;for(let x=0;x<o.chars.length;x++)sR.test(o.chars[x].uchar)&&f?h++:(d+=o.chars[x].uchar,f=!1);o.cueStartTime=t,t===i&&(i+=1e-4),h>=16?h--:h++;const T=Np(d.trim()),E=Rf(t,i,T);l!=null&&(y=l.cues)!=null&&y.getCueById(E)||(u=new g(t,i,T),u.id=E,u.line=v+1,u.align="left",u.position=10+Math.min(80,Math.floor(h*8/32)*10),r.push(u))}return l&&r.length&&(r.sort((v,T)=>v.line==="auto"||T.line==="auto"?0:v.line>8&&T.line>8?T.line-v.line:v.line-T.line),r.forEach(v=>rp(l,v))),r}},aR={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},qp=he(he({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Yp,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Mx,bufferController:FA,capLevelController:Lf,errorController:Sx,fpsController:fb,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Vg,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:aR},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},lR()),{},{subtitleStreamController:MA,subtitleTrackController:NA,timelineController:ub,audioStreamController:IA,audioTrackController:wA,emeController:ks,cmcdController:qb,contentSteeringController:Xb});function lR(){return{cueHandler:rR,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function oR(l,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=ef(l),s=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(o=>{const u=`${o==="level"?"playlist":o}LoadPolicy`,f=t[u]===void 0,h=[];r.forEach(d=>{const g=`${o}Loading${d}`,y=t[g];if(y!==void 0&&f){h.push(g);const v=i[u].default;switch(t[u]={default:v},d){case"TimeOut":v.maxLoadTimeMs=y,v.maxTimeToFirstByteMs=y;break;case"MaxRetry":v.errorRetry.maxNumRetry=y,v.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":v.errorRetry.retryDelayMs=y,v.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=y,v.timeoutRetry.maxRetryDelayMs=y;break}}}),h.length&&N.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${u}": ${JSON.stringify(t[u])}`)}),he(he({},i),t)}function ef(l){return l&&typeof l=="object"?Array.isArray(l)?l.map(ef):Object.keys(l).reduce((t,i)=>(t[i]=ef(l[i]),t),{}):l}function uR(l){const t=l.loader;t!==bg&&t!==Yp?(N.log("[config]: Custom loader detected, cannot enable progressive streaming"),l.progressive=!1):Qb()&&(l.loader=bg,l.progressive=!0,l.enableSoftwareAES=!0,N.log("[config]: Progressive streaming enabled, using FetchLoader"))}let Fc;class cR extends gf{constructor(t,i){super(t,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=i,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this),t.on(b.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this),t.off(b.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(i=>{i.loadError=0,i.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,i){this.resetLevels()}onManifestLoaded(t,i){const s=this.hls.config.preferManagedMediaSource,r=[],o={},u={};let f=!1,h=!1,d=!1;i.levels.forEach(g=>{var y,v;const T=g.attrs;let{audioCodec:E,videoCodec:x}=g;((y=E)==null?void 0:y.indexOf("mp4a.40.34"))!==-1&&(Fc||(Fc=/chrome|firefox/i.test(navigator.userAgent)),Fc&&(g.audioCodec=E=void 0)),E&&(g.audioCodec=E=Pl(E,s)),((v=x)==null?void 0:v.indexOf("avc1"))===0&&(x=g.videoCodec=WS(x));const{width:A,height:R,unknownCodecs:O}=g;if(f||(f=!!(A&&R)),h||(h=!!x),d||(d=!!E),O!=null&&O.length||E&&!xc(E,"audio",s)||x&&!xc(x,"video",s))return;const{CODECS:_,"FRAME-RATE":F,"HDCP-LEVEL":I,"PATHWAY-ID":V,RESOLUTION:G,"VIDEO-RANGE":Q}=T,P=`${`${V||"."}-`}${g.bitrate}-${G}-${F}-${_}-${Q}-${I}`;if(o[P])if(o[P].uri!==g.url&&!g.attrs["PATHWAY-ID"]){const J=u[P]+=1;g.attrs["PATHWAY-ID"]=new Array(J+1).join(".");const gt=new Us(g);o[P]=gt,r.push(gt)}else o[P].addGroupId("audio",T.AUDIO),o[P].addGroupId("text",T.SUBTITLES);else{const J=new Us(g);o[P]=J,u[P]=1,r.push(J)}}),this.filterAndSortMediaOptions(r,i,f,h,d)}filterAndSortMediaOptions(t,i,s,r,o){let u=[],f=[],h=t;if((s||r)&&o&&(h=h.filter(({videoCodec:E,videoRange:x,width:A,height:R})=>(!!E||!!(A&&R))&&ux(x))),h.length===0){Promise.resolve().then(()=>{if(this.hls){i.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(i.levels[0].attrs)}`);const E=new Error("no level with compatible codecs found in manifest");this.hls.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:i.url,error:E,reason:E.message})}});return}if(i.audioTracks){const{preferManagedMediaSource:E}=this.hls.config;u=i.audioTracks.filter(x=>!x.audioCodec||xc(x.audioCodec,"audio",E)),Rg(u)}i.subtitles&&(f=i.subtitles,Rg(f));const d=h.slice(0);h.sort((E,x)=>{if(E.attrs["HDCP-LEVEL"]!==x.attrs["HDCP-LEVEL"])return(E.attrs["HDCP-LEVEL"]||"")>(x.attrs["HDCP-LEVEL"]||"")?1:-1;if(s&&E.height!==x.height)return E.height-x.height;if(E.frameRate!==x.frameRate)return E.frameRate-x.frameRate;if(E.videoRange!==x.videoRange)return Gl.indexOf(E.videoRange)-Gl.indexOf(x.videoRange);if(E.videoCodec!==x.videoCodec){const A=wm(E.videoCodec),R=wm(x.videoCodec);if(A!==R)return R-A}if(E.uri===x.uri&&E.codecSet!==x.codecSet){const A=Bl(E.codecSet),R=Bl(x.codecSet);if(A!==R)return R-A}return E.averageBitrate!==x.averageBitrate?E.averageBitrate-x.averageBitrate:0});let g=d[0];if(this.steering&&(h=this.steering.filterParsedLevels(h),h.length!==d.length)){for(let E=0;E<d.length;E++)if(d[E].pathwayId===h[0].pathwayId){g=d[E];break}}this._levels=h;for(let E=0;E<h.length;E++)if(h[E]===g){var y;this._firstLevel=E;const x=g.bitrate,A=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${x}`),((y=this.hls.userConfig)==null?void 0:y.abrEwmaDefaultEstimate)===void 0){const R=Math.min(x,this.hls.config.abrEwmaDefaultEstimateMax);R>A&&A===qp.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const v=o&&!r,T={levels:h,audioTracks:u,subtitleTracks:f,sessionData:i.sessionData,sessionKeys:i.sessionKeys,firstLevel:this._firstLevel,stats:i.stats,audio:o,video:r,altAudio:!v&&u.some(E=>!!E.url)};this.hls.trigger(b.MANIFEST_PARSED,T),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(t){const i=this._levels;if(i.length===0)return;if(t<0||t>=i.length){const g=new Error("invalid level idx"),y=t<0;if(this.hls.trigger(b.ERROR,{type:Tt.OTHER_ERROR,details:H.LEVEL_SWITCH_ERROR,level:t,fatal:y,error:g,reason:g.message}),y)return;t=Math.min(t,i.length-1)}const s=this.currentLevelIndex,r=this.currentLevel,o=r?r.attrs["PATHWAY-ID"]:void 0,u=i[t],f=u.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=u,s===t&&u.details&&r&&o===f)return;this.log(`Switching to level ${t} (${u.height?u.height+"p ":""}${u.videoRange?u.videoRange+" ":""}${u.codecSet?u.codecSet+" ":""}@${u.bitrate})${f?" with Pathway "+f:""} from level ${s}${o?" with Pathway "+o:""}`);const h={level:t,attrs:u.attrs,details:u.details,bitrate:u.bitrate,averageBitrate:u.averageBitrate,maxBitrate:u.maxBitrate,realBitrate:u.realBitrate,width:u.width,height:u.height,codecSet:u.codecSet,audioCodec:u.audioCodec,videoCodec:u.videoCodec,audioGroups:u.audioGroups,subtitleGroups:u.subtitleGroups,loaded:u.loaded,loadError:u.loadError,fragmentError:u.fragmentError,name:u.name,id:u.id,uri:u.uri,url:u.url,urlId:0,audioGroupIds:u.audioGroupIds,textGroupIds:u.textGroupIds};this.hls.trigger(b.LEVEL_SWITCHING,h);const d=u.details;if(!d||d.live){const g=this.switchParams(u.uri,r==null?void 0:r.details,d);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,i){i.fatal||!i.context||i.context.type===Ot.LEVEL&&i.context.level===this.level&&this.checkRetry(i)}onFragBuffered(t,{frag:i}){if(i!==void 0&&i.type===vt.MAIN){const s=i.elementaryStreams;if(!Object.keys(s).some(o=>!!s[o]))return;const r=this._levels[i.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(t,i){var s;const{level:r,details:o}=i,u=this._levels[r];if(!u){var f;this.warn(`Invalid level index ${r}`),(f=i.deliveryDirectives)!=null&&f.skip&&(o.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(u.fragmentError===0&&(u.loadError=0),this.playlistLoaded(r,i,u.details)):(s=i.deliveryDirectives)!=null&&s.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist();const i=this.currentLevelIndex,s=this.currentLevel;if(s&&this.shouldLoadPlaylist(s)){let r=s.uri;if(t)try{r=t.addDirectives(r)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}const o=s.attrs["PATHWAY-ID"];this.log(`Loading level index ${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""} with${o?" Pathway "+o:""} ${r}`),this.clearTimer(),this.hls.trigger(b.LEVEL_LOADING,{url:r,level:i,pathwayId:s.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var i;const s=this._levels.filter((r,o)=>o!==t?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(u=>u.level=-1)),!1));up(s),this._levels=s,this.currentLevelIndex>-1&&(i=this.currentLevel)!=null&&i.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(b.LEVELS_UPDATED,{levels:s})}onLevelsUpdated(t,{levels:i}){this._levels=i}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:i,maxHdcpLevel:s}=this.hls;this._maxAutoLevel!==i&&(this._maxAutoLevel=i,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:i,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:s}))}}function Rg(l){const t={};l.forEach(i=>{const s=i.groupId||"";i.id=t[s]=t[s]||0,t[s]++})}class fR{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const s in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[s].loader;if(r){var i;if(t&&t!==((i=r.context)==null?void 0:i.frag.type))return;r.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[t];(i.mediaKeySessionContext||i.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[t].loader;i&&i.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,i=H.KEY_LOAD_ERROR,s,r,o){return new Pi({type:Tt.NETWORK_ERROR,details:i,fatal:!1,frag:t,response:o,error:s,networkDetails:r})}loadClear(t,i){if(this.emeController&&this.config.emeEnabled){const{sn:s,cc:r}=t;for(let o=0;o<i.length;o++){const u=i[o];if(r<=u.cc&&(s==="initSegment"||u.sn==="initSegment"||s<u.sn)){this.emeController.selectKeySystemFormat(u).then(f=>{u.setKeyFormat(f)});break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(i=>this.loadInternal(t,i)):this.loadInternal(t)}loadInternal(t,i){var s,r;i&&t.setKeyFormat(i);const o=t.decryptdata;if(!o){const d=new Error(i?`Expected frag.decryptdata to be defined after setting format ${i}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,H.KEY_LOAD_ERROR,d))}const u=o.uri;if(!u)return Promise.reject(this.createKeyLoadError(t,H.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${u}"`)));let f=this.keyUriToKeyInfo[u];if((s=f)!=null&&s.decryptdata.key)return o.key=f.decryptdata.key,Promise.resolve({frag:t,keyInfo:f});if((r=f)!=null&&r.keyLoadPromise){var h;switch((h=f.mediaKeySessionContext)==null?void 0:h.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return f.keyLoadPromise.then(d=>(o.key=d.keyInfo.decryptdata.key,{frag:t,keyInfo:f}))}}switch(f=this.keyUriToKeyInfo[u]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(f,t):this.loadKeyEME(f,t);case"AES-128":return this.loadKeyHTTP(f,t);default:return Promise.reject(this.createKeyLoadError(t,H.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(t,i){const s={frag:i,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(s);if(r)return(t.keyLoadPromise=r.then(o=>(t.mediaKeySessionContext=o,s))).catch(o=>{throw t.keyLoadPromise=null,o})}return Promise.resolve(s)}loadKeyHTTP(t,i){const s=this.config,r=s.loader,o=new r(s);return i.keyLoader=t.loader=o,t.keyLoadPromise=new Promise((u,f)=>{const h={keyInfo:t,frag:i,responseType:"arraybuffer",url:t.decryptdata.uri},d=s.keyLoadPolicy.default,g={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},y={onSuccess:(v,T,E,x)=>{const{frag:A,keyInfo:R,url:O}=E;if(!A.decryptdata||R!==this.keyUriToKeyInfo[O])return f(this.createKeyLoadError(A,H.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));R.decryptdata.key=A.decryptdata.key=new Uint8Array(v.data),A.keyLoader=null,R.loader=null,u({frag:A,keyInfo:R})},onError:(v,T,E,x)=>{this.resetLoader(T),f(this.createKeyLoadError(i,H.KEY_LOAD_ERROR,new Error(`HTTP Error ${v.code} loading key ${v.text}`),E,he({url:h.url,data:void 0},v)))},onTimeout:(v,T,E)=>{this.resetLoader(T),f(this.createKeyLoadError(i,H.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(v,T,E)=>{this.resetLoader(T),f(this.createKeyLoadError(i,H.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};o.load(h,g,y)})}resetLoader(t){const{frag:i,keyInfo:s,url:r}=t,o=s.loader;i.keyLoader===o&&(i.keyLoader=null,s.loader=null),delete this.keyUriToKeyInfo[r],o&&o.destroy()}}function jp(){return self.SourceBuffer||self.WebKitSourceBuffer}function Xp(){if(!Yn())return!1;const t=jp();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function hR(){if(!Xp())return!1;const l=Yn();return typeof(l==null?void 0:l.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>l.isTypeSupported(Yr(t,"video")))||["mp4a.40.2","fLaC"].some(t=>l.isTypeSupported(Yr(t,"audio"))))}function dR(){var l;const t=jp();return typeof(t==null||(l=t.prototype)==null?void 0:l.changeType)=="function"}const mR=250,kl=2,gR=.1,pR=.05;class yR{constructor(t,i,s,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=i,this.fragmentTracker=s,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,i){const{config:s,media:r,stalled:o}=this;if(r===null)return;const{currentTime:u,seeking:f}=r,h=this.seeking&&!f,d=!this.seeking&&f;if(this.seeking=f,u!==t){if(this.moved=!0,f||(this.nudgeRetry=0),o!==null){if(this.stallReported){const A=self.performance.now()-o;N.warn(`playback not stuck anymore @${u}, after ${Math.round(A)}ms`),this.stallReported=!1}this.stalled=null}return}if(d||h){this.stalled=null;return}if(r.paused&&!f||r.ended||r.playbackRate===0||!Ht.getBuffered(r).length){this.nudgeRetry=0;return}const g=Ht.bufferInfo(r,u,0),y=g.nextStart||0;if(f){const A=g.len>kl,R=!y||i&&i.start<=u||y-u>kl&&!this.fragmentTracker.getPartialFragment(u);if(A||R)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var v;if(!(g.len>0)&&!y)return;const R=Math.max(y,g.start||0)-u,O=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,F=(O==null||(v=O.details)==null?void 0:v.live)?O.details.targetduration*2:kl,I=this.fragmentTracker.getPartialFragment(u);if(R>0&&(R<=F||I)){r.paused||this._trySkipBufferHole(I);return}}const T=self.performance.now();if(o===null){this.stalled=T;return}const E=T-o;if(!f&&E>=mR&&(this._reportStall(g),!this.media))return;const x=Ht.bufferInfo(r,u,s.maxBufferHole);this._tryFixBufferStall(x,E)}_tryFixBufferStall(t,i){const{config:s,fragmentTracker:r,media:o}=this;if(o===null)return;const u=o.currentTime,f=r.getPartialFragment(u);f&&(this._trySkipBufferHole(f)||!this.media)||(t.len>s.maxBufferHole||t.nextStart&&t.nextStart-u<s.maxBufferHole)&&i>s.highBufferWatchdogPeriod*1e3&&(N.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:i,media:s,stallReported:r}=this;if(!r&&s){this.stallReported=!0;const o=new Error(`Playback stalling at @${s.currentTime} due to low buffer (${JSON.stringify(t)})`);N.warn(o.message),i.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:t.len})}}_trySkipBufferHole(t){const{config:i,hls:s,media:r}=this;if(r===null)return 0;const o=r.currentTime,u=Ht.bufferInfo(r,o,0),f=o<u.start?u.start:u.nextStart;if(f){const h=u.len<=i.maxBufferHole,d=u.len>0&&u.len<1&&r.readyState<3,g=f-o;if(g>0&&(h||d)){if(g>i.maxBufferHole){const{fragmentTracker:v}=this;let T=!1;if(o===0){const E=v.getAppendedFrag(0,vt.MAIN);E&&f<E.end&&(T=!0)}if(!T){const E=t||v.getAppendedFrag(o,vt.MAIN);if(E){let x=!1,A=E.end;for(;A<f;){const R=v.getPartialFragment(A);if(R)A+=R.duration;else{x=!0;break}}if(x)return 0}}}const y=Math.max(f+pR,o+gR);if(N.warn(`skipping hole, adjusting currentTime from ${o} to ${y}`),this.moved=!0,this.stalled=null,r.currentTime=y,t&&!t.gap){const v=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${y}`);s.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,frag:t})}return y}}return 0}_tryNudgeBuffer(){const{config:t,hls:i,media:s,nudgeRetry:r}=this;if(s===null)return;const o=s.currentTime;if(this.nudgeRetry++,r<t.nudgeMaxRetry){const u=o+(r+1)*t.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${o} to ${u}`);N.warn(f.message),s.currentTime=u,i.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1})}else{const u=new Error(`Playhead still not moving while enough data buffered @${o} after ${t.nudgeMaxRetry} nudges`);N.error(u.message),i.trigger(b.ERROR,{type:Tt.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,error:u,fatal:!0})}}}const vR=100;class ER extends vf{constructor(t,i,s){super(t,i,s,"[stream-controller]",vt.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(b.MANIFEST_LOADING,this.onManifestLoading,this),t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.LEVEL_LOADING,this.onLevelLoading,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(b.ERROR,this.onError,this),t.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(b.BUFFER_CREATED,this.onBufferCreated,this),t.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(b.MANIFEST_LOADING,this.onManifestLoading,this),t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(b.ERROR,this.onError,this),t.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(b.BUFFER_CREATED,this.onBufferCreated,this),t.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(t){if(this.levels){const{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(vR),this.level=-1,!this.startFragRequested){let r=s.startLevel;r===-1&&(s.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=s.firstAutoLevel),s.nextLoadLevel=r,this.level=s.loadLevel,this.loadedmetadata=!1}i>0&&t===-1&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=Z.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=Z.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Z.WAITING_LEVEL:{const{levels:i,level:s}=this,r=i==null?void 0:i[s],o=r==null?void 0:r.details;if(o&&(!o.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(o))break;this.state=Z.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=Z.IDLE;break}break}case Z.FRAG_LOADING_WAITING_RETRY:{var t;const i=self.performance.now(),s=this.retryDate;if(!s||i>=s||(t=this.media)!=null&&t.seeking){const{levels:r,level:o}=this,u=r==null?void 0:r[o];this.resetStartWhenNotLoaded(u||null),this.state=Z.IDLE}}break}this.state===Z.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:i,levels:s,media:r}=this;if(i===null||!r&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?t.nextLoadLevel:t.loadLevel;if(!(s!=null&&s[o]))return;const u=s[o],f=this.getMainFwdBufferInfo();if(f===null)return;const h=this.getLevelDetails();if(h&&this._streamEnded(f,h)){const x={};this.altAudio&&(x.type="video"),this.hls.trigger(b.BUFFER_EOS,x),this.state=Z.ENDED;return}if(!this.buffering)return;t.loadLevel!==o&&t.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=t.nextLoadLevel=o;const d=u.details;if(!d||this.state===Z.WAITING_LEVEL||d.live&&this.levelLastLoaded!==u){this.level=o,this.state=Z.WAITING_LEVEL;return}const g=f.len,y=this.getMaxBufferLength(u.maxBitrate);if(g>=y)return;this.backtrackFragment&&this.backtrackFragment.start>f.end&&(this.backtrackFragment=null);const v=this.backtrackFragment?this.backtrackFragment.start:f.end;let T=this.getNextFragment(v,d);if(this.couldBacktrack&&!this.fragPrevious&&T&&T.sn!=="initSegment"&&this.fragmentTracker.getState(T)!==fe.OK){var E;const A=((E=this.backtrackFragment)!=null?E:T).sn-d.startSN,R=d.fragments[A-1];R&&T.cc===R.cc&&(T=R,this.fragmentTracker.removeFragment(R))}else this.backtrackFragment&&f.len&&(this.backtrackFragment=null);if(T&&this.isLoopLoading(T,v)){if(!T.gap){const A=this.audioOnly&&!this.altAudio?Nt.AUDIO:Nt.VIDEO,R=(A===Nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;R&&this.afterBufferFlushed(R,A,vt.MAIN)}T=this.getNextFragmentLoopLoading(T,d,f,vt.MAIN,y)}T&&(T.initSegment&&!T.initSegment.data&&!this.bitrateTest&&(T=T.initSegment),this.loadFragment(T,u,v))}loadFragment(t,i,s){const r=this.fragmentTracker.getState(t);this.fragCurrent=t,r===fe.NOT_LOADED||r===fe.PARTIAL?t.sn==="initSegment"?this._loadInitSegment(t,i):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,i)):(this.startFragRequested=!0,super.loadFragment(t,i,s)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,vt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:i}=this;if(i!=null&&i.readyState){let s;const r=this.getAppendedFrag(i.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const f=this.getMainFwdBufferInfo();if(!f||f.len<o.targetduration*2)return}if(!i.paused&&t){const f=this.hls.nextLoadLevel,h=t[f],d=this.fragLastKbps;d&&this.fragCurrent?s=this.fragCurrent.duration*h.maxBitrate/(1e3*d)+1:s=0}else s=0;const u=this.getBufferedFrag(i.currentTime+s);if(u){const f=this.followingBufferedFrag(u);if(f){this.abortCurrentFrag();const h=f.maxStartPTS?f.maxStartPTS:f.start,d=f.duration,g=Math.max(u.end,h+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(g,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case Z.KEY_LOADING:case Z.FRAG_LOADING:case Z.FRAG_LOADING_WAITING_RETRY:case Z.PARSING:case Z.PARSED:this.state=Z.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,i){super.flushMainBuffer(t,i,this.altAudio?"video":null)}onMediaAttached(t,i){super.onMediaAttached(t,i);const s=i.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),s.addEventListener("playing",this.onvplaying),s.addEventListener("seeked",this.onvseeked),this.gapController=new yR(this.config,s,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,i=t?t.currentTime:null;ot(i)&&this.log(`Media seeked to ${i.toFixed(3)}`);const s=this.getMainFwdBufferInfo();if(s===null||s.len===0){this.warn(`Main forward buffer length on "seeked" event ${s?s.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(t,i){let s=!1,r=!1;i.levels.forEach(o=>{const u=o.audioCodec;u&&(s=s||u.indexOf("mp4a.40.2")!==-1,r=r||u.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=s&&r&&!dR(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=i.levels,this.startFragRequested=!1}onLevelLoading(t,i){const{levels:s}=this;if(!s||this.state!==Z.IDLE)return;const r=s[i.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=Z.WAITING_LEVEL)}onLevelLoaded(t,i){var s;const{levels:r}=this,o=i.level,u=i.details,f=u.totalduration;if(!r){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${f}`);const h=r[o],d=this.fragCurrent;d&&(this.state===Z.FRAG_LOADING||this.state===Z.FRAG_LOADING_WAITING_RETRY)&&d.level!==i.level&&d.loader&&this.abortCurrentFrag();let g=0;if(u.live||(s=h.details)!=null&&s.live){var y;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;g=this.alignPlaylists(u,h.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(h.details=u,this.levelLastLoaded=h,this.hls.trigger(b.LEVEL_UPDATED,{details:u,level:o}),this.state===Z.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=Z.IDLE}this.startFragRequested?u.live&&this.synchronizeToLiveEdge(u):this.setStartPosition(u,g),this.tick()}_handleFragmentLoadProgress(t){var i;const{frag:s,part:r,payload:o}=t,{levels:u}=this;if(!u){this.warn(`Levels were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const f=u[s.level],h=f.details;if(!h){this.warn(`Dropping fragment ${s.sn} of level ${s.level} after level details were reset`),this.fragmentTracker.removeFragment(s);return}const d=f.videoCodec,g=h.PTSKnown||!h.live,y=(i=s.initSegment)==null?void 0:i.data,v=this._getAudioCodec(f),T=this.transmuxer=this.transmuxer||new _p(this.hls,vt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=r?r.index:-1,x=E!==-1,A=new pf(s.level,s.sn,s.stats.chunkCount,o.byteLength,E,x),R=this.initPTS[s.cc];T.push(o,y,v,d,s,r,h.totalduration,g,A,R)}onAudioTrackSwitching(t,i){const s=this.altAudio;if(!!!i.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const u=this.fragCurrent;u&&(this.log("Switching to main audio track, cancel main fragment load"),u.abortRequests(),this.fragmentTracker.removeFragment(u)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const o=this.hls;s&&(o.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),o.trigger(b.AUDIO_TRACK_SWITCHED,i)}}onAudioTrackSwitched(t,i){const s=i.id,r=!!this.hls.audioTracks[s].url;if(r){const o=this.videoBuffer;o&&this.mediaBuffer!==o&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=o)}this.altAudio=r,this.tick()}onBufferCreated(t,i){const s=i.tracks;let r,o,u=!1;for(const f in s){const h=s[f];if(h.id==="main"){if(o=f,r=h,f==="video"){const d=s[f];d&&(this.videoBuffer=d.buffer)}}else u=!0}u&&r?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(t,i){const{frag:s,part:r}=i;if(s&&s.type!==vt.MAIN)return;if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${r?" p: "+r.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Z.PARSED&&(this.state=Z.IDLE);return}const o=r?r.stats:s.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),s.sn!=="initSegment"&&(this.fragPrevious=s),this.fragBufferedComplete(s,r)}onError(t,i){var s;if(i.fatal){this.state=Z.ERROR;return}switch(i.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(vt.MAIN,i);break;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!i.levelRetry&&this.state===Z.WAITING_LEVEL&&((s=i.context)==null?void 0:s.type)===Ot.LEVEL&&(this.state=Z.IDLE);break;case H.BUFFER_APPEND_ERROR:case H.BUFFER_FULL_ERROR:if(!i.parent||i.parent!=="main")return;if(i.details===H.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(i)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(i);break}}checkBuffer(){const{media:t,gapController:i}=this;if(!(!t||!i||!t.readyState)){if(this.loadedmetadata||!Ht.getBuffered(t).length){const s=this.state!==Z.IDLE?this.fragCurrent:null;i.poll(this.lastCurrentTime,s)}this.lastCurrentTime=t.currentTime}}onFragLoadEmergencyAborted(){this.state=Z.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:i}){if(i!==Nt.AUDIO||this.audioOnly&&!this.altAudio){const s=(i===Nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(s,i,vt.MAIN),this.tick()}}onLevelsUpdated(t,i){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=i.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const i=t.currentTime;let s=this.startPosition;if(s>=0&&i<s){if(t.seeking){this.log(`could not seek to ${s}, already seeking at ${i}`);return}const r=Ht.getBuffered(t),u=(r.length?r.start(0):0)-s;u>0&&(u<this.config.maxBufferHole||u<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${u} to match buffer start`),s+=u,this.startPosition=s),this.log(`seek to target start position ${s} from current time ${i}`),t.currentTime=s}}_getAudioCodec(t){let i=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&i&&(this.log("Swapping audio codec"),i.indexOf("mp4a.40.5")!==-1?i="mp4a.40.2":i="mp4a.40.5"),i}_loadBitrateTestFrag(t,i){t.bitrateTest=!0,this._doFragLoad(t,i).then(s=>{const{hls:r}=this;if(!s||this.fragContextChanged(t))return;i.fragmentError=0,this.state=Z.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=t.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),r.trigger(b.FRAG_LOADED,s),t.bitrateTest=!1})}_handleTransmuxComplete(t){var i;const s="main",{hls:r}=this,{remuxResult:o,chunkMeta:u}=t,f=this.getCurrentContext(u);if(!f){this.resetWhenMissingContext(u);return}const{frag:h,part:d,level:g}=f,{video:y,text:v,id3:T,initSegment:E}=o,{details:x}=g,A=this.altAudio?void 0:o.audio;if(this.fragContextChanged(h)){this.fragmentTracker.removeFragment(h);return}if(this.state=Z.PARSING,E){if(E!=null&&E.tracks){const _=h.initSegment||h;this._bufferInitSegment(g,E.tracks,_,u),r.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:s,tracks:E.tracks})}const R=E.initPTS,O=E.timescale;ot(R)&&(this.initPTS[h.cc]={baseTime:R,timescale:O},r.trigger(b.INIT_PTS_FOUND,{frag:h,id:s,initPTS:R,timescale:O}))}if(y&&x&&h.sn!=="initSegment"){const R=x.fragments[h.sn-1-x.startSN],O=h.sn===x.startSN,_=!R||h.cc>R.cc;if(o.independent!==!1){const{startPTS:F,endPTS:I,startDTS:V,endDTS:G}=y;if(d)d.elementaryStreams[y.type]={startPTS:F,endPTS:I,startDTS:V,endDTS:G};else if(y.firstKeyFrame&&y.independent&&u.id===1&&!_&&(this.couldBacktrack=!0),y.dropped&&y.independent){const Q=this.getMainFwdBufferInfo(),z=(Q?Q.end:this.getLoadPosition())+this.config.maxBufferHole,P=y.firstKeyFramePTS?y.firstKeyFramePTS:F;if(!O&&z<P-this.config.maxBufferHole&&!_){this.backtrack(h);return}else _&&(h.gap=!0);h.setElementaryStreamInfo(y.type,h.start,I,h.start,G,!0)}else O&&F>kl&&(h.gap=!0);h.setElementaryStreamInfo(y.type,F,I,V,G),this.backtrackFragment&&(this.backtrackFragment=h),this.bufferFragmentData(y,h,d,u,O||_)}else if(O||_)h.gap=!0;else{this.backtrack(h);return}}if(A){const{startPTS:R,endPTS:O,startDTS:_,endDTS:F}=A;d&&(d.elementaryStreams[Nt.AUDIO]={startPTS:R,endPTS:O,startDTS:_,endDTS:F}),h.setElementaryStreamInfo(Nt.AUDIO,R,O,_,F),this.bufferFragmentData(A,h,d,u)}if(x&&T!=null&&(i=T.samples)!=null&&i.length){const R={id:s,frag:h,details:x,samples:T.samples};r.trigger(b.FRAG_PARSING_METADATA,R)}if(x&&v){const R={id:s,frag:h,details:x,samples:v.samples};r.trigger(b.FRAG_PARSING_USERDATA,R)}}_bufferInitSegment(t,i,s,r){if(this.state!==Z.PARSING)return;this.audioOnly=!!i.audio&&!i.video,this.altAudio&&!this.audioOnly&&delete i.audio;const{audio:o,video:u,audiovideo:f}=i;if(o){let h=t.audioCodec;const d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const g=o.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&d.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&d.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),t.audioCodec&&t.audioCodec!==h&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${h}"`),o.levelCodec=h,o.id="main",this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${h||""}/${t.audioCodec||""}/${o.codec}]`)}u&&(u.levelCodec=t.videoCodec,u.id="main",this.log(`Init video buffer, container:${u.container}, codecs[level/parsed]=[${t.videoCodec||""}/${u.codec}]`)),f&&this.log(`Init audiovideo buffer, container:${f.container}, codecs[level/parsed]=[${t.codecs}/${f.codec}]`),this.hls.trigger(b.BUFFER_CODECS,i),Object.keys(i).forEach(h=>{const g=i[h].initSegment;g!=null&&g.byteLength&&this.hls.trigger(b.BUFFER_APPENDING,{type:h,data:g,frag:s,part:null,chunkMeta:r,parent:s.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,vt.MAIN)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=Z.IDLE}checkFragmentChanged(){const t=this.media;let i=null;if(t&&t.readyState>1&&t.seeking===!1){const s=t.currentTime;if(Ht.isBuffered(t,s)?i=this.getAppendedFrag(s):Ht.isBuffered(t,s+.1)&&(i=this.getAppendedFrag(s+.1)),i){this.backtrackFragment=null;const r=this.fragPlaying,o=i.level;(!r||i.sn!==r.sn||r.level!==o)&&(this.fragPlaying=i,this.hls.trigger(b.FRAG_CHANGED,{frag:i}),(!r||r.level!==o)&&this.hls.trigger(b.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){const t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){const t=this.media;if(t){const i=t.currentTime,s=this.currentFrag;if(s&&ot(i)&&ot(s.programDateTime)){const r=s.programDateTime+(i-s.start)*1e3;return new Date(r)}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class gi{static get version(){return"1.5.20"}static isMSESupported(){return Xp()}static isSupported(){return hR()}static getMediaSource(){return Yn()}static get Events(){return b}static get ErrorTypes(){return Tt}static get ErrorDetails(){return H}static get DefaultConfig(){return gi.defaultConfig?gi.defaultConfig:qp}static set DefaultConfig(t){gi.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Af,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,lS(t.debug||!1,"Hls instance");const i=this.config=oR(gi.DefaultConfig,t);this.userConfig=t,i.progressive&&uR(i);const{abrController:s,bufferController:r,capLevelController:o,errorController:u,fpsController:f}=i,h=new u(this),d=this.abrController=new s(this),g=this.bufferController=new r(this),y=this.capLevelController=new o(this),v=new f(this),T=new ex(this),E=new ax(this),x=i.contentSteeringController,A=x?new x(this):null,R=this.levelController=new cR(this,A),O=new Nx(this),_=new fR(this.config),F=this.streamController=new ER(this,O,_);y.setStreamController(F),v.setStreamController(F);const I=[T,R,F];A&&I.splice(1,0,A),this.networkControllers=I;const V=[d,g,y,v,E,O];this.audioTrackController=this.createController(i.audioTrackController,I);const G=i.audioStreamController;G&&I.push(new G(this,O,_)),this.subtitleTrackController=this.createController(i.subtitleTrackController,I);const Q=i.subtitleStreamController;Q&&I.push(new Q(this,O,_)),this.createController(i.timelineController,V),_.emeController=this.emeController=this.createController(i.emeController,V),this.cmcdController=this.createController(i.cmcdController,V),this.latencyController=this.createController(lx,V),this.coreComponents=V,I.push(h);const z=h.onErrorOut;typeof z=="function"&&this.on(b.ERROR,z,h)}createController(t,i){if(t){const s=new t(this);return i&&i.push(s),s}return null}on(t,i,s=this){this._emitter.on(t,i,s)}once(t,i,s=this){this._emitter.once(t,i,s)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,i,s=this,r){this._emitter.off(t,i,s,r)}listeners(t){return this._emitter.listeners(t)}emit(t,i,s){return this._emitter.emit(t,i,s)}trigger(t,i){if(this.config.debug)return this.emit(t,t,i);try{return this.emit(t,t,i)}catch(s){if(N.error("An internal error happened while handling event "+t+'. Error message: "'+s.message+'". Here is a stacktrace:',s),!this.triggeringException){this.triggeringException=!0;const r=t===b.ERROR;this.trigger(b.ERROR,{type:Tt.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:r,event:t,error:s}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){N.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(i=>i.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(i=>i.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){N.log("attachMedia"),this._media=t,this.trigger(b.MEDIA_ATTACHING,{media:t})}detachMedia(){N.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const i=this.media,s=this.url,r=this.url=cf.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,N.log(`loadSource:${r}`),i&&s&&(s!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(i)),this.trigger(b.MANIFEST_LOADING,{url:t})}startLoad(t=-1){N.log(`startLoad(${t})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t),!(!this.started||!this.networkControllers));i++);}stopLoad(){N.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!(this.started||!this.networkControllers));t++);}resumeBuffering(){N.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()})}pauseBuffering(){N.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()})}swapAudioCodec(){N.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){N.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t){this.levelController.removeLevel(t)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){N.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){N.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){N.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){N.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){N.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const i=!!t;i!==this.config.capLevelToPlayerSize&&(i?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=i)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(N.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){ox(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:i}}=this;if(!t)return 0;const s=t.length;for(let r=0;r<s;r++)if(t[r].maxBitrate>=i)return r;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:i,maxHdcpLevel:s}=this;let r;if(i===-1&&t!=null&&t.length?r=t.length-1:r=i,s)for(let o=r;o--;){const u=t[o].attrs["HDCP-LEVEL"];if(u&&u<=s)return o}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(t){var i;return(i=this.audioTrackController)==null?void 0:i.setAudioOption(t)}setSubtitleOption(t){var i;return(i=this.subtitleTrackController)==null||i.setSubtitleOption(t),null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const i=this.audioTrackController;i&&(i.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const i=this.subtitleTrackController;i&&(i.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const i=this.subtitleTrackController;i&&(i.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}gi.defaultConfig=void 0;const Wp={TyC_Sports:["https://la12hd.com/vivo/canal.php?stream=tycsports","https://flow.futbollibre2.online/flow.html?id=tyc",""],TNT_Sports:["https://director.mgi9ehlj7z061brnpp28wr2x7n9wvpr10.click/v4/variant/VE1gTdz0mLzRnLv52bt9SMhFjdtM3ajFmc09yNzkTOxQDOxITY3kTL4MGM40COyYGNtYGO0QWLzIWZxUjNzczL.m3u8","https://yxdlc29tzq.fubohd.com/tntsports/mono.m3u8?token=d953690ced1afc1e692d80bdda0f7aeb8a01bd25-88-1739173724-1739137724","https://la12hd.com/vivo/canales.php?stream=tntsports","https://streamdz1.xyz/player/embed.php?channel=tntar","https://tucanaldeportivo.org/tntsports.php","https://director.mgi9ehlj7z061brnpp28wr2x7n9wvpr10.click/v4/variant/VE1gTdz0mLzRnLv52bt9SMhFjdtM3ajFmc09yNzkTOxQDOxITY3kTL4MGM40COyYGNtYGO0QWLzIWZxUjNzczL.m3u8","https://cdn.sensa.com.ar/live/eds/TNTSports/live_dash_cld/TNTSports.mpd","https://cdn.sensa.com.ar/live/eds/TNTSports/live_dash_cld/TNTSports.mpd?ck=eyJjMjYzNzEwNzllODkyMDZkNjNlMTQ1NDg5M2U4ODFiNiI6ImFkYWMzYzNiMzc3NGU0MTFkNmU0OTcyNGY3ZWEwZWUzIn0=&title=RusticoTV&headers=eyJvcmlnaW4iOiJodHRwczovL3BsYXllci5zZW5zYS5jb20uYXIiLCJyZWZlcmVyIjoiaHR0cHM6Ly9wbGF5ZXIuc2Vuc2EuY29tLmFyLyJ9"],ESPN_Premiun:["https://streamtp2.com/global1.php?stream=espnpremium","https://tucanaldeportivo.org/espnpremium.php","https://la12hd.com/vivo/canales.php?stream=espnpremium","https://cdn.sensa.com.ar/live/eds/FoxSportsPremium/live_dash_cld/FoxSportsPremium.mpd?ck=eyJmODk0M2QxMTRlMjUxNTFjOGFlNGY2MTIzNTFkNWE1ZiI6IjdmMzRjOWE3MGM4MzYwMjBjYmMzMjczYzQyN2ZmMjc3In0=&title=DeportesTVHD&headers=eyJvcmlnaW4iOiJodHRwczovL3BsYXllci5zZW5zYS5jb20uYXIiLCJyZWZlcmVyIjoiaHR0cHM6Ly9wbGF5ZXIuc2Vuc2EuY29tLmFyLyJ9"],ESPN_1:["https://director.mgi9ehlj7z061brnpp28wr2x7n9wvpr10.click/v3/director/VE1YTIxZWZmZDY0YjQ2LTYzMDktZWEwNC03ZmQzLWE2NmNmNDIy/master.m3u8","https://streamtp2.com/global1.php?stream=espn","https://streamdz1.xyz/player/embed.php?channel=espn","https://la12hd.com/vivo/canales.php?stream=espn","https://embed.sdfgnksbounce.com/embed2/espn.html","https://flow.futbollibre2.online/flow.html?id=espn1"],TNT_Series:["https://television-libre.net/html/fl/?get=VE5UU2VyaWVz"],HyH:["https://television-libre.net/html/fl/?get=RGlzY292ZXJ5SG9tZUhlYWx0aEhE"],TcL:["https://television-libre.net/html/fl/?get=VExD"],History:["https://television-libre.net/html/fl/?get=SGlzdG9yeUhE"],Space:["https://television-libre.net/html/fl/?get=U3BhY2U="],Start_Channel:["https://television-libre.net/html/fl/?get=Rk9YSEQ=","https://nebunexa.co/wsd/?get=STAR_CHANNEL","https://nebunexa.co/canal/?id=STAR_CHANNEL"],Disney_channel:["https://television-libre.net/html/fl/?get=RGlzbmV5Q2hhbm5lbEhE"],Flow_Music:["https://television-libre.net/html/fl/?get=Rmxvd19NdXNpY19YUA=="],DirecTV_Sports:["https://futbollibre2.online/embed/iframe.html?get=https://streamtp.live/global2.php?stream=dsports","https://futbollibre2.online/embed/iframe.html?get=https://tucanaldeportivo.org/directvsports.php","https://futbollibre2.online/embed/iframe.html?get=https://la12hd.com/vivo/canales.php?stream=dsports","https://futbollibre2.online/embed/iframe.html?get=https://embed.sdfgnksbounce.com/embed2/directvsports.html","https://futbollibre2.online/embed/iframe.html?get=https://streamtp1.com/global1.php?stream=dsports","https://futbollibre2.online/embed/iframe.html?get=https://embed.sdfgnksbounce.com/embed2/directvsports.html"],Fox1:["https://futbollibre2.online/embed/iframe.html?get=https://streamtp.live/global1.php?stream=fox1ar","https://futbollibre2.online/embed/iframe.html?get=https://la12hd.com/vivo/canales.php?stream=foxsports","https://futbollibre2.online/embed/iframe.html?get=https://embed.sdfgnksbounce.com/embed2/foxsports.html","https://flow.futbollibre2.online/flow.html?id=foxsports1","https://cablevisionflow2.dev.ar/extencion.html?get=Rm94U3BvcnRz"],Fox2:["https://futbollibre2.online/embed/iframe.html?get=https://streamtp.live/global1.php?stream=fox2ar","https://futbollibre2.online/embed/iframe.html?get=https://embed.sdfgnksbounce.com/embed2/foxsports2.html","https://flow.futbollibre2.online/flow.html?id=foxsports2","https://cablevisionflow2.dev.ar/extencion.html?get=Rm94U3BvcnRzMkhE","https://futbollibre2.online/embed/iframe.html?get=https://la10hd.com/vivo/canal.php?stream=foxsports2"],Fox3:["https://futbollibre2.online/embed/iframe.html?get=https://streamtp.live/global1.php?stream=fox3ar","https://futbollibre2.online/embed/iframe.html?get=https://embed.sdfgnksbounce.com/embed2/foxsports3.html","https://flow.futbollibre2.online/flow.html?id=foxsports3","https://cablevisionflow2.dev.ar/extencion.html?get=Rm94U3BvcnRzM0hE","https://futbollibre2.online/embed/iframe.html?get=https://la10hd.com/vivo/canal.php?stream=foxsports3"],ESPN2:["https://la12hd.com/vivo/canal.php?stream=espn2","https://bgfuzq.fubohd.com/espn2/tracks-v1a1/mono.m3u8?token=8f6996f5ccc43866c94fc232301b0f5b4218fbe0-91-1739253724-1739217724"],ESPN3:["https://la12hd.com/vivo/canal.php?stream=espn3","https://c2f2zq.fubohd.com/espn3/mono.m3u8?token=e3d5f571c8cac597332e3cd6a4817c9a63ee4c19-29-1739254273-1739218273"],ESPN4:["https://la12hd.com/vivo/canal.php?stream=espn4","https://cgxheq.fubohd.com/espn4/mono.m3u8?token=ae87ec778603e7a1f20f277fb52e26e41ad1bfd3-b6-1739254366-1739218366"],ESPN5:["https://la12hd.com/vivo/canal.php?stream=espn5","https://bmf0aw9u.fubohd.com/espn5/tracks-v1a1/mono.m3u8?token=5b98f025d1b6973b495c947f9aaca112c911e33e-3b-1739254446-1739218446"],ESPN6:["https://la12hd.com/vivo/canal.php?stream=espn6","https://agl2zq.fubohd.com/espn6/mono.m3u8?token=1eda90b5a82694c0c4865be14f8b5b19353902da-48-1739254526-1739218526"],ESPN7:["https://la12hd.com/vivo/canal.php?stream=espn7","https://bmv3.fubohd.com/espn7/tracks-v1a1/mono.m3u8?token=8f78fb81a04f3e4d30bc5b0ba768712cf8425484-f6-1739254564-1739218564"],Dsports:["https://la12hd.com/vivo/canal.php?stream=dsports","https://bmv3.fubohd.com/dsports/tracks-v1a1/mono.m3u8?token=94dca25481f4e4c3c81e0526ad5c5c974f5b62d2-af-1739254694-1739218694"],Dsports2:["https://la12hd.com/vivo/canal.php?stream=dsports2","https://c2f2zq.fubohd.com/dsports2/tracks-v1a1/mono.m3u8?token=6ef9c6393cabf12036de29411208deaafb944b07-b2-1739254749-1739218749"],Dsportsplus:["https://la12hd.com/vivo/canal.php?stream=dsportsplus","https://a2lja3m.fubohd.com/dsportsplus/mono.m3u8?token=37245fd2ec172899dcfb0c2a22133fbe8a677979-e0-1739254785-1739218785"],TVPublica:["https://la12hd.com/vivo/canal.php?stream=tvpublica"]},TR=()=>{const l=yn(),[t,i]=X.useState([]),[s,r]=X.useState(""),[o,u]=X.useState(""),f=X.useRef(null),h=X.useRef(null);X.useEffect(()=>{const y=new URLSearchParams(l.search).get("name");if(y){u(y);const v=Object.entries(Wp).find(([T])=>T===y);if(v){const[,T]=v;i(T),r(T[0])}else console.error("⚠️ Error: Canal no encontrado.")}},[l]),X.useEffect(()=>{if(!(!s||!f.current))if(h.current&&h.current.destroy(),s.includes(".m3u8")&&gi.isSupported()){const g=new gi;h.current=g,g.loadSource(s),g.attachMedia(f.current),g.on(gi.Events.MANIFEST_PARSED,()=>{f.current.play()}),g.on(gi.Events.ERROR,(y,v)=>{console.error("❌ Error en HLS:",v)})}else s.includes(".m3u8")&&(f.current.src=s,f.current.addEventListener("loadedmetadata",()=>{f.current.play()}))},[s]);const d=g=>{r(g)};return Mt.jsxs("div",{children:[Mt.jsx("h1",{className:"titulo",children:"⚽ Fulbo Live"}),o&&Mt.jsx("h2",{children:o})," ",t.length>0?Mt.jsxs(Mt.Fragment,{children:[s.includes(".m3u8")?Mt.jsx("video",{ref:f,controls:!0,width:"800",height:"450"}):Mt.jsx("iframe",{src:s,width:"800",height:"450",allowFullScreen:!0,title:o}),Mt.jsx("div",{children:t.map((g,y)=>Mt.jsx("button",{onClick:()=>d(g),disabled:g===s,children:`Opción ${y+1}`},y))})]}):Mt.jsx("h2",{children:"⚠️ Error: No hay enlaces disponibles"}),Mt.jsx("h2",{className:"titulo",children:"⚽ Bienvenido a Fulbo"})]})};function SR(){const[l,t]=X.useState([]),[i,s]=X.useState(!0);return X.useEffect(()=>{const r=Object.entries(Wp).map(([o,u])=>({nombre:o,enlace:u[0],imagen:"https://source.unsplash.com/300x200/?soccer"}));t(r),s(!1)},[]),Mt.jsxs("div",{className:"container",children:[Mt.jsx("h1",{className:"titulo",children:"⚽ Fulbo Live"}),i?Mt.jsx("p",{className:"cargando",children:"Cargando eventos..."}):Mt.jsx("div",{className:"eventos-grid",children:l.length>0?l.map((r,o)=>Mt.jsxs("div",{className:"evento-card",children:[Mt.jsx("img",{src:r.imagen,alt:r.nombre,className:"evento-img"}),Mt.jsxs("div",{className:"evento-info",children:[Mt.jsx("h3",{children:r.nombre}),Mt.jsx(uf,{to:`/player?name=${encodeURIComponent(r.nombre)}`,children:Mt.jsx("button",{className:"ver-evento",children:"Ver Evento"})})]})]},o)):Mt.jsx("p",{className:"sin-eventos",children:"No hay eventos disponibles."})})]})}function xR(){return Mt.jsx(zT,{basename:"/Fulbo-Live",children:Mt.jsxs(ET,{children:[Mt.jsx(Pc,{path:"/",element:Mt.jsx(SR,{})}),Mt.jsx(Pc,{path:"/player",element:Mt.jsx(TR,{})})]})})}CE.createRoot(document.getElementById("root")).render(Mt.jsx(X.StrictMode,{children:Mt.jsx(xR,{})}));
